import{c as we,j as e,r as u,_ as ve,u as L,a as M,I as A,g as $e,b as Ve,s as k,T as We,d as Ke,e as ae,f as $,i as Qe,h as Ue,k as I,l as Ge,B as S,G as f,m as j,S as Y,n as qe,o as W,p as H,q as Xe,t as K,v as Q,w as z,x as V,y as U,z as T,A as G,C as E,D as Je,E as Ze,F as v,R as Oe,H as et,J as tt,K as st,L as at,M as it,N as ot,O as _e,P as nt,Q as ie,U as oe,V as ne,W as rt}from"./index-83afeab6.js";import{_ as N}from"./react-apexcharts.min-1038ce7b.js";import{M as Pe}from"./Link-84f933ee.js";import{d as lt}from"./Close-02cc6e4d.js";import{D as ct,a as dt}from"./DialogContent-d94138cf.js";import{D as ht}from"./DialogTitle-5e150ee5.js";import{u as xt,f as re,N as ut,g as gt,a as mt,b as ft,S as pt}from"./index-f8622da8.js";import{T as bt,d as jt,a as yt}from"./KeyboardArrowUp-8b7bbe30.js";import{T as w,a as Me,P as Te,b as Ie,c as Re,d as F,e as Ye}from"./PaperTable-7d18355c.js";import{K as le,a as ce,D as Ct}from"./DateTimePicker-a05014bc.js";import{S as ke,I as St}from"./Select-8c656a15.js";import{M as De,D as Le}from"./MenuItem-93e28968.js";import{T as wt}from"./TextField-df3bb6ad.js";import{B as Z,I as J}from"./InputLabel-a01ea7c7.js";import{g as vt}from"./getFormattedDateTime-93199493.js";import{C as _t}from"./CameraIcon2-98f76e0f.js";import"./timeViewRenderers-6943ade0.js";import"./InputAdornment-ca976e16.js";import"./Chip-308c01b2.js";import"./LastPage-ac832881.js";import"./FormControl-8b31c5e5.js";const de=we(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),he=we(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage");var xe,ue,ge,me,fe,pe,be,je;const Pt=["backIconButtonProps","count","getItemAriaLabel","nextIconButtonProps","onPageChange","page","rowsPerPage","showFirstButton","showLastButton"],Mt=u.forwardRef(function(a,d){const{backIconButtonProps:r,count:c,getItemAriaLabel:i,nextIconButtonProps:n,onPageChange:h,page:o,rowsPerPage:l,showFirstButton:x,showLastButton:p}=a,s=ve(a,Pt),g=L(),_=y=>{h(y,0)},D=y=>{h(y,o-1)},m=y=>{h(y,o+1)},b=y=>{h(y,Math.max(0,Math.ceil(c/l)-1))};return e.jsxs("div",M({ref:d},s,{children:[x&&e.jsx(A,{onClick:_,disabled:o===0,"aria-label":i("first",o),title:i("first",o),children:g.direction==="rtl"?xe||(xe=e.jsx(he,{})):ue||(ue=e.jsx(de,{}))}),e.jsx(A,M({onClick:D,disabled:o===0,color:"inherit","aria-label":i("previous",o),title:i("previous",o)},r,{children:g.direction==="rtl"?ge||(ge=e.jsx(le,{})):me||(me=e.jsx(ce,{}))})),e.jsx(A,M({onClick:m,disabled:c!==-1?o>=Math.ceil(c/l)-1:!1,color:"inherit","aria-label":i("next",o),title:i("next",o)},n,{children:g.direction==="rtl"?fe||(fe=e.jsx(ce,{})):pe||(pe=e.jsx(le,{}))})),p&&e.jsx(A,{onClick:b,disabled:o>=Math.ceil(c/l)-1,"aria-label":i("last",o),title:i("last",o),children:g.direction==="rtl"?be||(be=e.jsx(de,{})):je||(je=e.jsx(he,{}))})]}))}),Tt=Mt;function It(t){return Ve("MuiTablePagination",t)}const Rt=$e("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]),B=Rt;var ye;const Yt=["ActionsComponent","backIconButtonProps","className","colSpan","component","count","getItemAriaLabel","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","onPageChange","onRowsPerPageChange","page","rowsPerPage","rowsPerPageOptions","SelectProps","showFirstButton","showLastButton"],kt=k(w,{name:"MuiTablePagination",slot:"Root",overridesResolver:(t,a)=>a.root})(({theme:t})=>({overflow:"auto",color:(t.vars||t).palette.text.primary,fontSize:t.typography.pxToRem(14),"&:last-child":{padding:0}})),Dt=k(We,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(t,a)=>M({[`& .${B.actions}`]:a.actions},a.toolbar)})(({theme:t})=>({minHeight:52,paddingRight:2,[`${t.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[t.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${B.actions}`]:{flexShrink:0,marginLeft:20}})),Lt=k("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(t,a)=>a.spacer})({flex:"1 1 100%"}),At=k("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(t,a)=>a.selectLabel})(({theme:t})=>M({},t.typography.body2,{flexShrink:0})),Et=k(ke,{name:"MuiTablePagination",slot:"Select",overridesResolver:(t,a)=>M({[`& .${B.selectIcon}`]:a.selectIcon,[`& .${B.select}`]:a.select},a.input,a.selectRoot)})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${B.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),zt=k(De,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(t,a)=>a.menuItem})({}),Ft=k("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(t,a)=>a.displayedRows})(({theme:t})=>M({},t.typography.body2,{flexShrink:0}));function Bt({from:t,to:a,count:d}){return`${t}–${a} of ${d!==-1?d:`more than ${a}`}`}function Ht(t){return`Go to ${t} page`}const Nt=t=>{const{classes:a}=t;return Ue({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},It,a)},$t=u.forwardRef(function(a,d){const r=Ke({props:a,name:"MuiTablePagination"}),{ActionsComponent:c=Tt,backIconButtonProps:i,className:n,colSpan:h,component:o=w,count:l,getItemAriaLabel:x=Ht,labelDisplayedRows:p=Bt,labelRowsPerPage:s="Rows per page:",nextIconButtonProps:g,onPageChange:_,onRowsPerPageChange:D,page:m,rowsPerPage:b,rowsPerPageOptions:y=[10,25,50,100],SelectProps:C={},showFirstButton:ze=!1,showLastButton:Fe=!1}=r,Be=ve(r,Yt),X=r,P=Nt(X),ee=C.native?"option":zt;let te;(o===w||o==="td")&&(te=h||1e3);const He=ae(C.id),se=ae(C.labelId),Ne=()=>l===-1?(m+1)*b:b===-1?l:Math.min(l,(m+1)*b);return e.jsx(kt,M({colSpan:te,ref:d,as:o,ownerState:X,className:$(P.root,n)},Be,{children:e.jsxs(Dt,{className:P.toolbar,children:[e.jsx(Lt,{className:P.spacer}),y.length>1&&e.jsx(At,{className:P.selectLabel,id:se,children:s}),y.length>1&&e.jsx(Et,M({variant:"standard"},!C.variant&&{input:ye||(ye=e.jsx(St,{}))},{value:b,onChange:D,id:He,labelId:se},C,{classes:M({},C.classes,{root:$(P.input,P.selectRoot,(C.classes||{}).root),select:$(P.select,(C.classes||{}).select),icon:$(P.selectIcon,(C.classes||{}).icon)}),children:y.map(R=>u.createElement(ee,M({},!Qe(ee)&&{ownerState:X},{className:P.menuItem,key:R.label?R.label:R,value:R.value?R.value:R}),R.label?R.label:R))})),e.jsx(Ft,{className:P.displayedRows,children:p({from:l===0?0:m*b+1,to:Ne(),count:l===-1?-1:l,page:m})}),e.jsx(c,{className:P.actions,backIconButtonProps:i,count:l,nextIconButtonProps:g,onPageChange:_,page:m,rowsPerPage:b,showFirstButton:ze,showLastButton:Fe,getItemAriaLabel:x})]})}))}),Vt=$t;function q(t,a,d){const r=[],c=[];return t.length>0?(t.forEach(i=>{i[a]&&i[d]&&(r.push(i[a]),c.push(i[d]))}),{categories:r,series:c}):{categories:r,series:c}}const Wt=()=>{const[t,a]=u.useState({configs:{chart:{type:"bar",id:"bar_active_pin_entrada",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#1668dc","#65a9f3"]}}),[d,r]=u.useState([]),{filters:c}=I(s=>s.dashboardSlice),[i,{isError:n,isLoading:h,isSuccess:o,data:l}]=Ge(),x=L(),p=x.palette.mode;return u.useEffect(()=>{a(s=>{const g=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:g,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:g}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:g,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),u.useEffect(()=>{if(c.ctrl_id!=""&&c.date!=null){const{ctrl_id:s,date:g,is_monthly:_}=c;i({ctrl_id:Number(s),date:g,monthly:_?"true":"false"})}},[c]),u.useEffect(()=>{if(!h&&o&&l){const s=q(l,"detector","total_activo");a(g=>({configs:{...g.configs,xaxis:{...g.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"activaciones"}])}!h&&n&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[o,l,h,n]),e.jsx(e.Fragment,{children:e.jsxs(S,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(j,{variant:"h5",children:"Pines Entrada"})}),e.jsx(f,{item:!0})]}),e.jsx(Y,{sx:{mt:2},children:e.jsx(N,{options:t.configs,series:d,type:"bar",height:365})})]})})},Kt=()=>{const[t,a]=u.useState({configs:{chart:{type:"bar",id:"bar_active_pin_salida",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#d89614"]}}),[d,r]=u.useState([]),{filters:c}=I(s=>s.dashboardSlice),[i,{isError:n,isLoading:h,isSuccess:o,data:l}]=qe(),x=L(),p=x.palette.mode;return u.useEffect(()=>{a(s=>{const g=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:g,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:g}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:g,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),u.useEffect(()=>{if(c.ctrl_id!=""&&c.date!=null){const{ctrl_id:s,date:g,is_monthly:_}=c;i({ctrl_id:Number(s),date:g,monthly:_?"true":"false"})}},[c]),u.useEffect(()=>{if(!h&&o&&l){const s=q(l,"actuador","total_activo");a(g=>({configs:{...g.configs,xaxis:{...g.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"activaciones"}])}!h&&n&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[o,l,h,n]),e.jsx(e.Fragment,{children:e.jsxs(S,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(j,{variant:"h5",children:"Pines Salida"})}),e.jsx(f,{item:!0})]}),e.jsx(Y,{sx:{mt:2},children:e.jsx(N,{options:t.configs,series:d,type:"bar",height:365})})]})})},Qt=()=>{const{filters:t,other_filters:a}=I(m=>m.dashboardSlice),d=W(),r=H(),[c,i]=u.useState({configs:{chart:{type:"donut",height:365},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:"#8c8c8c"},value:{color:"#8c8c8c"}}}}},labels:["Registrado","No registrado","Remoto"],dataLabels:{formatter(m,b){return b.w.globals.series[b.seriesIndex]}},legend:{labels:{colors:"#8c8c8c"}}}}),[n,h]=u.useState([0,0,0]),[o,{isError:l,isLoading:x,isSuccess:p,data:s}]=Xe(),g=L(),_=g.palette.mode,D=u.useCallback((m,b,y)=>{const C=y.dataPointIndex;C!=null&&C!=null&&C>-1&&t.is_monthly&&(r(K(a.region)),r(Q(t.ctrl_id)),C==0?(r(z("acceso")),r(V([{id:"autorizacion",value:"1"},{id:"tipo",value:"1"}]))):C==1?(r(z("acceso")),r(V([{id:"autorizacion",value:"0"},{id:"tipo",value:"1"},{id:"co_id",value:"0"}]))):C==2&&(r(z("salida")),r(V([{id:"es_id",value:"1"},{id:"estado",value:"1"}]))),r(U(T(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),r(G(T(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),d("/logs"))},[t.is_monthly]);return u.useEffect(()=>{i(m=>{const b=_=="dark"?g.palette.text.secondary:g.palette.text.primary;return{configs:{...m.configs,chart:{...m.configs.chart,background:g.palette.background.paper},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:b},value:{color:b}}}}},legend:{...m.configs.legend,labels:{colors:b}}}}})},[_]),u.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:m,date:b,is_monthly:y}=t;o({ctrl_id:Number(m),date:b,monthly:y?"true":"false"})}},[t]),u.useEffect(()=>{!x&&p&&s&&(h([s.data.tarjeta.total_registrado,s.data.tarjeta.total_noregistrado,s.data.remoto.total_remoto]),i(m=>({configs:{...m.configs,chart:{...m.configs.chart,events:{click:D}}}}))),!x&&l&&h([0,0,0])},[p,s,x,l,t.is_monthly]),e.jsx(e.Fragment,{children:e.jsxs(S,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(j,{variant:"h5",children:"Accesos"})}),e.jsx(f,{item:!0})]}),e.jsx(Y,{sx:{mt:2,height:365},children:e.jsx(N,{options:c.configs,series:n,type:"donut",height:365})})]})})},Ut=()=>{const[t,a]=u.useState({configs:{chart:{type:"bar",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(s,g,_){return E(String(s),15,!0)}}},yaxis:{stepSize:1,min:0,max:s=>s+1,title:{text:"Numero Tickets",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[d,r]=u.useState([]),{filters:c}=I(s=>s.dashboardSlice),[i,{isError:n,isLoading:h,isSuccess:o,data:l}]=Je(),x=L(),p=x.palette.mode;return u.useEffect(()=>{a(s=>{const g=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:g,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:g}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:g,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),u.useEffect(()=>{if(c.ctrl_id!=""&&c.date!=null){const{ctrl_id:s,date:g,is_monthly:_}=c;i({ctrl_id:Number(s),date:g,monthly:_?"true":"false"})}},[c]),u.useEffect(()=>{if(!h&&o&&l){const s=q(l.data,"contrata","total_ticket");a(g=>({configs:{...g.configs,xaxis:{...g.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"tickets"}])}!h&&n&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[o,l,h,n]),e.jsx(e.Fragment,{children:e.jsxs(S,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(j,{variant:"h5",children:"Tickets"})}),e.jsx(f,{item:!0})]}),e.jsx(Y,{sx:{mt:2,height:365},children:e.jsx(N,{options:t.configs,series:d,type:"bar",height:365})})]})})},Gt="/assets/alarm-icon-32250a4b.svg",qt=()=>{const{filters:t,other_filters:a}=I(p=>p.dashboardSlice),[d,{isError:r,isLoading:c,isSuccess:i,data:n}]=Ze(),[h,o]=u.useState(0),l=W(),x=H();return u.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:g}=t;d({ctrl_id:Number(p),date:s,monthly:g?"true":"false"})}},[t]),u.useEffect(()=>{!c&&i&&n&&o(n.data.total_alarma),!c&&r&&o(0)},[i,n,c,r]),e.jsxs(Y,{sx:{p:2.25},children:[e.jsx(j,{variant:"h6",color:"text.secondary",children:"Alarmas"}),e.jsxs(S,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(v,{direction:"row",alignItems:"end",children:[e.jsx(j,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:h}),e.jsx(j,{color:"inherit",component:"span",variant:"body1",children:"activaciones"})]}),e.jsx("img",{src:Gt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(v,{direction:"row",justifyContent:"end",children:e.jsx(Pe,{component:"button",underline:"hover",onClick:()=>{x(K(a.region)),x(Q(t.ctrl_id)),x(z("salida")),x(U(T(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),x(G(T(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),l("/logs")},children:"Ver Mas"})})]})},Xt="/assets/tarjeta-icon-40f490cf.svg",Ae=({onClose:t,open:a,title:d,children:r})=>e.jsxs(ct,{open:a,onClose:t,fullWidth:!0,maxWidth:"md",children:[e.jsx(ht,{children:e.jsx(j,{component:"div",variant:"h5",children:d})}),e.jsx(A,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(lt,{})}),e.jsx(dt,{dividers:!0,children:r})]}),Jt=({data:t})=>{const a=u.useMemo(()=>t.length==0?[]:Object.keys(t[0]).map(i=>({accessorKey:i,header:()=>e.jsx("span",{children:i})})),[t]),d=xt({data:t,columns:a,getCoreRowModel:gt(),getFilteredRowModel:mt(),getPaginationRowModel:ft(),initialState:{pagination:{pageSize:25}}}),{pageSize:r,pageIndex:c}=d.getState().pagination;return e.jsx(e.Fragment,{children:e.jsxs(S,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden",rowGap:1},children:[e.jsx(S,{sx:{flex:1,overflow:"hidden"},children:e.jsxs(Me,{sx:{height:"100%",display:"flex",flexDirection:"column"},component:Te,variant:"outlined",children:[e.jsxs(Ie,{size:"small",stickyHeader:!0,"aria-label":"sticky table",sx:{position:"relative"},children:[e.jsx(Re,{children:d.getHeaderGroups().map(i=>e.jsxs(Oe.Fragment,{children:[e.jsx(F,{children:i.headers.map(n=>e.jsx(w,{colSpan:n.colSpan,children:n.isPlaceholder?null:e.jsx("div",{children:re(n.column.columnDef.header,n.getContext())})},n.id))}),e.jsx(F,{children:i.headers.map(n=>e.jsx(w,{colSpan:n.colSpan,children:n.isPlaceholder?null:e.jsx("div",{children:n.column.getCanFilter()&&e.jsx("div",{children:e.jsx(Zt,{column:n.column,table:d})})})},n.id))})]},i.id))}),e.jsx(Ye,{children:d.getRowModel().rows.map(i=>e.jsx(F,{children:i.getVisibleCells().map(n=>e.jsx(w,{children:re(n.column.columnDef.cell,n.getContext())},n.id))},i.id))})]}),d.getFilteredRowModel().rows.length===0&&e.jsxs(S,{sx:{width:"100%",height:"100%",textAlign:"center",py:2,display:"flex",flexDirection:"column",alignItems:"center",rowGap:2},children:[e.jsx(ut,{}),"Datos no encontrados"]})]})}),e.jsx(Vt,{rowsPerPageOptions:[25,50,100,{label:"All",value:t.length}],component:"div",count:d.getFilteredRowModel().rows.length,rowsPerPage:r,page:c,labelDisplayedRows:({from:i,to:n,count:h})=>`${i}–${n} de ${h!==-1?h:`more than ${n}`}`,labelRowsPerPage:"Filas por Pagina :",SelectProps:{inputProps:{"aria-label":"rows per page"},id:"test-id"},onPageChange:(i,n)=>{d.setPageIndex(n)},onRowsPerPageChange:i=>{const n=i.target.value?Number(i.target.value):25;d.setPageSize(n)},ActionsComponent:bt})]})})};function Zt({column:t}){const a=t.getFilterValue();return e.jsx(wt,{value:a??"",onChange:d=>t.setFilterValue(d.target.value),placeholder:"Buscar...",inputProps:{"aria-label":"search"},id:`filter-column-by-${t.id}`,size:"small",fullWidth:!0})}const Ot=()=>{const{filters:t}=I(s=>s.dashboardSlice),[a,{isError:d,isLoading:r,isSuccess:c,data:i}]=et(),[n,h]=u.useState(0),[o,l]=u.useState(!1),x=()=>{l(!1)},p=()=>{!r&&c&&i&&l(!0)};return u.useEffect(()=>{t.ctrl_id!=""&&t.date!=null&&a(void 0)},[t]),u.useEffect(()=>{!r&&c&&i&&h(i.total_tarjeta),!r&&d&&h(0)},[c,i,r,d]),e.jsxs(Y,{sx:{p:2.25},children:[e.jsx(j,{variant:"h6",color:"text.secondary",children:"Tarjetas"}),e.jsxs(S,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(v,{direction:"row",alignItems:"end",children:[e.jsx(j,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:n}),e.jsx(j,{color:"inherit",component:"span",variant:"body1",children:"asignados"})]}),e.jsx("img",{src:Xt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),e.jsx(v,{direction:"row",justifyContent:"end",children:t.is_monthly&&e.jsx(Z,{size:"small",onClick:p,children:"Ver Detalles"})}),e.jsx(Ae,{title:"Detalles Tarjetas Asignadas",onClose:x,open:o,children:!r&&c&&i&&e.jsx(Jt,{data:i.data})})]})},es="/assets/electricity-icon-a2e27661.svg",ts=()=>{const{filters:t,other_filters:a}=I(p=>p.dashboardSlice),[d,{isError:r,isLoading:c,isSuccess:i,data:n}]=tt(),[h,o]=u.useState(0),l=W(),x=H();return u.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:g}=t;d({ctrl_id:Number(p),date:s,monthly:g?"true":"false"})}},[t]),u.useEffect(()=>{!c&&i&&n&&o(n.acumulado),!c&&r&&o(0)},[i,n,c,r]),e.jsxs(Y,{sx:{p:2.25},children:[e.jsx(j,{variant:"h6",color:"text.secondary",children:"Potencia"}),e.jsxs(S,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(v,{direction:"row",alignItems:"end",spacing:1,children:[e.jsx(j,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:h}),e.jsx(j,{color:"inherit",component:"span",fontSize:30,lineHeight:1,children:"kw"}),e.jsx(j,{color:"inherit",component:"span",variant:"body1",children:"consumidos"})]}),e.jsx("img",{src:es,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(v,{direction:"row",justifyContent:"end",children:e.jsx(Pe,{component:"button",underline:"hover",onClick:()=>{x(K(a.region)),x(Q(t.ctrl_id)),x(z("energia")),x(U(T(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),x(G(T(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),l("/logs")},children:"Ver Mas"})})]})},ss=()=>{const[t,a]=u.useState({configs:{chart:{height:365,type:"bar",toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(m,b,y){return E(String(m),15,!0)}}},yaxis:{stepSize:1,min:0,max:m=>m+1,title:{text:"Temperatura Max",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[d,r]=u.useState([]),{filters:c}=I(m=>m.dashboardSlice),[i,{isError:n,isLoading:h,isSuccess:o,data:l}]=st(),x=L(),p=x.palette.mode;u.useEffect(()=>{a(m=>{const b=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...m.configs,chart:{...m.configs.chart,background:x.palette.background.paper},xaxis:{...m.configs.xaxis,labels:{...m.configs.xaxis?m.configs.xaxis.labels:{},style:{...m.configs.xaxis&&m.configs.xaxis.labels?m.configs.xaxis.labels.style:{},colors:b,cssClass:"apexcharts-xaxis-label"}},title:{...m.configs.xaxis?m.configs.xaxis.title:{},style:{color:b}}},yaxis:{...m.configs.yaxis,labels:{style:{colors:b,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),u.useEffect(()=>{if(c.ctrl_id!=""&&c.date!=null){const{ctrl_id:m,date:b,is_monthly:y}=c;i({ctrl_id:Number(m),date:b,monthly:y?"true":"false"})}},[c]),u.useEffect(()=>{if(!h&&o&&l){const m=Ce(l.data),b=Object.values(m).map(C=>C[0]),y=q(b,"ubicacion","max_valor");a(C=>({configs:{...C.configs,xaxis:{...C.configs.xaxis,categories:y.categories}}})),r([{data:y.series,name:"tickets"}])}!h&&n&&(a(m=>({configs:{...m.configs,xaxis:{...m.configs.xaxis,categories:[]}}})),r([]))},[o,l,h,n]);const[s,g]=u.useState(!1),_=()=>{g(!1)},D=()=>{!h&&o&&l&&g(!0)};return e.jsx(e.Fragment,{children:e.jsxs(S,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(j,{variant:"h5",children:"Temperatura"})}),e.jsx(f,{item:!0})]}),e.jsxs(Y,{sx:{mt:2,height:c.is_monthly?420:365},children:[e.jsx(N,{options:t.configs,series:d,type:"bar",height:365}),e.jsx(v,{direction:"row",justifyContent:"end",children:c.is_monthly&&e.jsx(Z,{size:"small",onClick:D,children:"Ver Detalles"})})]}),e.jsx(Ae,{title:"Detalles Temperatura",onClose:_,open:s,children:!h&&o&&l&&e.jsx(as,{data:Object.values(Ce(l.data))})})]})})},as=({data:t})=>e.jsx(Me,{component:Te,variant:"outlined",children:e.jsxs(Ie,{size:"small","aria-label":"a dense table",children:[e.jsx(Re,{children:e.jsxs(F,{children:[e.jsx(w,{children:"Sensor Temperatura"}),e.jsx(w,{children:"Serie"}),e.jsx(w,{children:"Max Valor"}),e.jsx(w,{children:"Fecha"}),e.jsx(w,{children:"Acción"})]})}),e.jsx(Ye,{children:t.map((a,d)=>e.jsx(is,{data:a},d))})]})}),is=({data:t})=>{const[a,d]=u.useState(!0),{filters:r,other_filters:c}=I(h=>h.dashboardSlice),i=W(),n=H();return e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(w,{children:e.jsxs(v,{direction:"row",alignItems:"center",children:[e.jsx(A,{"aria-label":"expand row",size:"small",onClick:()=>d(!a),children:a?e.jsx(jt,{}):e.jsx(yt,{})}),e.jsx(j,{children:t[0].ubicacion})]})}),e.jsx(w,{colSpan:4})]}),a&&t.map(h=>e.jsxs(F,{children:[e.jsx(w,{}),e.jsx(w,{children:h.serie}),e.jsx(w,{children:h.max_valor}),e.jsxs(w,{children:[" ",vt(h.fecha)]}),e.jsxs(w,{children:[" ",e.jsx(Z,{variant:"contained",color:"info",onClick:()=>{n(K(c.region)),n(Q(r.ctrl_id)),n(z("temperatura")),n(V([{id:"st_id",value:h.st_id}])),n(U(T(r.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),n(G(T(r.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})]})]},h.rtmp_id))]})};function Ce(t){const a={};return t.forEach(d=>{a[d.st_id]||(a[d.st_id]=[]),a[d.st_id].push(d)}),a}var O={},os=it;Object.defineProperty(O,"__esModule",{value:!0});var Ee=O.default=void 0,ns=os(at()),rs=e,ls=(0,ns.default)((0,rs.jsx)("path",{d:"M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z"}),"Memory");Ee=O.default=ls;const cs=()=>{const{filters:t}=I(l=>l.dashboardSlice),[a,{isError:d,isLoading:r,isSuccess:c,data:i}]=ot(),[n,h]=u.useState({camera:[],controller:[]}),o=L();return u.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:l}=t;a({ctrl_id:Number(l)})}},[t]),u.useEffect(()=>{!r&&c&&i&&h(i.states),!r&&d&&h({camera:[],controller:[]})},[c,i,r,d]),e.jsxs(S,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(j,{variant:"h5",children:"Estados"})}),e.jsx(f,{item:!0})]}),e.jsx(Y,{sx:{mt:2,height:t.is_monthly?420:365},children:e.jsx(S,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(S,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(_e,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(f,{container:!0,padding:2,rowSpacing:2,columnSpacing:2.5,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{variant:"h6",color:o.palette.text.secondary,children:"Camaras"})}),n.camera.map((l,x)=>e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(v,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(v,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(_t,{isSelected:!1}),e.jsxs(v,{children:[e.jsx(j,{variant:"h6",children:E(l.descripcion,15,!0)}),e.jsx(j,{variant:"caption",color:o.palette.text.secondary,children:E(l.tipo,15,!0)})]})]}),e.jsx(Se,{conectado:l.conectado})]})},x)),e.jsx(f,{item:!0,xs:12,children:e.jsx(Le,{})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{variant:"h6",color:o.palette.text.secondary,children:"Controladores"})}),n.controller.map((l,x)=>e.jsx(f,{item:!0,xs:12,sm:6,xl:4,children:e.jsxs(v,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(v,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Ee,{fontSize:"large"}),e.jsxs(v,{children:[e.jsx(j,{variant:"h6",children:E(l.nodo,15,!0)}),e.jsx(j,{variant:"caption",color:o.palette.text.secondary,children:E(l.descripcion,15,!0)})]})]}),e.jsx(Se,{conectado:l.conectado})]})},x))]})})})})})]})},Se=({conectado:t})=>t==0?e.jsx(S,{sx:{width:30,height:30,backgroundColor:"#f74c48",borderRadius:"50%"}}):t==1?e.jsx(S,{sx:{width:30,height:30,backgroundColor:"#04c584",borderRadius:"50%"}}):e.jsx(S,{sx:{width:30,height:30,backgroundColor:"#bfbfbf",borderRadius:"50%"}}),ds=k(f)(({theme:t})=>({[t.breakpoints.down("sm")]:{padding:"16px"},[t.breakpoints.up("sm")]:{padding:"24px"}}));function Ds(){return e.jsx(e.Fragment,{children:e.jsx(S,{sx:{width:"100%",height:"100%"},children:e.jsx(_e,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(ds,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(f,{item:!0,xs:12,sx:{mb:-2.25},children:e.jsx(j,{variant:"h5",children:"Dashboard"})}),e.jsx(hs,{}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Le,{})}),e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(qt,{})}),e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Ot,{})}),e.jsx(f,{item:!0,xs:12,sm:12,md:4,children:e.jsx(ts,{})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Wt,{})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Kt,{})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Qt,{})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Ut,{})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(ss,{})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(cs,{})})]})})})})}const hs=()=>{const{isSuccess:t,data:a}=nt(),{filters:{ctrl_id:d,date:r,is_monthly:c}}=I(o=>o.dashboardSlice),i=H(),n=o=>{i(ie(o.target.value));const l=o.target.value;if(l!=""&&t&&a){const x=a.find(p=>String(p.ctrl_id)==l);x&&i(oe(x.region))}},h=o=>{i(rt(o.target.checked))};return u.useEffect(()=>{if(t){const o=a[0];o&&d===""&&(i(ie(String(o.ctrl_id))),i(oe(o.region)))}},[t,a]),u.useEffect(()=>{i(ne(T().format("YYYY-MM")))},[]),e.jsx(e.Fragment,{children:e.jsxs(f,{item:!0,container:!0,xs:12,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(f,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(v,{spacing:1,children:[e.jsx(J,{htmlFor:"nodo-select",children:"Nodo"}),e.jsx(ke,{value:d,placeholder:"select-nodo",onChange:n,inputProps:{id:"nodo-select"},children:t&&a.map(o=>{const{ctrl_id:l,nodo:x}=o;return e.jsx(De,{value:l,children:x},l)})})]})}),e.jsx(f,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(v,{spacing:1,children:[e.jsx(J,{htmlFor:"date-select-dashboard",children:"Fecha"}),e.jsx(Ct,{views:["month","year"],ampm:!1,format:"YYYY/MM",value:r?T(r,"YYYY-MM"):T(),onChange:o=>{o&&i(ne(o.format("YYYY-MM")))},slotProps:{textField:{size:"medium",id:"date-select-dashboard"}}})]})}),e.jsx(f,{item:!0,xs:6,sm:6,md:4,lg:3,children:e.jsxs(v,{spacing:1,sx:{height:"100%"},children:[e.jsx(J,{htmlFor:"anual-mensual-switch",children:"Mensual"}),e.jsx(S,{sx:{flex:1,display:"flex",alignItems:"center"},children:e.jsx(pt,{size:"medium",checked:c,onChange:h,sx:{margin:0,width:60,height:28,"& .MuiSwitch-switchBase":{"&.Mui-checked":{transform:"translateX(32px)"}},"& .MuiSwitch-thumb":{width:22,height:22},"& .MuiSwitch-track":{borderRadius:24}},inputProps:{"aria-label":"controlled",id:"anual-mensual-switch"}})})]})})]})})};export{Ds as default};
