import{g as U,b as q,s as Q,a as R,aB as K,r as c,d as J,_ as X,j as e,f as Y,aA as g,h as Z,K as y,L as E,a_ as w,bn as ee,m as oe,as as re,bo as ae,I as ie,bp as te,bq as se,k as ne,E as F,G as le,S as de}from"./index-ada4c4db.js";import{d as ce,a as ue,T as pe}from"./KeyboardArrowUp-b63252cb.js";import{d as k}from"./CloseRounded-233eb786.js";import{a as xe,P as ge,b as ve,c as he,d as I,T as n,e as fe}from"./PaperTable-544c5933.js";import{g as be}from"./getFormattedDateTime-de75869e.js";import{C as je}from"./CardHeader-746a63d2.js";import{A as H}from"./Alert-d7598257.js";import{a as me,B as _}from"./Button-dd480b88.js";import{C}from"./Chip-97e8f171.js";import{S as Ce}from"./Select-8cf8581e.js";import{M as P}from"./MenuItem-012e34cd.js";import"./LastPage-0631ae57.js";function Re(a){return q("MuiButtonGroup",a)}const _e=U("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary"]),f=_e,$e=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],Te=(a,o)=>{const{ownerState:r}=a;return[{[`& .${f.grouped}`]:o.grouped},{[`& .${f.grouped}`]:o[`grouped${g(r.orientation)}`]},{[`& .${f.grouped}`]:o[`grouped${g(r.variant)}`]},{[`& .${f.grouped}`]:o[`grouped${g(r.variant)}${g(r.orientation)}`]},{[`& .${f.grouped}`]:o[`grouped${g(r.variant)}${g(r.color)}`]},o.root,o[r.variant],r.disableElevation===!0&&o.disableElevation,r.fullWidth&&o.fullWidth,r.orientation==="vertical"&&o.vertical]},ze=a=>{const{classes:o,color:r,disabled:i,disableElevation:t,fullWidth:u,orientation:s,variant:l}=a,p={root:["root",l,s==="vertical"&&"vertical",u&&"fullWidth",t&&"disableElevation"],grouped:["grouped",`grouped${g(s)}`,`grouped${g(l)}`,`grouped${g(l)}${g(s)}`,`grouped${g(l)}${g(r)}`,i&&"disabled"]};return Z(p,Re,o)},De=Q("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Te})(({theme:a,ownerState:o})=>R({display:"inline-flex",borderRadius:(a.vars||a).shape.borderRadius},o.variant==="contained"&&{boxShadow:(a.vars||a).shadows[2]},o.disableElevation&&{boxShadow:"none"},o.fullWidth&&{width:"100%"},o.orientation==="vertical"&&{flexDirection:"column"},{[`& .${f.grouped}`]:R({minWidth:40,"&:not(:first-of-type)":R({},o.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},o.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},o.variant==="outlined"&&o.orientation==="horizontal"&&{marginLeft:-1},o.variant==="outlined"&&o.orientation==="vertical"&&{marginTop:-1}),"&:not(:last-of-type)":R({},o.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},o.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},o.variant==="text"&&o.orientation==="horizontal"&&{borderRight:a.vars?`1px solid rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${f.disabled}`]:{borderRight:`1px solid ${(a.vars||a).palette.action.disabled}`}},o.variant==="text"&&o.orientation==="vertical"&&{borderBottom:a.vars?`1px solid rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${f.disabled}`]:{borderBottom:`1px solid ${(a.vars||a).palette.action.disabled}`}},o.variant==="text"&&o.color!=="inherit"&&{borderColor:a.vars?`rgba(${a.vars.palette[o.color].mainChannel} / 0.5)`:K(a.palette[o.color].main,.5)},o.variant==="outlined"&&o.orientation==="horizontal"&&{borderRightColor:"transparent"},o.variant==="outlined"&&o.orientation==="vertical"&&{borderBottomColor:"transparent"},o.variant==="contained"&&o.orientation==="horizontal"&&{borderRight:`1px solid ${(a.vars||a).palette.grey[400]}`,[`&.${f.disabled}`]:{borderRight:`1px solid ${(a.vars||a).palette.action.disabled}`}},o.variant==="contained"&&o.orientation==="vertical"&&{borderBottom:`1px solid ${(a.vars||a).palette.grey[400]}`,[`&.${f.disabled}`]:{borderBottom:`1px solid ${(a.vars||a).palette.action.disabled}`}},o.variant==="contained"&&o.color!=="inherit"&&{borderColor:(a.vars||a).palette[o.color].dark},{"&:hover":R({},o.variant==="outlined"&&o.orientation==="horizontal"&&{borderRightColor:"currentColor"},o.variant==="outlined"&&o.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),"&:hover":R({},o.variant==="contained"&&{boxShadow:"none"})},o.variant==="contained"&&{boxShadow:"none"})})),ke=c.forwardRef(function(o,r){const i=J({props:o,name:"MuiButtonGroup"}),{children:t,className:u,color:s="primary",component:l="div",disabled:p=!1,disableElevation:x=!1,disableFocusRipple:h=!1,disableRipple:v=!1,fullWidth:b=!1,orientation:j="horizontal",size:d="medium",variant:m="outlined"}=i,z=X(i,$e),T=R({},i,{color:s,component:l,disabled:p,disableElevation:x,disableFocusRipple:h,disableRipple:v,fullWidth:b,orientation:j,size:d,variant:m}),$=ze(T),D=c.useMemo(()=>({className:$.grouped,color:s,disabled:p,disableElevation:x,disableFocusRipple:h,disableRipple:v,fullWidth:b,size:d,variant:m}),[s,p,x,h,v,b,d,m,$.grouped]);return e.jsx(De,R({as:l,role:"group",className:Y($.root,u),ref:r,ownerState:T},z,{children:e.jsx(me.Provider,{value:D,children:t})}))}),ye=ke;var L={},Ee=E;Object.defineProperty(L,"__esModule",{value:!0});var S=L.default=void 0,Be=Ee(y()),Pe=e,Ae=(0,Be.default)((0,Pe.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");S=L.default=Ae;var G={},Ie=E;Object.defineProperty(G,"__esModule",{value:!0});var W=G.default=void 0,Le=Ie(y()),Ge=e,Me=(0,Le.default)((0,Ge.jsx)("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"CheckRounded");W=G.default=Me;var M={},Oe=E;Object.defineProperty(M,"__esModule",{value:!0});var N=M.default=void 0,Fe=Oe(y()),He=e,Se=(0,Fe.default)((0,He.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zM4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12zm8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8z"}),"DoDisturbAltRounded");N=M.default=Se;var O={},We=E;Object.defineProperty(O,"__esModule",{value:!0});var V=O.default=void 0,Ne=We(y()),Ve=e,Ue=(0,Ne.default)((0,Ve.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1zm3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1zm0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}),"AssignmentRounded");V=O.default=Ue;const A=({fechacomienzo:a,fechatermino:o,children:r,rangeDate:i=!1})=>{const[t,u]=c.useState(!1),s=()=>{const l=new Date(a),p=new Date(o),x=new Date,h=i?x>=l&&x<p:x<l;u(h)};return c.useEffect(()=>{s()},[]),c.useEffect(()=>{const l=setInterval(s,1e3);return()=>clearInterval(l)},[]),e.jsx(e.Fragment,{children:t&&r})},qe=c.lazy(()=>w(()=>import("./DialogDetallesTicket-eeff50cd.js"),["assets/DialogDetallesTicket-eeff50cd.js","assets/index-ada4c4db.js","assets/index-d33525bd.css","assets/PaperTable-544c5933.js","assets/getFormattedDateTime-de75869e.js","assets/SaveAltRounded-36381fdb.js","assets/DownloadRounded-87fe9040.js","assets/Close-179c157b.js","assets/ChooseFiles-821c9671.js","assets/InputLabel-40350896.js","assets/Select-8cf8581e.js","assets/Button-dd480b88.js","assets/DialogContent-61d6a3e8.js","assets/DialogTitle-bb2f3127.js","assets/CardHeader-746a63d2.js","assets/Divider-0676013f.js","assets/MenuItem-012e34cd.js"])),Qe=({id:a})=>a==1?e.jsx(C,{icon:e.jsx(S,{}),color:"warning",variant:"filled",label:"Pendiente"}):a==2?e.jsx(C,{icon:e.jsx(W,{}),color:"success",variant:"filled",label:"Aceptado"}):a==3?e.jsx(C,{icon:e.jsx(N,{}),color:"error",variant:"filled",label:"Cancelado"}):a==4?e.jsx(C,{icon:e.jsx(k,{}),label:"Rechazado"}):a==16?e.jsx(C,{icon:e.jsx(k,{}),label:"Finalizado"}):a==17?e.jsx(C,{icon:e.jsx(k,{}),label:"Anulado"}):a==18?e.jsx(C,{icon:e.jsx(k,{}),label:"No Atendido"}):e.jsx(C,{label:"Error id"}),Ke=({handleChangePage:a,handleChangeRowsPerPage:o,page:r,rowsPerPage:i,tickets:t})=>e.jsx(e.Fragment,{children:e.jsxs(F,{spacing:1,direction:"row",alignItems:"center",justifyContent:"end",children:[e.jsx("p",{children:"NÂ° Tickets:"}),e.jsxs(Ce,{id:"control-select",name:"control-select",value:i,onChange:o,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5}},children:[e.jsx(P,{value:10,children:10}),e.jsx(P,{value:20,children:20}),e.jsx(P,{value:50,children:50})]}),e.jsxs("p",{children:[t>0?r*i+1:0,"-",(r+1)*i<t?(r+1)*i:t," ","de ",t]}),e.jsx(pe,{count:t,onPageChange:a,rowsPerPage:i,page:r})]})}),Je=({ctrl_id:a,nodo:o})=>{const[r,i]=c.useState(!0),[t,u]=c.useState(0),[s,l]=c.useState(10),p=d=>{l(d.target.value),u(0)},x=(d,m)=>{u(m)},[h,{isError:v,isSuccess:b,data:j}]=ae();return c.useEffect(()=>{h({ctrl_id:a,limit:s,offset:t*s})},[a,t,s]),e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[e.jsx(n,{children:e.jsx(ie,{"aria-label":"expand row",size:"small",onClick:()=>i(!r),children:r?e.jsx(ce,{}):e.jsx(ue,{})})}),e.jsx(n,{children:o}),e.jsx(n,{colSpan:6,children:e.jsxs(e.Fragment,{children:[b&&r&&j&&e.jsx(Ke,{handleChangePage:x,handleChangeRowsPerPage:p,page:t,rowsPerPage:s,tickets:j.total_size}),v&&e.jsxs(H,{variant:"filled",severity:"error",children:["Error obtener tickets del nodo : ",o]})]})})]}),r&&b&&j&&e.jsx(e.Fragment,{children:j.data.map(d=>e.jsx(Xe,{ctrl_id:a,registroTicket:d},d.rt_id))})]})},Xe=({ctrl_id:a,registroTicket:o})=>{var m,z,T,$,D;const[r,i]=c.useState(o),[t,{isSuccess:u}]=te(),[s,{isSuccess:l,data:p}]=se(),[x,h]=c.useState(!1),v=ne(B=>B.auth),b=()=>{h(!1)},j=()=>{h(!0)},d=B=>{t({action:B,ctrl_id:a,rt_id:r.rt_id})};return c.useEffect(()=>{l&&p&&i(p)},[l,p]),c.useEffect(()=>{u&&s({ctrl_id:a,rt_id:r.rt_id})},[u]),e.jsx(e.Fragment,{children:e.jsxs(I,{children:[e.jsx(n,{}),e.jsx(n,{}),e.jsx(n,{children:r.rt_id}),e.jsxs(n,{children:[r.nombre.split(" ")[0].length>15?r.nombre.split(" ")[0].slice(0,15)+".":r.nombre.split(" ")[0]," ",r.apellido.split(" ")[0].length>15?r.apellido.split(" ")[0].slice(0,15)+".":r.apellido.split(" ")[0]]}),e.jsx(n,{children:r.descripcion.length>40?r.descripcion.slice(0,40)+" ...":r.descripcion}),e.jsx(n,{children:e.jsx(Qe,{id:r.estd_id})}),e.jsx(n,{children:be(r.fechacomienzo)}),e.jsx(n,{children:e.jsxs(F,{direction:"row",spacing:r.estd_id==1||r.estd_id==2?2:void 0,justifyContent:"space-between",children:[e.jsxs(ye,{variant:"contained","aria-label":"outlined button group",size:"small",color:"primary",children:[((m=v.user)==null?void 0:m.rol)==="Invitado"&&r.estd_id==1&&e.jsx(A,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:e.jsx(_,{onClick:()=>d(3),children:"Cancelar"})}),(((z=v.user)==null?void 0:z.rol)==="Usuario"||((T=v.user)==null?void 0:T.rol)==="Administrador")&&(r.estd_id==1||r.estd_id==2)&&e.jsxs(A,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:[r.estd_id==1&&e.jsx(_,{onClick:()=>d(2),children:"Aceptar"}),e.jsx(_,{onClick:()=>d(4),children:"Rechazar"}),e.jsx(_,{onClick:()=>d(3),children:"Cancelar"})]}),((($=v.user)==null?void 0:$.rol)==="Usuario"||((D=v.user)==null?void 0:D.rol)==="Administrador")&&r.estd_id==2&&e.jsxs(A,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!0,children:[e.jsx(_,{onClick:()=>d(16),children:"Finalizar"}),e.jsx(_,{onClick:()=>d(17),children:"Anular"})]})]}),e.jsx(_,{variant:"contained",color:"info",startIcon:e.jsx(V,{}),onClick:j,children:"Detalles"})]})}),x&&e.jsx(c.Suspense,{children:e.jsx(qe,{isOpen:x,handleCloseDialog:b,data:{ctrl_id:a,p_id:r.p_id,rt_id:r.rt_id}})})]})})},Ye=()=>{const{isSuccess:a,isError:o,data:r}=ee();return e.jsxs(e.Fragment,{children:[e.jsx(je,{title:e.jsx(oe,{component:"h5",variant:"h5",children:"HISTORIAL DE TICKETS"})}),e.jsx(re,{children:e.jsx(xe,{component:ge,children:e.jsxs(ve,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(he,{children:e.jsxs(I,{children:[e.jsx(n,{}),e.jsx(n,{children:"Nodo"}),e.jsx(n,{children:"#Ticket"}),e.jsx(n,{children:"Solicitante"}),e.jsx(n,{children:"Descripcion"}),e.jsx(n,{children:"Estado"}),e.jsx(n,{children:"Fecha Trabajo"}),e.jsx(n,{children:"Acciones"})]})}),e.jsxs(fe,{children:[a&&r.map(i=>{const{ctrl_id:t,nodo:u,region:s}=i;return e.jsx(Je,{ctrl_id:t,nodo:u,region:s},i.ctrl_id)}),o&&e.jsx(H,{variant:"filled",severity:"error",children:"Error al cargar nodos."})]})]})})})]})},uo=()=>e.jsx(e.Fragment,{children:e.jsx(le,{item:!0,xs:12,children:e.jsx(de,{children:e.jsx(Ye,{})})})});export{uo as HistorialPage,uo as default};
