import{c as ye,j as e,r as m,u as Be,I as A,g as Le,a as ze,s as R,m as ee,T as Ae,b as Ee,d as he,e as Z,i as Fe,f as He,h as Y,k as Ne,l as N,B as C,G as f,n as y,S as D,o as $e,p as te,q as W,t as We,v as se,w as ae,x as F,y as O,z as oe,A as P,C as ie,D as E,E as Qe,F as Ue,H as I,R as Ve,J as Ge,K as Ke,L as Xe,M as qe,N as Se,O as Je,P as ue,Q as ge,U as me,V as Ze}from"./index-f0602fa3.js";import{_ as Q}from"./react-apexcharts.min-ce49befb.js";import{M as Ce}from"./Link-b1b650ca.js";import{d as Oe}from"./Close-bf9f1fae.js";import{D as et,a as tt}from"./DialogContent-58c05bb8.js";import{D as st}from"./DialogTitle-84767259.js";import{u as at,f as fe,N as ot,g as it,a as nt,b as lt,S as rt}from"./index-2b511113.js";import{T as ct,d as dt,a as xt}from"./KeyboardArrowUp-5e6fe148.js";import{T as w,a as we,P as Me,b as Ie,c as Te,d as H,e as ve}from"./PaperTable-2638ecbf.js";import{K as ht,a as ut,D as gt}from"./DateTimePicker-d7f561e7.js";import{S as _e,I as mt}from"./Select-38dcde9d.js";import{M as Pe}from"./MenuItem-2cc91bea.js";import{T as ft}from"./TextField-0392c89c.js";import{B as xe}from"./Button-3abb1eb0.js";import{g as pt}from"./getFormattedDateTime-278d94f6.js";import{C as bt}from"./CameraIcon2-d8c82132.js";import{d as jt}from"./Memory-0caa84b3.js";import{D as Ye}from"./Divider-84c6206e.js";import{I as de}from"./InputLabel-be077aea.js";import"./date-time-utils-cff69ae6.js";import"./InputAdornment-44368113.js";import"./Popover-35ca4dea.js";import"./FormControl-a1f4b448.js";import"./Chip-5ed62098.js";import"./SwitchBase-fb99b934.js";import"./LastPage-a1d84463.js";const yt=ye(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),St=ye(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),Ct=m.forwardRef(function(a,c){const{backIconButtonProps:l,count:r,disabled:n=!1,getItemAriaLabel:o,nextIconButtonProps:g,onPageChange:d,page:i,rowsPerPage:x,showFirstButton:p,showLastButton:s,slots:u={},slotProps:b={},...k}=a,h=Be(),j=L=>{d(L,0)},S=L=>{d(L,i-1)},M=L=>{d(L,i+1)},le=L=>{d(L,Math.max(0,Math.ceil(r/x)-1))},U=u.firstButton??A,V=u.lastButton??A,B=u.nextButton??A,G=u.previousButton??A,K=u.firstButtonIcon??yt,z=u.lastButtonIcon??St,T=u.nextButtonIcon??ht,v=u.previousButtonIcon??ut,X=h?V:U,q=h?B:G,re=h?G:B,J=h?U:V,ce=h?b.lastButton:b.firstButton,_=h?b.nextButton:b.previousButton,Re=h?b.previousButton:b.nextButton,ke=h?b.firstButton:b.lastButton;return e.jsxs("div",{ref:c,...k,children:[p&&e.jsx(X,{onClick:j,disabled:n||i===0,"aria-label":o("first",i),title:o("first",i),...ce,children:h?e.jsx(z,{...b.lastButtonIcon}):e.jsx(K,{...b.firstButtonIcon})}),e.jsx(q,{onClick:S,disabled:n||i===0,color:"inherit","aria-label":o("previous",i),title:o("previous",i),..._??l,children:h?e.jsx(T,{...b.nextButtonIcon}):e.jsx(v,{...b.previousButtonIcon})}),e.jsx(re,{onClick:M,disabled:n||(r!==-1?i>=Math.ceil(r/x)-1:!1),color:"inherit","aria-label":o("next",i),title:o("next",i),...Re??g,children:h?e.jsx(v,{...b.previousButtonIcon}):e.jsx(T,{...b.nextButtonIcon})}),s&&e.jsx(J,{onClick:le,disabled:n||i>=Math.ceil(r/x)-1,"aria-label":o("last",i),title:o("last",i),...ke,children:h?e.jsx(K,{...b.firstButtonIcon}):e.jsx(z,{...b.lastButtonIcon})})]})}),wt=Ct;function Mt(t){return ze("MuiTablePagination",t)}const It=Le("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]),$=It;var pe;const Tt=R(w,{name:"MuiTablePagination",slot:"Root",overridesResolver:(t,a)=>a.root})(ee(({theme:t})=>({overflow:"auto",color:(t.vars||t).palette.text.primary,fontSize:t.typography.pxToRem(14),"&:last-child":{padding:0}}))),vt=R(Ae,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(t,a)=>({[`& .${$.actions}`]:a.actions,...a.toolbar})})(ee(({theme:t})=>({minHeight:52,paddingRight:2,[`${t.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[t.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${$.actions}`]:{flexShrink:0,marginLeft:20}}))),_t=R("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(t,a)=>a.spacer})({flex:"1 1 100%"}),Pt=R("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(t,a)=>a.selectLabel})(ee(({theme:t})=>({...t.typography.body2,flexShrink:0}))),Yt=R(_e,{name:"MuiTablePagination",slot:"Select",overridesResolver:(t,a)=>({[`& .${$.selectIcon}`]:a.selectIcon,[`& .${$.select}`]:a.select,...a.input,...a.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${$.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),Dt=R(Pe,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(t,a)=>a.menuItem})({}),Rt=R("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(t,a)=>a.displayedRows})(ee(({theme:t})=>({...t.typography.body2,flexShrink:0})));function kt({from:t,to:a,count:c}){return`${t}â€“${a} of ${c!==-1?c:`more than ${a}`}`}function Bt(t){return`Go to ${t} page`}const Lt=t=>{const{classes:a}=t;return He({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},Mt,a)},zt=m.forwardRef(function(a,c){const l=Ee({props:a,name:"MuiTablePagination"}),{ActionsComponent:r=wt,backIconButtonProps:n,className:o,colSpan:g,component:d=w,count:i,disabled:x=!1,getItemAriaLabel:p=Bt,labelDisplayedRows:s=kt,labelRowsPerPage:u="Rows per page:",nextIconButtonProps:b,onPageChange:k,onRowsPerPageChange:h,page:j,rowsPerPage:S,rowsPerPageOptions:M=[10,25,50,100],SelectProps:le={},showFirstButton:U=!1,showLastButton:V=!1,slotProps:B={},slots:G={},...K}=l,z=l,T=Lt(z),v=(B==null?void 0:B.select)??le,X=v.native?"option":Dt;let q;(d===w||d==="td")&&(q=g||1e3);const re=he(v.id),J=he(v.labelId),ce=()=>i===-1?(j+1)*S:S===-1?i:Math.min(i,(j+1)*S);return e.jsx(Tt,{colSpan:q,ref:c,as:d,ownerState:z,className:Z(T.root,o),...K,children:e.jsxs(vt,{className:T.toolbar,children:[e.jsx(_t,{className:T.spacer}),M.length>1&&e.jsx(Pt,{className:T.selectLabel,id:J,children:u}),M.length>1&&e.jsx(Yt,{variant:"standard",...!v.variant&&{input:pe||(pe=e.jsx(mt,{}))},value:S,onChange:h,id:re,labelId:J,...v,classes:{...v.classes,root:Z(T.input,T.selectRoot,(v.classes||{}).root),select:Z(T.select,(v.classes||{}).select),icon:Z(T.selectIcon,(v.classes||{}).icon)},disabled:x,children:M.map(_=>m.createElement(X,{...!Fe(X)&&{ownerState:z},className:T.menuItem,key:_.label?_.label:_,value:_.value?_.value:_},_.label?_.label:_))}),e.jsx(Rt,{className:T.displayedRows,children:s({from:i===0?0:j*S+1,to:ce(),count:i===-1?-1:i,page:j})}),e.jsx(r,{className:T.actions,backIconButtonProps:n,count:i,nextIconButtonProps:b,onPageChange:k,page:j,rowsPerPage:S,showFirstButton:U,showLastButton:V,slotProps:B.actions,slots:G.actions,getItemAriaLabel:p,disabled:x})]})})}),At=zt;function ne(t,a,c){const l=[],r=[];return t.length>0?(t.forEach(n=>{n[a]&&n[c]&&(l.push(n[a]),r.push(n[c]))}),{categories:l,series:r}):{categories:l,series:r}}const Et=()=>{const[t,a]=m.useState({configs:{chart:{type:"bar",id:"bar_active_pin_entrada",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#1668dc","#65a9f3"]}}),[c,l]=m.useState([]),{filters:r}=Y(s=>s.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=Ne(),x=N(),p=x.palette.mode;return m.useEffect(()=>{a(s=>{const u=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),m.useEffect(()=>{if(r.ctrl_id!=""&&r.date!=null){const{ctrl_id:s,date:u,is_monthly:b}=r;n({ctrl_id:Number(s),date:u,monthly:b?"true":"false"})}},[r]),m.useEffect(()=>{if(!g&&d&&i){const s=ne(i,"detector","total_activo");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),l([{data:s.series,name:"activaciones"}])}!g&&o&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),l([]))},[d,i,g,o]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{children:e.jsx(y,{variant:"h5",children:"Pines Entrada"})}),e.jsx(f,{})]}),e.jsx(D,{sx:{mt:2},children:e.jsx(Q,{options:t.configs,series:c,type:"bar",height:365})})]})})},Ft=()=>{const[t,a]=m.useState({configs:{chart:{type:"bar",id:"bar_active_pin_salida",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#d89614"]}}),[c,l]=m.useState([]),{filters:r}=Y(s=>s.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=$e(),x=N(),p=x.palette.mode;return m.useEffect(()=>{a(s=>{const u=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),m.useEffect(()=>{if(r.ctrl_id!=""&&r.date!=null){const{ctrl_id:s,date:u,is_monthly:b}=r;n({ctrl_id:Number(s),date:u,monthly:b?"true":"false"})}},[r]),m.useEffect(()=>{if(!g&&d&&i){const s=ne(i,"actuador","total_activo");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),l([{data:s.series,name:"activaciones"}])}!g&&o&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),l([]))},[d,i,g,o]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{children:e.jsx(y,{variant:"h5",children:"Pines Salida"})}),e.jsx(f,{})]}),e.jsx(D,{sx:{mt:2},children:e.jsx(Q,{options:t.configs,series:c,type:"bar",height:365})})]})})},Ht=()=>{const{filters:t,other_filters:a}=Y(h=>h.dashboardSlice),c=te(),l=W(),[r,n]=m.useState({configs:{chart:{type:"donut",height:365},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:"#8c8c8c"},value:{color:"#8c8c8c"}}}}},labels:["Registrado","No registrado","Remoto"],dataLabels:{formatter(h,j){return j.w.globals.series[j.seriesIndex]}},legend:{labels:{colors:"#8c8c8c"}}}}),[o,g]=m.useState([0,0,0]),[d,{isError:i,isLoading:x,isSuccess:p,data:s}]=We(),u=N(),b=u.palette.mode,k=m.useCallback((h,j,S)=>{const M=S.dataPointIndex;M!=null&&M!=null&&M>-1&&t.is_monthly&&(l(se(a.region)),l(ae(t.ctrl_id)),M==0?(l(F("acceso")),l(O([{id:"autorizacion",value:"1"},{id:"tipo",value:"1"}]))):M==1?(l(F("acceso")),l(O([{id:"autorizacion",value:"0"},{id:"tipo",value:"1"},{id:"co_id",value:"0"}]))):M==2&&(l(F("salida")),l(O([{id:"es_id",value:"1"},{id:"estado",value:"1"}]))),l(oe(P(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),l(ie(P(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),c("/logs"))},[t.is_monthly]);return m.useEffect(()=>{n(h=>{const j=b=="dark"?u.palette.text.secondary:u.palette.text.primary;return{configs:{...h.configs,chart:{...h.configs.chart,background:u.palette.background.paper},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:j},value:{color:j}}}}},legend:{...h.configs.legend,labels:{colors:j}}}}})},[b]),m.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:h,date:j,is_monthly:S}=t;d({ctrl_id:Number(h),date:j,monthly:S?"true":"false"})}},[t]),m.useEffect(()=>{!x&&p&&s&&(g([s.data.tarjeta.total_registrado,s.data.tarjeta.total_noregistrado,s.data.remoto.total_remoto]),n(h=>({configs:{...h.configs,chart:{...h.configs.chart,events:{click:k}}}}))),!x&&i&&g([0,0,0])},[p,s,x,i,t.is_monthly]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{children:e.jsx(y,{variant:"h5",children:"Accesos"})}),e.jsx(f,{})]}),e.jsx(D,{sx:{mt:2,height:365},children:e.jsx(Q,{options:r.configs,series:o,type:"donut",height:365})})]})})},Nt=()=>{const[t,a]=m.useState({configs:{chart:{type:"bar",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(s,u,b){return E(String(s),15,!0)}}},yaxis:{stepSize:1,min:0,max:s=>s+1,title:{text:"Numero Tickets",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[c,l]=m.useState([]),{filters:r}=Y(s=>s.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=Qe(),x=N(),p=x.palette.mode;return m.useEffect(()=>{a(s=>{const u=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),m.useEffect(()=>{if(r.ctrl_id!=""&&r.date!=null){const{ctrl_id:s,date:u,is_monthly:b}=r;n({ctrl_id:Number(s),date:u,monthly:b?"true":"false"})}},[r]),m.useEffect(()=>{if(!g&&d&&i){const s=ne(i.data,"contrata","total_ticket");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),l([{data:s.series,name:"tickets"}])}!g&&o&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),l([]))},[d,i,g,o]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{children:e.jsx(y,{variant:"h5",children:"Tickets"})}),e.jsx(f,{})]}),e.jsx(D,{sx:{mt:2,height:365},children:e.jsx(Q,{options:t.configs,series:c,type:"bar",height:365})})]})})},$t="/assets/alarm-icon-a43fb34b.svg",Wt=()=>{const{filters:t,other_filters:a}=Y(p=>p.dashboardSlice),[c,{isError:l,isLoading:r,isSuccess:n,data:o}]=Ue(),[g,d]=m.useState(0),i=te(),x=W();return m.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:u}=t;c({ctrl_id:Number(p),date:s,monthly:u?"true":"false"})}},[t]),m.useEffect(()=>{!r&&n&&o&&d(o.data.total_alarma),!r&&l&&d(0)},[n,o,r,l]),e.jsxs(D,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Alarmas"}),e.jsxs(C,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(I,{direction:"row",alignItems:"end",children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:g}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"activaciones"})]}),e.jsx("img",{src:$t,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(I,{direction:"row",justifyContent:"end",children:e.jsx(Ce,{component:"button",underline:"hover",onClick:()=>{x(se(a.region)),x(ae(t.ctrl_id)),x(F("salida")),x(oe(P(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),x(ie(P(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})})]})},Qt="/assets/tarjeta-icon-b78bb548.svg",De=({onClose:t,open:a,title:c,children:l})=>e.jsxs(et,{open:a,onClose:t,fullWidth:!0,maxWidth:"md",children:[e.jsx(st,{children:e.jsx(y,{component:"div",variant:"h5",children:c})}),e.jsx(A,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(Oe,{})}),e.jsx(tt,{dividers:!0,children:l})]}),Ut=({data:t})=>{const a=m.useMemo(()=>t.length==0?[]:Object.keys(t[0]).map(n=>({accessorKey:n,header:()=>e.jsx("span",{children:n})})),[t]),c=at({data:t,columns:a,getCoreRowModel:it(),getFilteredRowModel:nt(),getPaginationRowModel:lt(),initialState:{pagination:{pageSize:25}}}),{pageSize:l,pageIndex:r}=c.getState().pagination;return e.jsx(e.Fragment,{children:e.jsxs(C,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden",rowGap:1},children:[e.jsx(C,{sx:{flex:1,overflow:"hidden"},children:e.jsxs(we,{sx:{height:"100%",display:"flex",flexDirection:"column"},component:Me,variant:"outlined",children:[e.jsxs(Ie,{size:"small",stickyHeader:!0,"aria-label":"sticky table",sx:{position:"relative"},children:[e.jsx(Te,{children:c.getHeaderGroups().map(n=>e.jsxs(Ve.Fragment,{children:[e.jsx(H,{children:n.headers.map(o=>e.jsx(w,{colSpan:o.colSpan,children:o.isPlaceholder?null:e.jsx("div",{children:fe(o.column.columnDef.header,o.getContext())})},o.id))}),e.jsx(H,{children:n.headers.map(o=>e.jsx(w,{colSpan:o.colSpan,children:o.isPlaceholder?null:e.jsx("div",{children:o.column.getCanFilter()&&e.jsx("div",{children:e.jsx(Vt,{column:o.column,table:c})})})},o.id))})]},n.id))}),e.jsx(ve,{children:c.getRowModel().rows.map(n=>e.jsx(H,{children:n.getVisibleCells().map(o=>e.jsx(w,{children:fe(o.column.columnDef.cell,o.getContext())},o.id))},n.id))})]}),c.getFilteredRowModel().rows.length===0&&e.jsxs(C,{sx:{width:"100%",height:"100%",textAlign:"center",py:2,display:"flex",flexDirection:"column",alignItems:"center",rowGap:2},children:[e.jsx(ot,{}),"Datos no encontrados"]})]})}),e.jsx(At,{rowsPerPageOptions:[25,50,100,{label:"All",value:t.length}],component:"div",count:c.getFilteredRowModel().rows.length,rowsPerPage:l,page:r,labelDisplayedRows:({from:n,to:o,count:g})=>`${n}â€“${o} de ${g!==-1?g:`more than ${o}`}`,labelRowsPerPage:"Filas por Pagina :",SelectProps:{inputProps:{"aria-label":"rows per page"},id:"test-id"},onPageChange:(n,o)=>{c.setPageIndex(o)},onRowsPerPageChange:n=>{const o=n.target.value?Number(n.target.value):25;c.setPageSize(o)},ActionsComponent:ct})]})})};function Vt({column:t}){const a=t.getFilterValue();return e.jsx(ft,{value:a??"",onChange:c=>t.setFilterValue(c.target.value),placeholder:"Buscar...",inputProps:{"aria-label":"search"},id:`filter-column-by-${t.id}`,size:"small",fullWidth:!0})}const Gt=()=>{const{filters:t}=Y(s=>s.dashboardSlice),[a,{isError:c,isLoading:l,isSuccess:r,data:n}]=Ge(),[o,g]=m.useState(0),[d,i]=m.useState(!1),x=()=>{i(!1)},p=()=>{!l&&r&&n&&i(!0)};return m.useEffect(()=>{t.ctrl_id!=""&&t.date!=null&&a(void 0)},[t]),m.useEffect(()=>{!l&&r&&n&&g(n.total_tarjeta),!l&&c&&g(0)},[r,n,l,c]),e.jsxs(D,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Tarjetas"}),e.jsxs(C,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(I,{direction:"row",alignItems:"end",children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:o}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"asignados"})]}),e.jsx("img",{src:Qt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),e.jsx(I,{direction:"row",justifyContent:"end",children:t.is_monthly&&e.jsx(xe,{size:"small",onClick:p,children:"Ver Detalles"})}),e.jsx(De,{title:"Detalles Tarjetas Asignadas",onClose:x,open:d,children:!l&&r&&n&&e.jsx(Ut,{data:n.data})})]})},Kt="/assets/electricity-icon-e7ff5bd6.svg",Xt=()=>{const{filters:t,other_filters:a}=Y(p=>p.dashboardSlice),[c,{isError:l,isLoading:r,isSuccess:n,data:o}]=Ke(),[g,d]=m.useState(0),i=te(),x=W();return m.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:u}=t;c({ctrl_id:Number(p),date:s,monthly:u?"true":"false"})}},[t]),m.useEffect(()=>{!r&&n&&o&&d(o.acumulado),!r&&l&&d(0)},[n,o,r,l]),e.jsxs(D,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Potencia"}),e.jsxs(C,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(I,{direction:"row",alignItems:"end",spacing:1,children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:g}),e.jsx(y,{color:"inherit",component:"span",fontSize:30,lineHeight:1,children:"kw"}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"consumidos"})]}),e.jsx("img",{src:Kt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(I,{direction:"row",justifyContent:"end",children:e.jsx(Ce,{component:"button",underline:"hover",onClick:()=>{x(se(a.region)),x(ae(t.ctrl_id)),x(F("energia")),x(oe(P(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),x(ie(P(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})})]})},qt=()=>{const[t,a]=m.useState({configs:{chart:{height:365,type:"bar",toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(h,j,S){return E(String(h),15,!0)}}},yaxis:{stepSize:1,min:0,max:h=>h+1,title:{text:"Temperatura Max",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[c,l]=m.useState([]),{filters:r}=Y(h=>h.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=Xe(),x=N(),p=x.palette.mode;m.useEffect(()=>{a(h=>{const j=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...h.configs,chart:{...h.configs.chart,background:x.palette.background.paper},xaxis:{...h.configs.xaxis,labels:{...h.configs.xaxis?h.configs.xaxis.labels:{},style:{...h.configs.xaxis&&h.configs.xaxis.labels?h.configs.xaxis.labels.style:{},colors:j,cssClass:"apexcharts-xaxis-label"}},title:{...h.configs.xaxis?h.configs.xaxis.title:{},style:{color:j}}},yaxis:{...h.configs.yaxis,labels:{style:{colors:j,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),m.useEffect(()=>{if(r.ctrl_id!=""&&r.date!=null){const{ctrl_id:h,date:j,is_monthly:S}=r;n({ctrl_id:Number(h),date:j,monthly:S?"true":"false"})}},[r]),m.useEffect(()=>{if(!g&&d&&i){const h=be(i.data),j=Object.values(h).map(M=>M[0]),S=ne(j,"ubicacion","max_valor");a(M=>({configs:{...M.configs,xaxis:{...M.configs.xaxis,categories:S.categories}}})),l([{data:S.series,name:"tickets"}])}!g&&o&&(a(h=>({configs:{...h.configs,xaxis:{...h.configs.xaxis,categories:[]}}})),l([]))},[d,i,g,o]);const[s,u]=m.useState(!1),b=()=>{u(!1)},k=()=>{!g&&d&&i&&u(!0)};return e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{children:e.jsx(y,{variant:"h5",children:"Temperatura"})}),e.jsx(f,{})]}),e.jsxs(D,{sx:{mt:2,height:r.is_monthly?420:365},children:[e.jsx(Q,{options:t.configs,series:c,type:"bar",height:365}),e.jsx(I,{direction:"row",justifyContent:"end",children:r.is_monthly&&e.jsx(xe,{size:"small",onClick:k,children:"Ver Detalles"})})]}),e.jsx(De,{title:"Detalles Temperatura",onClose:b,open:s,children:!g&&d&&i&&e.jsx(Jt,{data:Object.values(be(i.data))})})]})})},Jt=({data:t})=>e.jsx(we,{component:Me,variant:"outlined",children:e.jsxs(Ie,{size:"small","aria-label":"a dense table",children:[e.jsx(Te,{children:e.jsxs(H,{children:[e.jsx(w,{children:"Sensor Temperatura"}),e.jsx(w,{children:"Serie"}),e.jsx(w,{children:"Max Valor"}),e.jsx(w,{children:"Fecha"}),e.jsx(w,{children:"AcciÃ³n"})]})}),e.jsx(ve,{children:t.map((a,c)=>e.jsx(Zt,{data:a},c))})]})}),Zt=({data:t})=>{const[a,c]=m.useState(!0),{filters:l,other_filters:r}=Y(g=>g.dashboardSlice),n=te(),o=W();return e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(w,{children:e.jsxs(I,{direction:"row",alignItems:"center",children:[e.jsx(A,{"aria-label":"expand row",size:"small",onClick:()=>c(!a),children:a?e.jsx(dt,{}):e.jsx(xt,{})}),e.jsx(y,{children:t[0].ubicacion})]})}),e.jsx(w,{colSpan:4})]}),a&&t.map(g=>e.jsxs(H,{children:[e.jsx(w,{}),e.jsx(w,{children:g.serie}),e.jsx(w,{children:g.max_valor}),e.jsxs(w,{children:[" ",pt(g.fecha)]}),e.jsxs(w,{children:[" ",e.jsx(xe,{variant:"contained",color:"info",onClick:()=>{o(se(r.region)),o(ae(l.ctrl_id)),o(F("temperatura")),o(O([{id:"st_id",value:g.st_id}])),o(oe(P(l.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),o(ie(P(l.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),n("/logs")},children:"Ver Mas"})]})]},g.rtmp_id))]})};function be(t){const a={};return t.forEach(c=>{a[c.st_id]||(a[c.st_id]=[]),a[c.st_id].push(c)}),a}const Ot=()=>{const{filters:t}=Y(i=>i.dashboardSlice),[a,{isError:c,isLoading:l,isSuccess:r,data:n}]=qe(),[o,g]=m.useState({camera:[],controller:[]}),d=N();return m.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:i}=t;a({ctrl_id:Number(i)})}},[t]),m.useEffect(()=>{!l&&r&&n&&g(n.states),!l&&c&&g({camera:[],controller:[]})},[r,n,l,c]),e.jsxs(C,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{children:e.jsx(y,{variant:"h5",children:"Estados"})}),e.jsx(f,{})]}),e.jsx(D,{sx:{mt:2,height:t.is_monthly?420:365},children:e.jsx(C,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(C,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(Se,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(f,{container:!0,padding:2,rowSpacing:2,columnSpacing:2.5,children:[e.jsx(f,{size:{xs:12},children:e.jsx(y,{variant:"h6",color:d.palette.text.secondary,children:"Camaras"})}),o.camera.map((i,x)=>e.jsx(f,{size:{xs:12,sm:6,md:4},children:e.jsxs(I,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(I,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(bt,{isSelected:!1}),e.jsxs(I,{children:[e.jsx(y,{variant:"h6",children:E(i.descripcion,15,!0)}),e.jsx(y,{variant:"caption",color:d.palette.text.secondary,children:E(i.tipo,15,!0)})]})]}),e.jsx(je,{conectado:i.conectado})]})},x)),e.jsx(f,{size:{xs:12},children:e.jsx(Ye,{})}),e.jsx(f,{size:{xs:12},children:e.jsx(y,{variant:"h6",color:d.palette.text.secondary,children:"Controladores"})}),o.controller.map((i,x)=>e.jsx(f,{size:{xs:12,sm:6,md:4},children:e.jsxs(I,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(I,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(jt,{fontSize:"large"}),e.jsxs(I,{children:[e.jsx(y,{variant:"h6",children:E(i.nodo,15,!0)}),e.jsx(y,{variant:"caption",color:d.palette.text.secondary,children:E(i.descripcion,15,!0)})]})]}),e.jsx(je,{conectado:i.conectado})]})},x))]})})})})})]})},je=({conectado:t})=>t==0?e.jsx(C,{sx:{width:30,height:30,backgroundColor:"#f74c48",borderRadius:"50%"}}):t==1?e.jsx(C,{sx:{width:30,height:30,backgroundColor:"#04c584",borderRadius:"50%"}}):e.jsx(C,{sx:{width:30,height:30,backgroundColor:"#bfbfbf",borderRadius:"50%"}}),es=R(f)(({theme:t})=>({[t.breakpoints.down("sm")]:{padding:"16px"},[t.breakpoints.up("sm")]:{padding:"24px"}}));function _s(){return e.jsx(e.Fragment,{children:e.jsx(C,{sx:{width:"100%",height:"100%"},children:e.jsx(Se,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(es,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(f,{size:{xs:12},sx:{mb:-2.25},children:e.jsx(y,{variant:"h5",children:"Dashboard"})}),e.jsx(ts,{}),e.jsx(f,{size:{xs:12},children:e.jsx(Ye,{})}),e.jsx(f,{size:{xs:12,sm:6,md:4},children:e.jsx(Wt,{})}),e.jsx(f,{size:{xs:12,sm:6,md:4},children:e.jsx(Gt,{})}),e.jsx(f,{size:{xs:12,sm:12,md:4},children:e.jsx(Xt,{})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Et,{})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Ft,{})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Ht,{})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Nt,{})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(qt,{})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Ot,{})})]})})})})}const ts=()=>{const{isSuccess:t,data:a}=Je(),{filters:{ctrl_id:c,date:l,is_monthly:r}}=Y(d=>d.dashboardSlice),n=W(),o=d=>{n(ue(d.target.value));const i=d.target.value;if(i!=""&&t&&a){const x=a.find(p=>String(p.ctrl_id)==i);x&&n(ge(x.region))}},g=d=>{n(Ze(d.target.checked))};return m.useEffect(()=>{if(t){const d=a[0];d&&c===""&&(n(ue(String(d.ctrl_id))),n(ge(d.region)))}},[t,a]),m.useEffect(()=>{n(me(P().format("YYYY-MM")))},[]),e.jsx(e.Fragment,{children:e.jsxs(f,{container:!0,size:{xs:12},rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(f,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(I,{spacing:1,children:[e.jsx(de,{htmlFor:"nodo-select",children:"Nodo"}),e.jsx(_e,{value:c,placeholder:"select-nodo",onChange:o,inputProps:{id:"nodo-select"},children:t&&a.map(d=>{const{ctrl_id:i,nodo:x}=d;return e.jsx(Pe,{value:i,children:x},i)})})]})}),e.jsx(f,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(I,{spacing:1,children:[e.jsx(de,{htmlFor:"date-select-dashboard",children:"Fecha"}),e.jsx(gt,{views:["month","year"],ampm:!1,format:"YYYY/MM",value:l?P(l,"YYYY-MM"):P(),onChange:d=>{d&&n(me(d.format("YYYY-MM")))},slotProps:{textField:{size:"medium",id:"date-select-dashboard"}}})]})}),e.jsx(f,{size:{xs:6,sm:6,md:4,lg:3},children:e.jsxs(I,{spacing:1,sx:{height:"100%"},children:[e.jsx(de,{htmlFor:"anual-mensual-switch",children:"Mensual"}),e.jsx(C,{sx:{flex:1,display:"flex",alignItems:"center"},children:e.jsx(rt,{size:"medium",checked:r,onChange:g,sx:{margin:0,width:60,height:28,"& .MuiSwitch-switchBase":{"&.Mui-checked":{transform:"translateX(32px)"}},"& .MuiSwitch-thumb":{width:22,height:22},"& .MuiSwitch-track":{borderRadius:24}},inputProps:{"aria-label":"controlled",id:"anual-mensual-switch"}})})]})})]})})};export{_s as default};
