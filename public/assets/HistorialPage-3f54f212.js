import{g as Ve,a as qe,s as Qe,m as Ze,b0 as Je,r as f,b as Ke,c8 as Xe,j as e,d as Ye,c9 as et,ca as tt,a$ as B,f as rt,a5 as N,a6 as U,l as ot,cb as it,cc as nt,cd as st,ce as at,cf as dt,aH as ie,B as ne,n,aI as se,N as lt,O as ct,I as F,P as pt,b8 as $e,G as l,o as Q,aU as Z,aV as J,K as j,a9 as Re,V as E,ab as ae,ac as de,ai as le,aB as ut,cg as ht,ch as xt,E as te,ci as jt,cj as mt,h as gt,bC as V,S as vt,M as ce}from"./index-0f417446.js";import{d as ft,a as bt,T as Ct}from"./KeyboardArrowUp-279774e4.js";import{d as ee}from"./CloseRounded-a16ed7d1.js";import{a as _e,P as Be,b as ke,c as Se,d as X,T as u,e as ze}from"./PaperTable-7229cf4a.js";import{g as K}from"./getFormattedDateTime-9d155dc4.js";import{S as yt,s as Te}from"./ServerError-63a376ba.js";import{d as q}from"./DownloadRounded-384f7dd0.js";import{d as $t}from"./Close-acaba4a0.js";import{C as Rt,d as _t,R as g}from"./ChooseFiles-26dd88e0.js";import{D as w}from"./Divider-1baa4035.js";import{T as pe}from"./Tooltip-8d8fd028.js";import{A as De}from"./Alert-b47aa335.js";import{C as P}from"./Chip-dfbba96b.js";import"./LastPage-eb8486bd.js";function Bt(t){return qe("MuiButtonGroup",t)}const kt=Ve("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),a=kt,St=(t,i)=>{const{ownerState:r}=t;return[{[`& .${a.grouped}`]:i.grouped},{[`& .${a.grouped}`]:i[`grouped${B(r.orientation)}`]},{[`& .${a.grouped}`]:i[`grouped${B(r.variant)}`]},{[`& .${a.grouped}`]:i[`grouped${B(r.variant)}${B(r.orientation)}`]},{[`& .${a.grouped}`]:i[`grouped${B(r.variant)}${B(r.color)}`]},{[`& .${a.firstButton}`]:i.firstButton},{[`& .${a.lastButton}`]:i.lastButton},{[`& .${a.middleButton}`]:i.middleButton},i.root,i[r.variant],r.disableElevation===!0&&i.disableElevation,r.fullWidth&&i.fullWidth,r.orientation==="vertical"&&i.vertical]},zt=t=>{const{classes:i,color:r,disabled:p,disableElevation:c,fullWidth:s,orientation:o,variant:m}=t,$={root:["root",m,o,s&&"fullWidth",c&&"disableElevation",`color${B(r)}`],grouped:["grouped",`grouped${B(o)}`,`grouped${B(m)}`,`grouped${B(m)}${B(o)}`,`grouped${B(m)}${B(r)}`,p&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return rt($,Bt,i)},Tt=Qe("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:St})(Ze(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${a.lastButton},& .${a.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${a.lastButton},& .${a.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${a.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${a.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(([,i])=>i&&i.main).flatMap(([i])=>[{props:{variant:"text",color:i},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderColor:t.vars?`rgba(${t.vars.palette[i].mainChannel} / 0.5)`:Je(t.palette[i].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${a.lastButton},& .${a.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${a.lastButton},& .${a.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${a.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${a.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(([,i])=>i&&i.dark).map(([i])=>({props:{variant:"contained",color:i},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderColor:(t.vars||t).palette[i].dark}}}))],[`& .${a.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),Dt=f.forwardRef(function(i,r){const p=Ke({props:i,name:"MuiButtonGroup"}),{children:c,className:s,color:o="primary",component:m="div",disabled:$=!1,disableElevation:R=!1,disableFocusRipple:_=!1,disableRipple:C=!1,fullWidth:k=!1,orientation:D="horizontal",size:v="medium",variant:d="outlined",...O}=p,I={...p,color:o,component:m,disabled:$,disableElevation:R,disableFocusRipple:_,disableRipple:C,fullWidth:k,orientation:D,size:v,variant:d},S=zt(I),G=f.useMemo(()=>({className:S.grouped,color:o,disabled:$,disableElevation:R,disableFocusRipple:_,disableRipple:C,fullWidth:k,size:v,variant:d}),[o,$,R,_,C,k,v,d,S.grouped]),A=Xe(c),H=A.length,re=M=>{const z=M===0,W=M===H-1;return z&&W?"":z?S.firstButton:W?S.lastButton:S.middleButton};return e.jsx(Tt,{as:m,role:"group",className:Ye(S.root,s),ref:r,ownerState:I,...O,children:e.jsx(et.Provider,{value:G,children:A.map((M,z)=>e.jsx(tt.Provider,{value:re(z),children:M},z))})})}),wt=Dt;var xe={},Et=U;Object.defineProperty(xe,"__esModule",{value:!0});var we=xe.default=void 0,At=Et(N()),Pt=e;we=xe.default=(0,At.default)((0,Pt.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6m6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26"}),"Autorenew");var je={},Ft=U;Object.defineProperty(je,"__esModule",{value:!0});var Ee=je.default=void 0,It=Ft(N()),Lt=e;Ee=je.default=(0,It.default)((0,Lt.jsx)("path",{d:"M9 16.17 5.53 12.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0z"}),"CheckRounded");var me={},Ot=U;Object.defineProperty(me,"__esModule",{value:!0});var Ae=me.default=void 0,Gt=Ot(N()),Mt=e;Ae=me.default=(0,Gt.default)((0,Mt.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2M4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12m8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8"}),"DoDisturbAltRounded");var ge={},Nt=U;Object.defineProperty(ge,"__esModule",{value:!0});var Pe=ge.default=void 0,Ut=Nt(N()),Ht=e;Pe=ge.default=(0,Ut.default)((0,Ht.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1m3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"}),"AssignmentRounded");const ue=({fechacomienzo:t,fechatermino:i,children:r,rangeDate:p=!1})=>{const[c,s]=f.useState(!1),o=()=>{const m=new Date(t),$=new Date(i),R=new Date,_=p?R>=m&&R<$:R<m;s(_)};return f.useEffect(()=>{o()},[]),f.useEffect(()=>{const m=setInterval(o,1e3);return()=>clearInterval(m)},[]),e.jsx(e.Fragment,{children:c&&r})};var ve={},Wt=U;Object.defineProperty(ve,"__esModule",{value:!0});var Fe=ve.default=void 0,Vt=Wt(N()),qt=e;Fe=ve.default=(0,Vt.default)((0,qt.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m4.3 14.3c-.39.39-1.02.39-1.41 0L12 13.41 9.11 16.3c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L10.59 12 7.7 9.11a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 10.59l2.89-2.89c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 12l2.89 2.89c.38.38.38 1.02 0 1.41"}),"CancelRounded");var fe={},Qt=U;Object.defineProperty(fe,"__esModule",{value:!0});var Ie=fe.default=void 0,Zt=Qt(N()),Jt=e;Ie=fe.default=(0,Zt.default)((0,Jt.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd");const Kt=({foto:t})=>{const[i,r]=f.useState(null),p=m=>{r(m.currentTarget)},c=()=>{r(null)},s=!!i,o=s?"simple-popover":void 0;return e.jsxs("div",{children:[e.jsx(E,{"aria-describedby":o,variant:"contained",onClick:p,size:"small",children:"Ver Foto"}),e.jsx(ut,{id:o,open:s,anchorEl:i,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx("img",{src:`${Re}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(t)}`,onError:m=>{m.currentTarget.src=Te},alt:"actividad_personal_foto_perfil",width:200,height:200,style:{objectFit:"cover",borderRadius:"50%"}})})]})};function he(t,i){return i==="docs"?t.reduce((p,c)=>{const s=p,{tipo:o}=c;return(o==="application/pdf"||o==="application/vnd.ms-powerpoint"||o==="application/vnd.openxmlformats-officedocument.presentationml.presentation"||o==="application/vnd.ms-excel"||o==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||o==="application/msword"||o==="application/vnd.openxmlformats-officedocument.wordprocessingml.document")&&s.push(c),s},[]):i==="imgs"?t.reduce((p,c)=>{const s=p,{tipo:o}=c;return(o==="image/jpeg"||o==="image/png"||o==="image/svg+xml"||o==="image/gif"||o==="image/avif"||o==="image/apng"||o==="image/webp")&&s.push(c),s},[]):i==="vids"?t.reduce((p,c)=>{const s=p,{tipo:o}=c;return(o==="video/x-msvideo"||o==="video/mp4"||o==="video/mpeg"||o==="video/ogg"||o==="video/webm"||o==="video/3gpp")&&s.push(c),s},[]):[]}const Xt=({handleCloseDialog:t,isOpen:i,data:r})=>{const{ctrl_id:p,rt_id:c}=r,s=ot(),[o,m]=f.useState(null),[$,{isError:R,isSuccess:_,data:C,error:k,isLoading:D}]=it(),{isSuccess:v,data:d,isLoading:O,isError:I}=nt({ctrl_id:p,rt_id:c},{refetchOnMountOrArgChange:!0}),[S]=st(),[G]=at(),[A]=dt(),H=async(h,x)=>{try{const b=await S({filePath:h}).unwrap(),y=document.createElement("a");y.href=b,y.download=x,y.style.display="none",document.body.appendChild(y),y.click(),document.body.removeChild(y)}catch(b){console.error("Error al descargar el archivo",b)}},re=async()=>{try{const h=await G({ctrl_id:p,rt_id:c}).unwrap(),x=document.createElement("a");x.href=h,x.download=`archivo_respaldo_${p}_${c}_${Date.now()}.zip`,x.style.display="none",document.body.appendChild(x),x.click(),document.body.removeChild(x)}catch(h){console.error("Error al descargar el archivo ZIP:",h)}},M=async()=>{try{const h=await A({ctrl_id:p,rt_id:c}).unwrap(),x=document.createElement("a");x.href=h,x.download=`ticket_detalles_${Date.now()}.pdf`,x.style.display="none",document.body.appendChild(x),x.click(),document.body.removeChild(x)}catch(h){console.error("Error al descargar archivo pdf de los detalles del ticket.",h)}},[z,W]=f.useState(!1),Le=()=>{z&&(Y(null),oe([])),W(!z)},Oe=["image/jpeg","image/jpg","image/png","application/pdf","video/mp4"],[be,Y]=f.useState(null),[Ce,oe]=f.useState([]),Ge=h=>{ie.warn(()=>e.jsx(ne,{children:e.jsx(n,{component:"p",variant:"body1",children:h})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:se,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}})},Me=h=>{const x=new FormData;h.forEach(b=>{x.append("archivos",b)}),Y(x)},Ne=h=>{const x=new FormData;h.forEach(b=>{x.append("archivos",b)}),Y(x)},Ue=()=>{if(be){const h=new FormData,x=JSON.stringify({ctrl_id:p,rt_id:c});h.append("formvalues",x);for(const[b,y]of be.entries())h.append(b,y);$(h)}};return f.useEffect(()=>{if(v&&d){const{archivos_respaldo:h}=d;m(h)}},[v,d]),f.useEffect(()=>{R&&k&&ie.error(()=>e.jsx(ne,{children:e.jsx(n,{component:"p",variant:"body1",children:JSON.stringify(k)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:se,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}}),_&&C&&(ie.success(()=>e.jsx(ne,{children:e.jsx(n,{component:"p",variant:"body1",children:C.message})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:se,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}}),Y(null),oe([]),W(!1),m(C.data))},[R,_,C]),e.jsxs(lt,{open:i,onClose:t,fullWidth:!0,maxWidth:"xl",sx:{"& .MuiDialog-paper":{}},children:[e.jsx(ct,{children:e.jsx(n,{component:"div",variant:"h5",children:"Detalles"})}),e.jsx(F,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx($t,{})}),e.jsxs(pt,{dividers:!0,children:[O&&e.jsx($e,{children:"Cargando detalles ..."}),I&&e.jsx(yt,{children:"Error al cargar detalles del ticket."}),v&&d&&e.jsxs(l,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(l,{size:{xs:12,md:4},children:e.jsxs(Q,{children:[e.jsx(Z,{sx:{p:1},title:e.jsx(n,{component:"div",variant:"h5",children:"Solicitante"})}),e.jsx(w,{}),e.jsx(J,{children:e.jsxs(l,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(l,{size:{xs:12},children:e.jsxs(j,{spacing:.5,alignItems:"center",children:[e.jsx("img",{src:`${Re}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(d.solicitante.foto)}`,alt:"solicitante_foto_perfil",onError:h=>{h.currentTarget.src=Te},width:100,height:100,style:{objectFit:"cover",borderRadius:"50%"}}),e.jsx(n,{component:"p",variant:"h6",children:d.solicitante.nombre}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.cargo})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:6},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Nombre"}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.nombre})]})}),e.jsx(l,{size:{xs:6},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.telefono})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:6},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Correo"}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.correo})]})}),e.jsx(l,{size:{xs:6},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"DNI"}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.dni})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:6},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Cargo"}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.cargo})]})}),e.jsx(l,{size:{xs:6},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(n,{component:"p",variant:"body1",children:d.solicitante.contrata})]})})]})})]})}),e.jsx(l,{size:{xs:12,md:8},children:e.jsxs(Q,{children:[e.jsx(Z,{sx:{p:1},title:e.jsx(n,{component:"div",variant:"h5",children:"Ticket"}),action:e.jsx(pe,{title:"Generar PDF",placement:"left",children:e.jsx(F,{"aria-label":"download_ticket_details",onClick:M,children:e.jsx(q,{color:"info"})})})}),e.jsx(w,{}),e.jsx(J,{children:e.jsxs(l,{container:!0,rowSpacing:1.5,columnSpacing:1,children:[e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Tipo Trabajo"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.tipotrabajo})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Descripción"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.descripcion})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Prioridad"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.prioridad===1?"Alta":d.ticket.prioridad===2?"Medio":d.ticket.prioridad===3?"Bajo":"Error-Prioridad"})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.contrata})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Estado"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.estado})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Creación"}),e.jsx(n,{component:"p",variant:"body1",children:K(d.ticket.fechacreacion)})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Comienzo"}),e.jsx(n,{component:"p",variant:"body1",children:K(d.ticket.fechacomienzo)})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Termino"}),e.jsx(n,{component:"p",variant:"body1",children:K(d.ticket.fechatermino)})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Estado Final"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.fechaestadofinal&&K(d.ticket.fechaestadofinal)})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.telefono})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Correo"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.correo})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(j,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Numero Ticket:"}),e.jsx(n,{component:"p",variant:"body1",children:d.ticket.rt_id})]})})]})})]})}),e.jsx(l,{size:{xs:12},children:e.jsxs(Q,{children:[e.jsx(Z,{sx:{p:1},title:e.jsx(n,{component:"div",variant:"h5",children:"Personales"})}),e.jsx(w,{}),e.jsx(J,{children:e.jsx(_e,{component:Be,children:e.jsxs(ke,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(Se,{children:e.jsxs(X,{children:[e.jsx(u,{children:"N°"}),e.jsx(u,{children:"Nombre"}),e.jsx(u,{children:"Telefono"}),e.jsx(u,{children:"DNI"}),e.jsx(u,{children:"Cargo"}),e.jsx(u,{children:"Contrata"}),e.jsx(u,{children:"Foto"})]})}),e.jsx(ze,{children:d.personales.map((h,x)=>{const{ap_id:b,nombre:y,telefono:L,dni:T,cargo:He,contrata:We,foto:ye}=h;return e.jsxs(X,{children:[e.jsx(u,{children:x+1}),e.jsx(u,{children:y}),e.jsx(u,{children:L}),e.jsx(u,{children:T}),e.jsx(u,{children:He}),e.jsx(u,{children:We}),e.jsx(u,{children:ye&&e.jsx(Kt,{foto:ye},b+T)})]},b)})})]})})})]})}),e.jsx(l,{size:{xs:12},children:e.jsxs(Q,{children:[e.jsx(Z,{sx:{pl:1,py:1,pr:2},title:e.jsx(n,{component:"div",variant:"h5",children:"Archivos de Respaldo"}),action:e.jsxs(j,{direction:"row",spacing:2,children:[e.jsx(pe,{title:"Descargar ZIP",placement:"left",children:e.jsx(F,{"aria-label":"download_file_zip",onClick:re,children:e.jsx(q,{color:"primary"})})}),e.jsx(pe,{title:"Agregar archivo",placement:"bottom-end",children:e.jsxs(F,{"aria-label":"editar_archivos_respaldo",onClick:Le,children:[!z&&e.jsx(Ie,{color:"warning"}),z&&e.jsx(Fe,{color:"error"})]})})]})}),e.jsx(w,{}),e.jsx(J,{children:e.jsxs(l,{container:!0,rowSpacing:1,columnSpacing:1,children:[z&&e.jsx(l,{size:{xs:12},sx:{marginBottom:1,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:s.palette.divider},children:e.jsxs(j,{spacing:1,pb:1,children:[e.jsx(Rt,{supportedFormats:Oe,handleError:Ge,onUpload:Me,onDelete:Ne,count:5,maxSize:10,files:Ce,setFiles:oe,buttonStyle:{maxWidth:300},children:"Nuevos archivos de respaldo:"}),D&&e.jsx($e,{children:"Enviando ..."}),Ce.length>0&&e.jsx(j,{alignItems:"end",children:e.jsx(E,{sx:{maxWidth:300},onClick:Ue,variant:"contained",type:"submit",startIcon:e.jsx(_t,{}),children:"Guardar"})})]})}),e.jsx(l,{size:{xs:12,md:4},sx:{borderRightWidth:"2px",borderRightColor:s.palette.mode==="dark"?s.palette.divider:s.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(j,{direction:"column",spacing:1,children:[e.jsx(n,{component:"div",variant:"body1",children:"Documentos:"}),e.jsx(ae,{sx:{pr:1},children:o&&he(o,"docs").map((h,x,b)=>{const{at_id:y,ruta:L,nombreoriginal:T}=h;return e.jsx(de,{divider:x<b.length-1,secondaryAction:e.jsx(F,{edge:"end","aria-label":"download_doc",onClick:()=>{H(L,T)},children:e.jsx(q,{color:"info"})}),children:e.jsx(le,{primary:T,sx:{overflow:"hidden",textOverflow:"ellipsis"}})},y)})})]})}),e.jsx(l,{size:{xs:12,md:4},sx:{borderRightWidth:"2px",borderRightColor:s.palette.mode==="dark"?s.palette.divider:s.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(j,{direction:"column",spacing:1,children:[e.jsx(n,{component:"div",variant:"body1",children:"Fotos:"}),e.jsx(ae,{sx:{pr:1},children:o&&he(o,"imgs").map((h,x,b)=>{const{at_id:y,ruta:L,nombreoriginal:T}=h;return e.jsx(de,{divider:x<b.length-1,secondaryAction:e.jsx(F,{edge:"end","aria-label":"download_img",onClick:()=>{H(L,T)},children:e.jsx(q,{color:"info"})}),children:e.jsx(le,{primary:T,sx:{overflow:"hidden",textOverflow:"ellipsis"}})},y)})})]})}),e.jsx(l,{size:{xs:12,md:4},children:e.jsxs(j,{direction:"column",spacing:1,children:[e.jsx(n,{component:"div",variant:"body1",children:"Videos:"}),e.jsx(ae,{sx:{pr:1},children:o&&he(o,"vids").map((h,x,b)=>{const{at_id:y,ruta:L,nombreoriginal:T}=h;return e.jsx(de,{divider:x<b.length-1,secondaryAction:e.jsx(F,{edge:"end","aria-label":"download_vids",onClick:()=>{H(L,T)},children:e.jsx(q,{color:"info"})}),children:e.jsx(le,{primary:T,sx:{overflow:"hidden",textOverflow:"ellipsis"}})},y)})})]})})]})})]})})]})]})]})},Yt=({id:t})=>t===g.Esperando?e.jsx(P,{icon:e.jsx(we,{}),color:"warning",variant:"filled",label:"Pendiente"}):t===g.Aceptado?e.jsx(P,{icon:e.jsx(Ee,{}),color:"success",variant:"filled",label:"Aceptado"}):t===g.Cancelado?e.jsx(P,{icon:e.jsx(Ae,{}),color:"error",variant:"filled",label:"Cancelado"}):t===g.Rechazado?e.jsx(P,{icon:e.jsx(ee,{}),label:"Rechazado"}):t===g.Finalizado?e.jsx(P,{icon:e.jsx(ee,{}),label:"Finalizado"}):t===g.Anulado?e.jsx(P,{icon:e.jsx(ee,{}),label:"Anulado"}):t===g.NoAtendido?e.jsx(P,{icon:e.jsx(ee,{}),label:"No Atendido"}):e.jsx(P,{label:"Error id"}),er=({handleChangePage:t,handleChangeRowsPerPage:i,page:r,rowsPerPage:p,tickets:c})=>e.jsx(e.Fragment,{children:e.jsxs(j,{spacing:1,direction:"row",alignItems:"center",justifyContent:"end",children:[e.jsx("p",{children:"N° Tickets:"}),e.jsxs(vt,{id:"control-select",name:"control-select",value:p,onChange:i,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5}},children:[e.jsx(ce,{value:10,children:10}),e.jsx(ce,{value:20,children:20}),e.jsx(ce,{value:50,children:50})]}),e.jsxs("p",{children:[c>0?r*p+1:0,"-",(r+1)*p<c?(r+1)*p:c," de ",c]}),e.jsx(Ct,{count:c,onPageChange:t,rowsPerPage:p,page:r})]})}),tr=({ctrl_id:t,nodo:i})=>{const[r,p]=f.useState(!0),[c,s]=f.useState(0),[o,m]=f.useState(10),$=v=>{m(v.target.value),s(0)},R=(v,d)=>{s(d)},[_,{isError:C,isSuccess:k,data:D}]=xt();return f.useEffect(()=>{_({ctrl_id:t,limit:o,offset:c*o},!1)},[t,c,o]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(u,{children:e.jsx(F,{"aria-label":"expand row",size:"small",onClick:()=>p(!r),children:r?e.jsx(ft,{}):e.jsx(bt,{})})}),e.jsx(u,{children:te(i,15)}),e.jsx(u,{colSpan:6,children:e.jsxs(e.Fragment,{children:[k&&r&&D&&e.jsx(er,{handleChangePage:R,handleChangeRowsPerPage:$,page:c,rowsPerPage:o,tickets:D.total_size}),C&&e.jsxs(De,{variant:"filled",severity:"error",children:["Error obtener tickets del nodo : ",i]})]})})]}),r&&k&&D&&e.jsx(e.Fragment,{children:D.data.map(v=>e.jsx(rr,{ctrl_id:t,registroTicket:v},`${v.rt_id}_${v.estd_id}`))})]})},rr=({ctrl_id:t,registroTicket:i})=>{var d,O,I,S,G;const[r,p]=f.useState(i),[c,{isSuccess:s}]=jt(),[o,{isSuccess:m,data:$}]=mt(),[R,_]=f.useState(!1),C=gt(A=>A.auth),k=()=>{_(!1)},D=()=>{_(!0)},v=A=>{c({action:A,ctrl_id:t,rt_id:r.rt_id})};return f.useEffect(()=>{m&&$&&p($)},[m,$]),f.useEffect(()=>{s&&o({ctrl_id:t,rt_id:r.rt_id})},[s]),e.jsx(e.Fragment,{children:e.jsxs(X,{children:[e.jsx(u,{}),e.jsx(u,{}),e.jsx(u,{children:r.rt_id}),e.jsx(u,{children:`${te(r.nombre,15,!0)}  ${te(r.apellido,15)}`}),e.jsx(u,{children:te(r.descripcion,40,!0)}),e.jsx(u,{children:e.jsx(Yt,{id:r.estd_id})}),e.jsx(u,{children:K(r.fechacomienzo)}),e.jsx(u,{children:e.jsxs(j,{direction:"row",spacing:r.estd_id===g.Esperando||r.estd_id===g.Aceptado?2:void 0,justifyContent:"space-between",children:[e.jsx(wt,{variant:"contained","aria-label":"outlined button group",size:"small",color:"primary",children:e.jsxs(j,{direction:"row",spacing:1,children:[((d=C.user)==null?void 0:d.rl_id)===V.Invitado&&(r.estd_id===g.Esperando||r.estd_id===g.Aceptado)&&e.jsx(ue,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:e.jsx(E,{onClick:()=>v(g.Cancelado),children:"Cancelar"})}),(((O=C.user)==null?void 0:O.rl_id)===V.Usuario||((I=C.user)==null?void 0:I.rl_id)===V.Administrador)&&(r.estd_id===g.Esperando||r.estd_id===g.Aceptado)&&e.jsxs(ue,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:[r.estd_id===g.Esperando&&e.jsx(E,{onClick:()=>v(g.Aceptado),children:"Aceptar"}),r.estd_id===g.Esperando&&e.jsx(E,{onClick:()=>v(g.Rechazado),children:"Rechazar"}),r.estd_id===g.Aceptado&&e.jsx(E,{onClick:()=>v(g.Cancelado),children:"Cancelar"})]}),(((S=C.user)==null?void 0:S.rl_id)===V.Usuario||((G=C.user)==null?void 0:G.rl_id)===V.Administrador)&&r.estd_id===g.Aceptado&&e.jsxs(ue,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!0,children:[e.jsx(E,{onClick:()=>v(g.Finalizado),children:"Finalizar"}),e.jsx(E,{onClick:()=>v(g.Anulado),children:"Anular"})]})]})}),e.jsx(E,{variant:"contained",color:"info",startIcon:e.jsx(Pe,{}),onClick:D,children:"Detalles"})]})}),R&&e.jsx(Xt,{isOpen:R,handleCloseDialog:k,data:{ctrl_id:t,p_id:r.p_id,rt_id:r.rt_id}})]})})},or=()=>{const{isSuccess:t,isError:i,data:r}=ht();return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:e.jsx(n,{component:"h5",variant:"h5",children:"HISTORIAL DE TICKETS"})}),e.jsx(J,{children:e.jsx(_e,{component:Be,children:e.jsxs(ke,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(Se,{children:e.jsxs(X,{children:[e.jsx(u,{}),e.jsx(u,{children:"Nodo"}),e.jsx(u,{children:"#Ticket"}),e.jsx(u,{children:"Solicitante"}),e.jsx(u,{children:"Descripcion"}),e.jsx(u,{children:"Estado"}),e.jsx(u,{children:"Fecha Trabajo"}),e.jsx(u,{children:"Acciones"})]})}),e.jsxs(ze,{children:[t&&r.map(p=>{const{ctrl_id:c,nodo:s,region:o}=p;return e.jsx(tr,{ctrl_id:c,nodo:s,region:o},p.ctrl_id)}),i&&e.jsx(De,{variant:"filled",severity:"error",children:"Error al cargar nodos."})]})]})})})]})},vr=()=>e.jsx(e.Fragment,{children:e.jsx(l,{size:{xs:12},children:e.jsx(Q,{children:e.jsx(or,{})})})});export{vr as HistorialPage,vr as default};
