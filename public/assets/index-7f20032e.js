import{c as Se,j as e,r as g,_ as ve,u as k,a as T,I as A,g as $e,b as Ve,s as L,T as We,d as Ke,e as ae,f as $,i as Qe,h as Ue,k as R,l as Ge,B as w,G as f,m as b,S as D,n as qe,o as W,p as H,q as Xe,t as K,v as Q,w as z,x as V,y as U,z as I,A as G,C as E,D as Je,E as Ze,F as _,R as Oe,H as et,J as tt,K as st,L as at,M as it,N as ot,O as _e,P as nt,Q as ie,U as oe,V as ne,W as rt}from"./index-87ce3177.js";import{_ as N}from"./react-apexcharts.min-33d2365d.js";import{M as Pe}from"./Link-3d4a28a2.js";import{d as lt}from"./Close-8a53641f.js";import{D as ct,a as dt}from"./DialogContent-c76e3a96.js";import{D as xt}from"./DialogTitle-a9d71988.js";import{u as ht,f as re,N as ut,g as gt,a as mt,b as ft,S as pt}from"./index-01d01b35.js";import{T as bt,d as jt,a as yt}from"./KeyboardArrowUp-ddb199e7.js";import{T as S,a as Me,P as Te,b as Ie,c as Re,d as F,e as Ye}from"./PaperTable-21146a52.js";import{K as le,a as ce,D as Ct}from"./DateTimePicker-f68d6ca1.js";import{S as De,I as wt}from"./Select-bf490ba6.js";import{M as ke,D as Le}from"./MenuItem-fef4e83d.js";import{T as St}from"./TextField-e40dd1e3.js";import{B as Z,I as J}from"./InputLabel-fc6e2611.js";import{g as vt}from"./getFormattedDateTime-9f097ac1.js";import{C as _t}from"./CameraIcon2-68b4a6e8.js";import"./timeViewRenderers-526135d7.js";import"./InputAdornment-2c96eb30.js";import"./Chip-53dd8257.js";import"./LastPage-063f8549.js";import"./FormControl-63c0a756.js";const de=Se(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),xe=Se(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage");var he,ue,ge,me,fe,pe,be,je;const Pt=["backIconButtonProps","count","getItemAriaLabel","nextIconButtonProps","onPageChange","page","rowsPerPage","showFirstButton","showLastButton"],Mt=g.forwardRef(function(a,c){const{backIconButtonProps:r,count:d,getItemAriaLabel:i,nextIconButtonProps:n,onPageChange:x,page:o,rowsPerPage:l,showFirstButton:h,showLastButton:p}=a,s=ve(a,Pt),u=k(),P=C=>{x(C,0)},v=C=>{x(C,o-1)},m=C=>{x(C,o+1)},y=C=>{x(C,Math.max(0,Math.ceil(d/l)-1))};return e.jsxs("div",T({ref:c},s,{children:[h&&e.jsx(A,{onClick:P,disabled:o===0,"aria-label":i("first",o),title:i("first",o),children:u.direction==="rtl"?he||(he=e.jsx(xe,{})):ue||(ue=e.jsx(de,{}))}),e.jsx(A,T({onClick:v,disabled:o===0,color:"inherit","aria-label":i("previous",o),title:i("previous",o)},r,{children:u.direction==="rtl"?ge||(ge=e.jsx(le,{})):me||(me=e.jsx(ce,{}))})),e.jsx(A,T({onClick:m,disabled:d!==-1?o>=Math.ceil(d/l)-1:!1,color:"inherit","aria-label":i("next",o),title:i("next",o)},n,{children:u.direction==="rtl"?fe||(fe=e.jsx(ce,{})):pe||(pe=e.jsx(le,{}))})),p&&e.jsx(A,{onClick:y,disabled:o>=Math.ceil(d/l)-1,"aria-label":i("last",o),title:i("last",o),children:u.direction==="rtl"?be||(be=e.jsx(de,{})):je||(je=e.jsx(xe,{}))})]}))}),Tt=Mt;function It(t){return Ve("MuiTablePagination",t)}const Rt=$e("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]),B=Rt;var ye;const Yt=["ActionsComponent","backIconButtonProps","className","colSpan","component","count","getItemAriaLabel","labelDisplayedRows","labelRowsPerPage","nextIconButtonProps","onPageChange","onRowsPerPageChange","page","rowsPerPage","rowsPerPageOptions","SelectProps","showFirstButton","showLastButton"],Dt=L(S,{name:"MuiTablePagination",slot:"Root",overridesResolver:(t,a)=>a.root})(({theme:t})=>({overflow:"auto",color:(t.vars||t).palette.text.primary,fontSize:t.typography.pxToRem(14),"&:last-child":{padding:0}})),kt=L(We,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(t,a)=>T({[`& .${B.actions}`]:a.actions},a.toolbar)})(({theme:t})=>({minHeight:52,paddingRight:2,[`${t.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[t.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${B.actions}`]:{flexShrink:0,marginLeft:20}})),Lt=L("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(t,a)=>a.spacer})({flex:"1 1 100%"}),At=L("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(t,a)=>a.selectLabel})(({theme:t})=>T({},t.typography.body2,{flexShrink:0})),Et=L(De,{name:"MuiTablePagination",slot:"Select",overridesResolver:(t,a)=>T({[`& .${B.selectIcon}`]:a.selectIcon,[`& .${B.select}`]:a.select},a.input,a.selectRoot)})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${B.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),zt=L(ke,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(t,a)=>a.menuItem})({}),Ft=L("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(t,a)=>a.displayedRows})(({theme:t})=>T({},t.typography.body2,{flexShrink:0}));function Bt({from:t,to:a,count:c}){return`${t}–${a} of ${c!==-1?c:`more than ${a}`}`}function Ht(t){return`Go to ${t} page`}const Nt=t=>{const{classes:a}=t;return Ue({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},It,a)},$t=g.forwardRef(function(a,c){const r=Ke({props:a,name:"MuiTablePagination"}),{ActionsComponent:d=Tt,backIconButtonProps:i,className:n,colSpan:x,component:o=S,count:l,getItemAriaLabel:h=Ht,labelDisplayedRows:p=Bt,labelRowsPerPage:s="Rows per page:",nextIconButtonProps:u,onPageChange:P,onRowsPerPageChange:v,page:m,rowsPerPage:y,rowsPerPageOptions:C=[10,25,50,100],SelectProps:j={},showFirstButton:ze=!1,showLastButton:Fe=!1}=r,Be=ve(r,Yt),X=r,M=Nt(X),ee=j.native?"option":zt;let te;(o===S||o==="td")&&(te=x||1e3);const He=ae(j.id),se=ae(j.labelId),Ne=()=>l===-1?(m+1)*y:y===-1?l:Math.min(l,(m+1)*y);return e.jsx(Dt,T({colSpan:te,ref:c,as:o,ownerState:X,className:$(M.root,n)},Be,{children:e.jsxs(kt,{className:M.toolbar,children:[e.jsx(Lt,{className:M.spacer}),C.length>1&&e.jsx(At,{className:M.selectLabel,id:se,children:s}),C.length>1&&e.jsx(Et,T({variant:"standard"},!j.variant&&{input:ye||(ye=e.jsx(wt,{}))},{value:y,onChange:v,id:He,labelId:se},j,{classes:T({},j.classes,{root:$(M.input,M.selectRoot,(j.classes||{}).root),select:$(M.select,(j.classes||{}).select),icon:$(M.selectIcon,(j.classes||{}).icon)}),children:C.map(Y=>g.createElement(ee,T({},!Qe(ee)&&{ownerState:X},{className:M.menuItem,key:Y.label?Y.label:Y,value:Y.value?Y.value:Y}),Y.label?Y.label:Y))})),e.jsx(Ft,{className:M.displayedRows,children:p({from:l===0?0:m*y+1,to:Ne(),count:l===-1?-1:l,page:m})}),e.jsx(d,{className:M.actions,backIconButtonProps:i,count:l,nextIconButtonProps:u,onPageChange:P,page:m,rowsPerPage:y,showFirstButton:ze,showLastButton:Fe,getItemAriaLabel:h})]})}))}),Vt=$t;function q(t,a,c){const r=[],d=[];return t.length>0?(t.forEach(i=>{i[a]&&i[c]&&(r.push(i[a]),d.push(i[c]))}),{categories:r,series:d}):{categories:r,series:d}}const Wt=()=>{const[t,a]=g.useState({configs:{chart:{type:"bar",id:"bar_active_pin_entrada",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#1668dc","#65a9f3"]}}),[c,r]=g.useState([]),{filters:d}=R(s=>s.dashboardSlice),[i,{isError:n,isLoading:x,isSuccess:o,data:l}]=Ge(),h=k(),p=h.palette.mode;return g.useEffect(()=>{a(s=>{const u=p=="dark"?h.palette.text.secondary:h.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:h.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),g.useEffect(()=>{if(d.ctrl_id!=""&&d.date!=null){const{ctrl_id:s,date:u,is_monthly:P}=d;i({ctrl_id:Number(s),date:u,monthly:P?"true":"false"})}},[d]),g.useEffect(()=>{if(!x&&o&&l){const s=q(l,"detector","total_activo");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"activaciones"}])}!x&&n&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[o,l,x,n]),e.jsx(e.Fragment,{children:e.jsxs(w,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(b,{variant:"h5",children:"Pines Entrada"})}),e.jsx(f,{item:!0})]}),e.jsx(D,{sx:{mt:2},children:e.jsx(N,{options:t.configs,series:c,type:"bar",width:"100%",height:"auto"})})]})})},Kt=()=>{const[t,a]=g.useState({configs:{chart:{type:"bar",id:"bar_active_pin_salida",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#d89614"]}}),[c,r]=g.useState([]),{filters:d}=R(s=>s.dashboardSlice),[i,{isError:n,isLoading:x,isSuccess:o,data:l}]=qe(),h=k(),p=h.palette.mode;return g.useEffect(()=>{a(s=>{const u=p=="dark"?h.palette.text.secondary:h.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:h.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),g.useEffect(()=>{if(d.ctrl_id!=""&&d.date!=null){const{ctrl_id:s,date:u,is_monthly:P}=d;i({ctrl_id:Number(s),date:u,monthly:P?"true":"false"})}},[d]),g.useEffect(()=>{if(!x&&o&&l){const s=q(l,"actuador","total_activo");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"activaciones"}])}!x&&n&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[o,l,x,n]),e.jsx(e.Fragment,{children:e.jsxs(w,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(b,{variant:"h5",children:"Pines Salida"})}),e.jsx(f,{item:!0})]}),e.jsx(D,{sx:{mt:2},children:e.jsx(N,{options:t.configs,series:c,type:"bar",width:"100%",height:"auto"})})]})})},Qt=()=>{const{filters:t,other_filters:a}=R(v=>v.dashboardSlice),c=W(),r=H(),[d,i]=g.useState({configs:{chart:{type:"donut"},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:"#8c8c8c"},value:{color:"#8c8c8c"}}}}},labels:["Registrado","No registrado","Remoto"],dataLabels:{formatter(v,m){return m.w.globals.series[m.seriesIndex]}},legend:{labels:{colors:"#8c8c8c"}}}}),[n,x]=g.useState([0,0,0]),[o,{isError:l,isLoading:h,isSuccess:p,data:s}]=Xe(),u=k(),P=u.palette.mode;return g.useEffect(()=>{i(v=>{const m=P=="dark"?u.palette.text.secondary:u.palette.text.primary;return{configs:{...v.configs,chart:{...v.configs.chart,background:u.palette.background.paper},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:m},value:{color:m}}}}},legend:{...v.configs.legend,labels:{colors:m}}}}})},[P]),g.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:v,date:m,is_monthly:y}=t;o({ctrl_id:Number(v),date:m,monthly:y?"true":"false"})}},[t]),g.useEffect(()=>{!h&&p&&s&&(x([s.data.tarjeta.total_registrado,s.data.tarjeta.total_noregistrado,s.data.remoto.total_remoto]),i(v=>({configs:{...v.configs,chart:{...v.configs.chart,events:{click:function(m,y,C){let j=C.dataPointIndex;j!=null&&j!=null&&j>-1&&t.is_monthly&&(console.log(j),r(K(a.region)),r(Q(t.ctrl_id)),j==0?(r(z("acceso")),r(V([{id:"autorizacion",value:"1"},{id:"tipo",value:"1"}]))):j==1?(r(z("acceso")),r(V([{id:"autorizacion",value:"0"},{id:"tipo",value:"1"},{id:"co_id",value:"0"}]))):j==2&&(r(z("salida")),r(V([{id:"es_id",value:"1"},{id:"estado",value:"1"}]))),r(U(I(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),r(G(I(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),c("/logs"))}}}}}))),!h&&l&&x([0,0,0])},[p,s,h,l]),e.jsx(e.Fragment,{children:e.jsxs(w,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(b,{variant:"h5",children:"Accesos"})}),e.jsx(f,{item:!0})]}),e.jsx(D,{sx:{mt:2},children:e.jsx(N,{options:d.configs,series:n,type:"donut",width:"100%",height:500})})]})})},Ut=()=>{const[t,a]=g.useState({configs:{chart:{height:350,type:"bar",toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(s,u,P){return E(String(s),15,!0)}}},yaxis:{stepSize:1,min:0,max:s=>s+1,title:{text:"Numero Tickets",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[c,r]=g.useState([]),{filters:d}=R(s=>s.dashboardSlice),[i,{isError:n,isLoading:x,isSuccess:o,data:l}]=Je(),h=k(),p=h.palette.mode;return g.useEffect(()=>{a(s=>{const u=p=="dark"?h.palette.text.secondary:h.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:h.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),g.useEffect(()=>{if(d.ctrl_id!=""&&d.date!=null){const{ctrl_id:s,date:u,is_monthly:P}=d;i({ctrl_id:Number(s),date:u,monthly:P?"true":"false"})}},[d]),g.useEffect(()=>{if(!x&&o&&l){const s=q(l.data,"contrata","total_ticket");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"tickets"}])}!x&&n&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[o,l,x,n]),e.jsx(e.Fragment,{children:e.jsxs(w,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(b,{variant:"h5",children:"Tickets"})}),e.jsx(f,{item:!0})]}),e.jsx(D,{sx:{mt:2,flex:1},children:e.jsx(N,{options:t.configs,series:c,type:"bar",width:"100%",height:"100%"})})]})})},Gt="/assets/alarm-icon-32250a4b.svg",qt=()=>{const{filters:t,other_filters:a}=R(p=>p.dashboardSlice),[c,{isError:r,isLoading:d,isSuccess:i,data:n}]=Ze(),[x,o]=g.useState(0),l=W(),h=H();return g.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:u}=t;c({ctrl_id:Number(p),date:s,monthly:u?"true":"false"})}},[t]),g.useEffect(()=>{!d&&i&&n&&o(n.data.total_alarma),!d&&r&&o(0)},[i,n,d,r]),e.jsxs(D,{sx:{p:2.25},children:[e.jsx(b,{variant:"h6",color:"text.secondary",children:"Alarmas"}),e.jsxs(w,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(_,{direction:"row",alignItems:"end",children:[e.jsx(b,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:x}),e.jsx(b,{color:"inherit",component:"span",variant:"body1",children:"activaciones"})]}),e.jsx("img",{src:Gt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(_,{direction:"row",justifyContent:"end",children:e.jsx(Pe,{component:"button",underline:"hover",onClick:()=>{h(K(a.region)),h(Q(t.ctrl_id)),h(z("salida")),h(U(I(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),h(G(I(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),l("/logs")},children:"Ver Mas"})})]})},Xt="/assets/tarjeta-icon-40f490cf.svg",Ae=({onClose:t,open:a,title:c,children:r})=>e.jsxs(ct,{open:a,onClose:t,fullWidth:!0,maxWidth:"md",children:[e.jsx(xt,{children:e.jsx(b,{component:"div",variant:"h5",children:c})}),e.jsx(A,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(lt,{})}),e.jsx(dt,{dividers:!0,children:r})]}),Jt=({data:t})=>{const a=g.useMemo(()=>t.length==0?[]:Object.keys(t[0]).map(i=>({accessorKey:i,header:()=>e.jsx("span",{children:i})})),[t]),c=ht({data:t,columns:a,getCoreRowModel:gt(),getFilteredRowModel:mt(),getPaginationRowModel:ft(),initialState:{pagination:{pageSize:25}}}),{pageSize:r,pageIndex:d}=c.getState().pagination;return e.jsx(e.Fragment,{children:e.jsxs(w,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden",rowGap:1},children:[e.jsx(w,{sx:{flex:1,overflow:"hidden"},children:e.jsxs(Me,{sx:{height:"100%",display:"flex",flexDirection:"column"},component:Te,variant:"outlined",children:[e.jsxs(Ie,{size:"small",stickyHeader:!0,"aria-label":"sticky table",sx:{position:"relative"},children:[e.jsx(Re,{children:c.getHeaderGroups().map(i=>e.jsxs(Oe.Fragment,{children:[e.jsx(F,{children:i.headers.map(n=>e.jsx(S,{colSpan:n.colSpan,children:n.isPlaceholder?null:e.jsx("div",{children:re(n.column.columnDef.header,n.getContext())})},n.id))}),e.jsx(F,{children:i.headers.map(n=>e.jsx(S,{colSpan:n.colSpan,children:n.isPlaceholder?null:e.jsx("div",{children:n.column.getCanFilter()&&e.jsx("div",{children:e.jsx(Zt,{column:n.column,table:c})})})},n.id))})]},i.id))}),e.jsx(Ye,{children:c.getRowModel().rows.map(i=>e.jsx(F,{children:i.getVisibleCells().map(n=>e.jsx(S,{children:re(n.column.columnDef.cell,n.getContext())},n.id))},i.id))})]}),c.getFilteredRowModel().rows.length===0&&e.jsxs(w,{sx:{width:"100%",height:"100%",textAlign:"center",py:2,display:"flex",flexDirection:"column",alignItems:"center",rowGap:2},children:[e.jsx(ut,{}),"Datos no encontrados"]})]})}),e.jsx(Vt,{rowsPerPageOptions:[25,50,100,{label:"All",value:t.length}],component:"div",count:c.getFilteredRowModel().rows.length,rowsPerPage:r,page:d,labelDisplayedRows:({from:i,to:n,count:x})=>`${i}–${n} de ${x!==-1?x:`more than ${n}`}`,labelRowsPerPage:"Filas por Pagina :",SelectProps:{inputProps:{"aria-label":"rows per page"},id:"test-id"},onPageChange:(i,n)=>{c.setPageIndex(n)},onRowsPerPageChange:i=>{const n=i.target.value?Number(i.target.value):25;c.setPageSize(n)},ActionsComponent:bt})]})})};function Zt({column:t}){const a=t.getFilterValue();return e.jsx(St,{value:a??"",onChange:c=>t.setFilterValue(c.target.value),placeholder:"Buscar...",inputProps:{"aria-label":"search"},id:`filter-column-by-${t.id}`,size:"small",fullWidth:!0})}const Ot=()=>{const{filters:t}=R(s=>s.dashboardSlice),[a,{isError:c,isLoading:r,isSuccess:d,data:i}]=et(),[n,x]=g.useState(0),[o,l]=g.useState(!1),h=()=>{l(!1)},p=()=>{!r&&d&&i&&l(!0)};return g.useEffect(()=>{t.ctrl_id!=""&&t.date!=null&&a(void 0)},[t]),g.useEffect(()=>{!r&&d&&i&&x(i.total_tarjeta),!r&&c&&x(0)},[d,i,r,c]),e.jsxs(D,{sx:{p:2.25},children:[e.jsx(b,{variant:"h6",color:"text.secondary",children:"Tarjetas"}),e.jsxs(w,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(_,{direction:"row",alignItems:"end",children:[e.jsx(b,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:n}),e.jsx(b,{color:"inherit",component:"span",variant:"body1",children:"asignados"})]}),e.jsx("img",{src:Xt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),e.jsx(_,{direction:"row",justifyContent:"end",children:t.is_monthly&&e.jsx(Z,{size:"small",onClick:p,children:"Ver Detalles"})}),e.jsx(Ae,{title:"Detalles Tarjetas Asignadas",onClose:h,open:o,children:!r&&d&&i&&e.jsx(Jt,{data:i.data})})]})},es="/assets/electricity-icon-a2e27661.svg",ts=()=>{const{filters:t,other_filters:a}=R(p=>p.dashboardSlice),[c,{isError:r,isLoading:d,isSuccess:i,data:n}]=tt(),[x,o]=g.useState(0),l=W(),h=H();return g.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:u}=t;c({ctrl_id:Number(p),date:s,monthly:u?"true":"false"})}},[t]),g.useEffect(()=>{!d&&i&&n&&o(n.acumulado),!d&&r&&o(0)},[i,n,d,r]),e.jsxs(D,{sx:{p:2.25},children:[e.jsx(b,{variant:"h6",color:"text.secondary",children:"Potencia"}),e.jsxs(w,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(_,{direction:"row",alignItems:"end",spacing:1,children:[e.jsx(b,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:x}),e.jsx(b,{color:"inherit",component:"span",fontSize:30,lineHeight:1,children:"kw"}),e.jsx(b,{color:"inherit",component:"span",variant:"body1",children:"consumidos"})]}),e.jsx("img",{src:es,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(_,{direction:"row",justifyContent:"end",children:e.jsx(Pe,{component:"button",underline:"hover",onClick:()=>{h(K(a.region)),h(Q(t.ctrl_id)),h(z("energia")),h(U(I(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),h(G(I(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),l("/logs")},children:"Ver Mas"})})]})},ss=()=>{const[t,a]=g.useState({configs:{chart:{height:350,type:"bar",toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(m,y,C){return E(String(m),15,!0)}}},yaxis:{stepSize:1,min:0,max:m=>m+1,title:{text:"Temperatura Max",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[c,r]=g.useState([]),{filters:d}=R(m=>m.dashboardSlice),[i,{isError:n,isLoading:x,isSuccess:o,data:l}]=st(),h=k(),p=h.palette.mode;g.useEffect(()=>{a(m=>{const y=p=="dark"?h.palette.text.secondary:h.palette.text.primary;return{configs:{...m.configs,chart:{...m.configs.chart,background:h.palette.background.paper},xaxis:{...m.configs.xaxis,labels:{...m.configs.xaxis?m.configs.xaxis.labels:{},style:{...m.configs.xaxis&&m.configs.xaxis.labels?m.configs.xaxis.labels.style:{},colors:y,cssClass:"apexcharts-xaxis-label"}},title:{...m.configs.xaxis?m.configs.xaxis.title:{},style:{color:y}}},yaxis:{...m.configs.yaxis,labels:{style:{colors:y,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),g.useEffect(()=>{if(d.ctrl_id!=""&&d.date!=null){const{ctrl_id:m,date:y,is_monthly:C}=d;i({ctrl_id:Number(m),date:y,monthly:C?"true":"false"})}},[d]),g.useEffect(()=>{if(!x&&o&&l){const m=Ce(l.data);let y=Object.values(m).map(j=>j[0]);const C=q(y,"ubicacion","max_valor");a(j=>({configs:{...j.configs,xaxis:{...j.configs.xaxis,categories:C.categories}}})),r([{data:C.series,name:"tickets"}])}!x&&n&&(a(m=>({configs:{...m.configs,xaxis:{...m.configs.xaxis,categories:[]}}})),r([]))},[o,l,x,n]);const[s,u]=g.useState(!1),P=()=>{u(!1)},v=()=>{!x&&o&&l&&u(!0)};return e.jsx(e.Fragment,{children:e.jsxs(w,{children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(b,{variant:"h5",children:"Temperatura"})}),e.jsx(f,{item:!0})]}),e.jsxs(D,{sx:{mt:2},children:[e.jsx(N,{options:t.configs,series:c,type:"bar",width:"100%",height:"auto"}),e.jsx(_,{direction:"row",justifyContent:"end",children:d.is_monthly&&e.jsx(Z,{size:"small",onClick:v,children:"Ver Detalles"})})]}),e.jsx(Ae,{title:"Detalles Temperatura",onClose:P,open:s,children:!x&&o&&l&&e.jsx(as,{data:Object.values(Ce(l.data))})})]})})},as=({data:t})=>e.jsx(Me,{component:Te,variant:"outlined",children:e.jsxs(Ie,{size:"small","aria-label":"a dense table",children:[e.jsx(Re,{children:e.jsxs(F,{children:[e.jsx(S,{children:"Sensor Temperatura"}),e.jsx(S,{children:"Serie"}),e.jsx(S,{children:"Max Valor"}),e.jsx(S,{children:"Fecha"}),e.jsx(S,{children:"Acción"})]})}),e.jsx(Ye,{children:t.map((a,c)=>e.jsx(is,{data:a},c))})]})}),is=({data:t})=>{const[a,c]=g.useState(!0),{filters:r,other_filters:d}=R(x=>x.dashboardSlice),i=W(),n=H();return e.jsxs(e.Fragment,{children:[e.jsxs(F,{children:[e.jsx(S,{children:e.jsxs(_,{direction:"row",alignItems:"center",children:[e.jsx(A,{"aria-label":"expand row",size:"small",onClick:()=>c(!a),children:a?e.jsx(jt,{}):e.jsx(yt,{})}),e.jsx(b,{children:t[0].ubicacion})]})}),e.jsx(S,{colSpan:4})]}),a&&t.map(x=>e.jsxs(F,{children:[e.jsx(S,{}),e.jsx(S,{children:x.serie}),e.jsx(S,{children:x.max_valor}),e.jsxs(S,{children:[" ",vt(x.fecha)]}),e.jsxs(S,{children:[" ",e.jsx(Z,{variant:"contained",color:"info",onClick:()=>{n(K(d.region)),n(Q(r.ctrl_id)),n(z("temperatura")),n(V([{id:"st_id",value:x.st_id}])),n(U(I(r.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),n(G(I(r.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})]})]},x.rtmp_id))]})};function Ce(t){const a={};return t.forEach(c=>{a[c.st_id]||(a[c.st_id]=[]),a[c.st_id].push(c)}),a}var O={},os=it;Object.defineProperty(O,"__esModule",{value:!0});var Ee=O.default=void 0,ns=os(at()),rs=e,ls=(0,ns.default)((0,rs.jsx)("path",{d:"M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z"}),"Memory");Ee=O.default=ls;const cs=()=>{const{filters:t}=R(l=>l.dashboardSlice),[a,{isError:c,isLoading:r,isSuccess:d,data:i}]=ot(),[n,x]=g.useState({camera:[],controller:[]}),o=k();return g.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:l}=t;a({ctrl_id:Number(l)})}},[t]),g.useEffect(()=>{!r&&d&&i&&x(i.states),!r&&c&&x({camera:[],controller:[]})},[d,i,r,c]),e.jsxs(w,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(f,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{item:!0,children:e.jsx(b,{variant:"h5",children:"Estados"})}),e.jsx(f,{item:!0})]}),e.jsx(D,{sx:{flex:1,mt:2},children:e.jsx(w,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(w,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(_e,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(f,{container:!0,padding:2,rowSpacing:2,columnSpacing:2.5,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(b,{variant:"h6",color:o.palette.text.secondary,children:"Camaras"})}),n.camera.map((l,h)=>e.jsx(f,{item:!0,xs:4,children:e.jsxs(_,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(_,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(_t,{isSelected:!1}),e.jsxs(_,{children:[e.jsx(b,{variant:"h6",children:E(l.descripcion,15,!0)}),e.jsx(b,{variant:"caption",color:o.palette.text.secondary,children:E(l.tipo,15,!0)})]})]}),e.jsx(we,{conectado:l.conectado})]})},h)),e.jsx(f,{item:!0,xs:12,children:e.jsx(Le,{})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(b,{variant:"h6",color:o.palette.text.secondary,children:"Controladores"})}),n.controller.map((l,h)=>e.jsx(f,{item:!0,xs:4,children:e.jsxs(_,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(_,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Ee,{fontSize:"large"}),e.jsxs(_,{children:[e.jsx(b,{variant:"h6",children:E(l.nodo,15,!0)}),e.jsx(b,{variant:"caption",color:o.palette.text.secondary,children:E(l.descripcion,15,!0)})]})]}),e.jsx(we,{conectado:l.conectado})]})},h))]})})})})})]})},we=({conectado:t})=>t==0?e.jsx(w,{sx:{width:30,height:30,backgroundColor:"#f74c48",borderRadius:"50%"}}):t==1?e.jsx(w,{sx:{width:30,height:30,backgroundColor:"#04c584",borderRadius:"50%"}}):e.jsx(w,{sx:{width:30,height:30,backgroundColor:"#bfbfbf",borderRadius:"50%"}});function Ds(){return e.jsx(e.Fragment,{children:e.jsx(w,{sx:{width:"100%",height:"100%"},children:e.jsx(_e,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(f,{container:!0,rowSpacing:4.5,columnSpacing:2.75,padding:4,children:[e.jsx(f,{item:!0,xs:12,sx:{mb:-2.25},children:e.jsx(b,{variant:"h5",children:"Dashboard"})}),e.jsx(ds,{}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Le,{})}),e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(qt,{})}),e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Ot,{})}),e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(ts,{})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(Wt,{})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(Kt,{})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(Qt,{})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(Ut,{})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(ss,{})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(cs,{})})]})})})})}const ds=()=>{const{isSuccess:t,data:a}=nt(),{filters:{ctrl_id:c,date:r,is_monthly:d}}=R(o=>o.dashboardSlice),i=H(),n=o=>{i(ie(o.target.value));const l=o.target.value;if(l!=""&&t&&a){const h=a.find(p=>String(p.ctrl_id)==l);h&&i(oe(h.region))}},x=o=>{i(rt(o.target.checked))};return g.useEffect(()=>{if(t){const o=a[0];o&&c===""&&(i(ie(String(o.ctrl_id))),i(oe(o.region)))}},[t,a]),g.useEffect(()=>{i(ne(I().format("YYYY-MM")))},[]),e.jsx(e.Fragment,{children:e.jsxs(f,{item:!0,container:!0,xs:12,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(f,{item:!0,xs:3,children:e.jsxs(_,{spacing:1,children:[e.jsx(J,{htmlFor:"nodo-select",children:"Nodo"}),e.jsx(De,{value:c,placeholder:"select-nodo",onChange:n,inputProps:{id:"nodo-select"},children:t&&a.map(o=>{const{ctrl_id:l,nodo:h}=o;return e.jsx(ke,{value:l,children:h},l)})})]})}),e.jsx(f,{item:!0,xs:3,children:e.jsxs(_,{spacing:1,children:[e.jsx(J,{htmlFor:"date-select-dashboard",children:"Fecha"}),e.jsx(Ct,{views:["month","year"],ampm:!1,format:"YYYY/MM",value:r?I(r,"YYYY-MM"):I(),onChange:o=>{o&&i(ne(o.format("YYYY-MM")))},slotProps:{textField:{size:"medium",id:"date-select-dashboard"}}})]})}),e.jsx(f,{item:!0,xs:1,children:e.jsxs(_,{spacing:1,sx:{height:"100%"},children:[e.jsx(J,{htmlFor:"anual-mensual-switch",children:"Mensual"}),e.jsx(w,{sx:{flex:1,display:"flex",alignItems:"center"},children:e.jsx(pt,{size:"medium",checked:d,onChange:x,sx:{margin:0,width:60,height:28,"& .MuiSwitch-switchBase":{"&.Mui-checked":{transform:"translateX(32px)"}},"& .MuiSwitch-thumb":{width:22,height:22},"& .MuiSwitch-track":{borderRadius:24}},inputProps:{"aria-label":"controlled",id:"anual-mensual-switch"}})})]})})]})})};export{Ds as default};
