import{c as Be,j as t,R as D,r as k,aE as Ye,aF as He,aG as Xe,aH as Ge,N as Ue,H as Z,S as te,n as E,au as ne,aI as X,G as L,D as I,$ as me,aJ as $e,a1 as Se,a5 as be,a7 as Ee,aK as Ke,s as Qe,aL as Ve,B as ie,I as Je,O as et}from"./index-54fe84d4.js";import{d as Ce,a as ye}from"./ExpandMore-2cd1aca0.js";import{S as G}from"./ServerError-4d271a15.js";import{a as tt,P as nt,b as it,c as rt,d as pe,T as F,e as at}from"./PaperTable-20332ffb.js";import{C as re}from"./CardHeader-1be41f83.js";import{D as W}from"./Divider-810634b2.js";import{F as ot}from"./FormControl-f5c79f79.js";import{S as st}from"./Select-4b6ce33a.js";import{M as ve}from"./MenuItem-950db8ad.js";import"./Popover-2ce99c9b.js";const lt=Be(t.jsx("path",{d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"}),"CloseRounded");function fe(i,l){var c=Object.keys(i);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);l&&(m=m.filter(function(o){return Object.getOwnPropertyDescriptor(i,o).enumerable})),c.push.apply(c,m)}return c}function B(i){for(var l=1;l<arguments.length;l++){var c=arguments[l]!=null?arguments[l]:{};l%2?fe(Object(c),!0).forEach(function(m){u(i,m,c[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):fe(Object(c)).forEach(function(m){Object.defineProperty(i,m,Object.getOwnPropertyDescriptor(c,m))})}return i}function u(i,l,c){return l in i?Object.defineProperty(i,l,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[l]=c,i}function ct(i,l){i.prototype=Object.create(l.prototype),i.prototype.constructor=i,ue(i,l)}function ue(i,l){return ue=Object.setPrototypeOf||function(m,o){return m.__proto__=o,m},ue(i,l)}function d(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function ht(i,l){var c;return function(){for(var m=arguments.length,o=new Array(m),f=0;f<m;f++)o[f]=arguments[f];var v=this;clearTimeout(c),c=setTimeout(function(){return i.apply(v,o)},l)}}function ae(i,l){for(;i;){if(i.classList&&i.classList.contains(l))return!0;i=i.parentElement}return!1}function Te(i){var l=i.getBoundingClientRect();return{x:l.left,y:l.top}}function ut(i,l,c){return"https://tile.openstreetmap.org/"+c+"/"+i+"/"+l+".png"}var ge=300,dt=1500,mt=150,pt=40,ce=2,xe=300,vt=60,ft=300,gt=300,q=function(){return!0},V=function(l,c){return(l+180)/360*Math.pow(2,c)},J=function(l,c){return(1-Math.log(Math.tan(l*Math.PI/180)+1/Math.cos(l*Math.PI/180))/Math.PI)/2*Math.pow(2,c)};function Y(i,l){return i/Math.pow(2,l)*360-180}function H(i,l){var c=Math.PI-2*Math.PI*i/Math.pow(2,l);return 180/Math.PI*Math.atan(.5*(Math.exp(c)-Math.exp(-c)))}function A(i,l){var c=Te(i);return[l.clientX-c.x,l.clientY-c.y]}function xt(i){return i*(2-i)}var ee=[H(Math.pow(2,10),10),H(0,10),Y(0,10),Y(Math.pow(2,10),10)],de=typeof window<"u",R=de&&window.performance&&window.performance.now?function(){return window.performance.now()}:function(){var i=new Date().getTime();return function(){return new Date().getTime()-i}}(),he=function(l){return de?(window.requestAnimationFrame||window.setTimeout)(l):(l(new Date().getTime()),null)},we=function(l){return de&&l?(window.cancelAnimationFrame||window.clearTimeout)(l):!1};function Me(i,l,c,m,o){return!i||i.length===0?"":i.map(function(f){return l(c,m,o,f)+(f===1?"":" "+f+"x")}).join(", ")}var wt=function(l){var c=l.tile,m=l.tileLoaded;return D.createElement("img",{src:c.url,srcSet:c.srcSet,width:c.width,height:c.height,loading:"lazy",onLoad:m,alt:"",style:{position:"absolute",left:c.left,top:c.top,willChange:"transform",transformOrigin:"top left",opacity:1}})},De=function(i){ct(l,i);function l(m){var o,f,v,M,x,w,b,j,e;return e=i.call(this,m)||this,u(d(e),"_containerRef",void 0),u(d(e),"_mousePosition",void 0),u(d(e),"_loadTracker",void 0),u(d(e),"_dragStart",null),u(d(e),"_mouseDown",!1),u(d(e),"_moveEvents",[]),u(d(e),"_lastClick",null),u(d(e),"_lastTap",null),u(d(e),"_lastWheel",null),u(d(e),"_touchStartPixel",null),u(d(e),"_touchStartMidPoint",null),u(d(e),"_touchStartDistance",null),u(d(e),"_secondTouchEnd",null),u(d(e),"_warningClearTimeout",null),u(d(e),"_isAnimating",!1),u(d(e),"_animationStart",null),u(d(e),"_animationEnd",null),u(d(e),"_zoomStart",null),u(d(e),"_centerTarget",null),u(d(e),"_zoomTarget",null),u(d(e),"_zoomAround",null),u(d(e),"_animFrame",null),u(d(e),"_boundsSynced",!1),u(d(e),"_minMaxCache",null),u(d(e),"_lastZoom",void 0),u(d(e),"_lastCenter",void 0),u(d(e),"_centerStart",void 0),u(d(e),"_resizeObserver",null),u(d(e),"updateWidthHeight",function(){if(e._containerRef){var n=e._containerRef.getBoundingClientRect();if(n&&n.width>0&&n.height>0)return e.setState({width:n.width,height:n.height}),!0}return!1}),u(d(e),"wa",function(){var n;return(n=window).addEventListener.apply(n,arguments)}),u(d(e),"wr",function(){var n;return(n=window).removeEventListener.apply(n,arguments)}),u(d(e),"bindMouseEvents",function(){e.wa("mousedown",e.handleMouseDown),e.wa("mouseup",e.handleMouseUp),e.wa("mousemove",e.handleMouseMove)}),u(d(e),"bindTouchEvents",function(){e.wa("touchstart",e.handleTouchStart,{passive:!1}),e.wa("touchmove",e.handleTouchMove,{passive:!1}),e.wa("touchend",e.handleTouchEnd,{passive:!1})}),u(d(e),"unbindMouseEvents",function(){e.wr("mousedown",e.handleMouseDown),e.wr("mouseup",e.handleMouseUp),e.wr("mousemove",e.handleMouseMove)}),u(d(e),"unbindTouchEvents",function(){e.wr("touchstart",e.handleTouchStart),e.wr("touchmove",e.handleTouchMove),e.wr("touchend",e.handleTouchEnd)}),u(d(e),"bindResizeEvent",function(){e.wa("resize",e.updateWidthHeight)}),u(d(e),"unbindResizeEvent",function(){e.wr("resize",e.updateWidthHeight)}),u(d(e),"bindWheelEvent",function(){e._containerRef&&e._containerRef.addEventListener("wheel",e.handleWheel,{passive:!1})}),u(d(e),"unbindWheelEvent",function(){e._containerRef&&e._containerRef.removeEventListener("wheel",e.handleWheel)}),u(d(e),"setCenterZoomTarget",function(n,r,a,s,h){if(a===void 0&&(a=!1),s===void 0&&(s=null),h===void 0&&(h=ge),e.props.animate&&(!a||e.distanceInScreens(n,r,e.state.center,e.state.zoom)<=e.props.animateMaxScreens)){if(e._isAnimating){we(e._animFrame);var p=e.animationStep(R()),g=p.centerStep,S=p.zoomStep;e._centerStart=g,e._zoomStart=S}else e._isAnimating=!0,e._centerStart=e.limitCenterAtZoom([e._lastCenter[0],e._lastCenter[1]],e._lastZoom),e._zoomStart=e._lastZoom,e.onAnimationStart();e._animationStart=R(),e._animationEnd=e._animationStart+h,s?(e._zoomAround=s,e._centerTarget=e.calculateZoomCenter(e._lastCenter,s,e._lastZoom,r)):(e._zoomAround=null,e._centerTarget=n),e._zoomTarget=r,e._animFrame=he(e.animate)}else if(e.stopAnimating(),s){var _=e.calculateZoomCenter(e._lastCenter,s,e._lastZoom,r);e.setCenterZoom(_,r,a)}else e.setCenterZoom(n||e.state.center,r,a)}),u(d(e),"setCenterZoomForChildren",function(n,r){e.setCenterZoomTarget(n||e.state.center,r||e.state.zoom,!0)}),u(d(e),"distanceInScreens",function(n,r,a,s){var h=e.state,p=h.width,g=h.height,S=e.latLngToPixel(a,a,s),_=e.latLngToPixel(n,a,s),C=e.latLngToPixel(a,a,r),T=e.latLngToPixel(n,a,r),y=(Math.abs(S[0]-_[0])+Math.abs(C[0]-T[0]))/2/p,O=(Math.abs(S[1]-_[1])+Math.abs(C[1]-T[1]))/2/g;return Math.sqrt(y*y+O*O)}),u(d(e),"animationStep",function(n){if(!e._animationEnd||!e._animationStart||!e._zoomTarget||!e._zoomStart||!e._centerStart||!e._centerTarget)return{centerStep:e.state.center,zoomStep:e.state.zoom};var r=e._animationEnd-e._animationStart,a=Math.max(n-e._animationStart,0),s=xt(a/r),h=(e._zoomTarget-e._zoomStart)*s,p=e._zoomStart+h;if(e._zoomAround){var g=e.calculateZoomCenter(e._centerStart,e._zoomAround,e._zoomStart,p);return{centerStep:g,zoomStep:p}}else{var S=[e._centerStart[0]+(e._centerTarget[0]-e._centerStart[0])*s,e._centerStart[1]+(e._centerTarget[1]-e._centerStart[1])*s];return{centerStep:S,zoomStep:p}}}),u(d(e),"animate",function(n){if(!e._animationEnd||n>=e._animationEnd)e._isAnimating=!1,e.setCenterZoom(e._centerTarget,e._zoomTarget,!0),e.onAnimationStop();else{var r=e.animationStep(n),a=r.centerStep,s=r.zoomStep;e.setCenterZoom(a,s),e._animFrame=he(e.animate)}}),u(d(e),"stopAnimating",function(){e._isAnimating&&(e._isAnimating=!1,e.onAnimationStop(),we(e._animFrame))}),u(d(e),"limitCenterAtZoom",function(n,r){var a=e.getBoundsMinMax(r||e.state.zoom);return[Math.max(Math.min(!n||isNaN(n[0])?e.state.center[0]:n[0],a[1]),a[0]),Math.max(Math.min(!n||isNaN(n[1])?e.state.center[1]:n[1],a[3]),a[2])]}),u(d(e),"onAnimationStart",function(){e.props.onAnimationStart&&e.props.onAnimationStart()}),u(d(e),"onAnimationStop",function(){e.props.onAnimationStop&&e.props.onAnimationStop()}),u(d(e),"setCenterZoom",function(n,r,a){a===void 0&&(a=!1);var s=e.limitCenterAtZoom(n,r);if(r&&Math.round(e.state.zoom)!==Math.round(r)){var h=e.tileValues(e.state),p=e.tileValues({center:s,zoom:r,width:e.state.width,height:e.state.height}),g=e.state.oldTiles;e.setState({oldTiles:g.filter(function(z){return z.roundedZoom!==h.roundedZoom}).concat(h)},q);for(var S={},_=p.tileMinX;_<=p.tileMaxX;_++)for(var C=p.tileMinY;C<=p.tileMaxY;C++){var T=_+"-"+C+"-"+p.roundedZoom;S[T]=!1}e._loadTracker=S}e.setState({center:s,zoom:r||e.state.zoom},q);var y=e.props.zoom?e.props.zoom:e._lastZoom,O=e.props.center?e.props.center:e._lastCenter;r&&(a||Math.abs(y-r)>.001||Math.abs(O[0]-s[0])>1e-5||Math.abs(O[1]-s[1])>1e-5)&&(e._lastZoom=r,e._lastCenter=[].concat(s),e.syncToProps(s,r))}),u(d(e),"getBoundsMinMax",function(n){if(e.props.limitBounds==="center")return ee;var r=e.state,a=r.width,s=r.height;if(e._minMaxCache&&e._minMaxCache[0]===n&&e._minMaxCache[1]===a&&e._minMaxCache[2]===s)return e._minMaxCache[3];var h=Math.pow(2,n)*256,p=a>h?0:Y(a/512,n),g=s>h?0:H(Math.pow(2,n)-s/512,n),S=a>h?0:Y(Math.pow(2,n)-a/512,n),_=s>h?0:H(s/512,n),C=[g,_,p,S];return e._minMaxCache=[n,a,s,C],C}),u(d(e),"tileLoaded",function(n){if(e._loadTracker&&n in e._loadTracker){e._loadTracker[n]=!0;var r=Object.values(e._loadTracker).filter(function(a){return!a}).length;r===0&&e.setState({oldTiles:[]},q)}}),u(d(e),"handleTouchStart",function(n){if(e._containerRef&&!(n.target&&ae(n.target,"pigeon-drag-block"))){if(n.touches.length===1){var r=n.touches[0],a=A(e._containerRef,r);if(e.coordsInside(a)&&(e._touchStartPixel=[a],!e.props.twoFingerDrag))if(e.stopAnimating(),e._lastTap&&R()-e._lastTap<xe){n.preventDefault();var s=e.pixelToLatLng(e._touchStartPixel[0]);e.setCenterZoomTarget(null,Math.max(e.props.minZoom,Math.min(e.state.zoom+1,e.props.maxZoom)),!1,s)}else e._lastTap=R(),e.trackMoveEvents(a)}else if(n.touches.length===2&&e._touchStartPixel){n.preventDefault(),e.stopTrackingMoveEvents(),(e.state.pixelDelta||e.state.zoomDelta)&&e.sendDeltaChange();var h=A(e._containerRef,n.touches[0]),p=A(e._containerRef,n.touches[1]);e._touchStartPixel=[h,p],e._touchStartMidPoint=[(h[0]+p[0])/2,(h[1]+p[1])/2],e._touchStartDistance=Math.sqrt(Math.pow(h[0]-p[0],2)+Math.pow(h[1]-p[1],2))}}}),u(d(e),"handleTouchMove",function(n){if(!e._containerRef){e._touchStartPixel=null;return}if(n.touches.length===1&&e._touchStartPixel){var r=n.touches[0],a=A(e._containerRef,r);e.props.twoFingerDrag?e.coordsInside(a)&&e.showWarning("fingers"):(n.preventDefault(),e.trackMoveEvents(a),e.setState({pixelDelta:[a[0]-e._touchStartPixel[0][0],a[1]-e._touchStartPixel[0][1]]},q))}else if(n.touches.length===2&&e._touchStartPixel&&e._touchStartMidPoint&&e._touchStartDistance){var s=e.state,h=s.width,p=s.height,g=s.zoom;n.preventDefault();var S=A(e._containerRef,n.touches[0]),_=A(e._containerRef,n.touches[1]),C=[(S[0]+_[0])/2,(S[1]+_[1])/2],T=[C[0]-e._touchStartMidPoint[0],C[1]-e._touchStartMidPoint[1]],y=Math.sqrt(Math.pow(S[0]-_[0],2)+Math.pow(S[1]-_[1],2)),O=Math.max(e.props.minZoom,Math.min(e.props.maxZoom,g+Math.log2(y/e._touchStartDistance)))-g,z=Math.pow(2,O),P=[(h/2-C[0])*(z-1),(p/2-C[1])*(z-1)];e.setState({zoomDelta:O,pixelDelta:[P[0]+T[0]*z,P[1]+T[1]*z]},q)}}),u(d(e),"handleTouchEnd",function(n){if(!e._containerRef){e._touchStartPixel=null;return}if(e._touchStartPixel){var r=e.props,a=r.zoomSnap,s=r.twoFingerDrag,h=r.minZoom,p=r.maxZoom,g=e.state.zoomDelta,S=e.sendDeltaChange(),_=S.center,C=S.zoom;if(n.touches.length===0)if(s)e.clearWarning();else{var T=e._touchStartPixel[0],y=A(e._containerRef,n.changedTouches[0]);(Math.abs(T[0]-y[0])>ce||Math.abs(T[1]-y[1])>ce)&&(!e._secondTouchEnd||R()-e._secondTouchEnd>ft)&&(n.preventDefault(),e.throwAfterMoving(y,_,C)),e._touchStartPixel=null,e._secondTouchEnd=null}else if(n.touches.length===1){n.preventDefault();var O=A(e._containerRef,n.touches[0]);if(e._secondTouchEnd=R(),e._touchStartPixel=[O],e.trackMoveEvents(O),a){var z=e._touchStartMidPoint?e.pixelToLatLng(e._touchStartMidPoint):e.state.center,P;s&&Math.round(e.state.zoom)===Math.round(e.state.zoom+g)?P=Math.round(e.state.zoom):P=g>0?Math.ceil(e.state.zoom):Math.floor(e.state.zoom);var N=Math.max(h,Math.min(P,p));e.setCenterZoomTarget(z,N,!1,z)}}}}),u(d(e),"handleMouseDown",function(n){if(e._containerRef){var r=A(e._containerRef,n);if(n.button===0&&(!n.target||!ae(n.target,"pigeon-drag-block"))&&e.coordsInside(r))if(e.stopAnimating(),n.preventDefault(),e._lastClick&&R()-e._lastClick<xe){if(!ae(n.target,"pigeon-click-block")){var a=e.pixelToLatLng(e._mousePosition||r);e.setCenterZoomTarget(null,Math.max(e.props.minZoom,Math.min(e.state.zoom+1,e.props.maxZoom)),!1,a)}}else e._lastClick=R(),e._mouseDown=!0,e._dragStart=r,e.trackMoveEvents(r)}}),u(d(e),"handleMouseMove",function(n){e._containerRef&&(e._mousePosition=A(e._containerRef,n),e._mouseDown&&e._dragStart&&(e.trackMoveEvents(e._mousePosition),e.setState({pixelDelta:[e._mousePosition[0]-e._dragStart[0],e._mousePosition[1]-e._dragStart[1]]},q)))}),u(d(e),"handleMouseUp",function(n){if(!e._containerRef){e._mouseDown=!1;return}var r=e.state.pixelDelta;if(e._mouseDown){e._mouseDown=!1;var a=A(e._containerRef,n);if(e.props.onClick&&(!n.target||!ae(n.target,"pigeon-click-block"))&&(!r||Math.abs(r[0])+Math.abs(r[1])<=ce)){var s=e.pixelToLatLng(a);e.props.onClick({event:n,latLng:s,pixel:a}),e.setState({pixelDelta:void 0},q)}else{var h=e.sendDeltaChange(),p=h.center,g=h.zoom;e.throwAfterMoving(a,p,g)}}}),u(d(e),"stopTrackingMoveEvents",function(){e._moveEvents=[]}),u(d(e),"trackMoveEvents",function(n){var r=R();(e._moveEvents.length===0||r-e._moveEvents[e._moveEvents.length-1].timestamp>40)&&(e._moveEvents.push({timestamp:r,coords:n}),e._moveEvents.length>2&&e._moveEvents.shift())}),u(d(e),"throwAfterMoving",function(n,r,a){var s=e.state,h=s.width,p=s.height,g=e.props.animate,S=R(),_=e._moveEvents.shift();if(_&&g){var C=Math.max(S-_.timestamp,1),T=[(n[0]-_.coords[0])/C*120,(n[1]-_.coords[1])/C*120],y=Math.sqrt(T[0]*T[0]+T[1]*T[1]);if(y>pt){var O=Math.sqrt(h*h+p*p),z=dt*y/O,P=Y(V(r[1],a)-T[0]/256,a),N=H(J(r[0],a)-T[1]/256,a);e.setCenterZoomTarget([N,P],a,!1,null,z)}}e.stopTrackingMoveEvents()}),u(d(e),"sendDeltaChange",function(){var n=e.state,r=n.center,a=n.zoom,s=n.pixelDelta,h=n.zoomDelta,p=r[0],g=r[1];return(s||h!==0)&&(g=Y(V(r[1],a+h)-(s?s[0]/256:0),a+h),p=H(J(r[0],a+h)-(s?s[1]/256:0),a+h),e.setCenterZoom([p,g],a+h)),e.setState({pixelDelta:void 0,zoomDelta:0},q),{center:e.limitCenterAtZoom([p,g],a+h),zoom:a+h}}),u(d(e),"getBounds",function(n,r){n===void 0&&(n=e.state.center),r===void 0&&(r=e.zoomPlusDelta());var a=e.state,s=a.width,h=a.height;return{ne:e.pixelToLatLng([s-1,0],n,r),sw:e.pixelToLatLng([0,h-1],n,r)}}),u(d(e),"syncToProps",function(n,r){n===void 0&&(n=e.state.center),r===void 0&&(r=e.state.zoom);var a=e.props.onBoundsChanged;if(a){var s=e.getBounds(n,r);a({center:n,zoom:r,bounds:s,initial:!e._boundsSynced}),e._boundsSynced=!0}}),u(d(e),"handleWheel",function(n){var r=e.props,a=r.mouseEvents,s=r.metaWheelZoom,h=r.zoomSnap,p=r.animate;if(a)if(!s||n.metaKey||n.ctrlKey){n.preventDefault();var g=-n.deltaY/mt;if(!h&&e._zoomTarget){var S=e._zoomTarget-e.state.zoom;e.zoomAroundMouse(g+S,n)}else p?e.zoomAroundMouse(g,n):(!e._lastWheel||R()-e._lastWheel>ge)&&(e._lastWheel=R(),e.zoomAroundMouse(g,n))}else e.showWarning("wheel")}),u(d(e),"showWarning",function(n){(!e.state.showWarning||e.state.warningType!==n)&&e.setState({showWarning:!0,warningType:n}),e._warningClearTimeout&&window.clearTimeout(e._warningClearTimeout),e._warningClearTimeout=window.setTimeout(e.clearWarning,gt)}),u(d(e),"clearWarning",function(){e.state.showWarning&&e.setState({showWarning:!1})}),u(d(e),"zoomAroundMouse",function(n,r){if(e._containerRef){var a=e.state.zoom,s=e.props,h=s.minZoom,p=s.maxZoom,g=s.zoomSnap;if(e._mousePosition=A(e._containerRef,r),!(!e._mousePosition||a===h&&n<0||a===p&&n>0)){var S=e.pixelToLatLng(e._mousePosition),_=a+n;g&&(_=n<0?Math.floor(_):Math.ceil(_)),_=Math.max(h,Math.min(_,p)),e.setCenterZoomTarget(null,_,!1,S)}}}),u(d(e),"zoomPlusDelta",function(){return e.state.zoom+e.state.zoomDelta}),u(d(e),"pixelToLatLng",function(n,r,a){r===void 0&&(r=e.state.center),a===void 0&&(a=e.zoomPlusDelta());var s=e.state,h=s.width,p=s.height,g=s.pixelDelta,S=[(n[0]-h/2-(g?g[0]:0))/256,(n[1]-p/2-(g?g[1]:0))/256],_=V(r[1],a)+S[0],C=J(r[0],a)+S[1];return[Math.max(ee[0],Math.min(ee[1],H(C,a))),Math.max(ee[2],Math.min(ee[3],Y(_,a)))]}),u(d(e),"latLngToPixel",function(n,r,a){r===void 0&&(r=e.state.center),a===void 0&&(a=e.zoomPlusDelta());var s=e.state,h=s.width,p=s.height,g=s.pixelDelta,S=V(r[1],a),_=J(r[0],a),C=V(n[1],a),T=J(n[0],a);return[(C-S)*256+h/2+(g?g[0]:0),(T-_)*256+p/2+(g?g[1]:0)]}),u(d(e),"calculateZoomCenter",function(n,r,a,s){var h=e.state,p=h.width,g=h.height,S=e.latLngToPixel(r,n,a),_=e.latLngToPixel(r,n,s),C=e.pixelToLatLng([p/2+_[0]-S[0],g/2+_[1]-S[1]],n,s);return e.limitCenterAtZoom(C,s)}),u(d(e),"setRef",function(n){e._containerRef=n}),e.syncToProps=ht(e.syncToProps,vt),e._lastZoom=(o=(f=m.defaultZoom)!==null&&f!==void 0?f:m.zoom)!==null&&o!==void 0?o:14,e._lastCenter=(v=(M=m.defaultCenter)!==null&&M!==void 0?M:m.center)!==null&&v!==void 0?v:[0,0],e.state={zoom:e._lastZoom,center:e._lastCenter,width:(x=(w=m.width)!==null&&w!==void 0?w:m.defaultWidth)!==null&&x!==void 0?x:-1,height:(b=(j=m.height)!==null&&j!==void 0?j:m.defaultHeight)!==null&&b!==void 0?b:-1,zoomDelta:0,pixelDelta:void 0,oldTiles:[],showWarning:!1,warningType:void 0},e}var c=l.prototype;return c.componentDidMount=function(){var o=this;this.props.mouseEvents&&this.bindMouseEvents(),this.props.touchEvents&&this.bindTouchEvents(),(!this.props.width||!this.props.height)&&(this.updateWidthHeight()||he(this.updateWidthHeight),this.bindResizeEvent()),this.bindWheelEvent(),this.syncToProps(),typeof window.ResizeObserver<"u"&&(this._resizeObserver=new window.ResizeObserver(function(){o.updateWidthHeight()}),this._resizeObserver.observe(this._containerRef))},c.componentWillUnmount=function(){this.props.mouseEvents&&this.unbindMouseEvents(),this.props.touchEvents&&this.unbindTouchEvents(),this.unbindWheelEvent(),(!this.props.width||!this.props.height)&&this.unbindResizeEvent(),this._resizeObserver&&this._resizeObserver.disconnect()},c.componentDidUpdate=function(o){var f;if(this.props.mouseEvents!==o.mouseEvents&&(this.props.mouseEvents?this.bindMouseEvents():this.unbindMouseEvents()),this.props.touchEvents!==o.touchEvents&&(this.props.touchEvents?this.bindTouchEvents():this.unbindTouchEvents()),this.props.width&&this.props.width!==o.width&&this.setState({width:this.props.width}),this.props.height&&this.props.height!==o.height&&this.setState({height:this.props.height}),!(!this.props.center&&!this.props.zoom)&&!((!this.props.center||this.props.center[0]===(o==null||(f=o.center)===null||f===void 0?void 0:f[0])&&this.props.center[1]===o.center[1])&&this.props.zoom===o.zoom)){var v=this._isAnimating?this._centerTarget:this.state.center,M=this._isAnimating?this._zoomTarget:this.state.zoom;if(v&&M){var x,w,b=(x=this.props.center)!==null&&x!==void 0?x:v,j=(w=this.props.zoom)!==null&&w!==void 0?w:M;(Math.abs(j-M)>.001||Math.abs(b[0]-v[0])>1e-4||Math.abs(b[1]-v[1])>1e-4)&&this.setCenterZoomTarget(b,j,!0)}}},c.coordsInside=function(o){var f=this.state,v=f.width,M=f.height;if(o[0]<0||o[1]<0||o[0]>=v||o[1]>=M)return!1;var x=this._containerRef;if(x){var w=Te(x),b=document.elementFromPoint(o[0]+w.x,o[1]+w.y);return x===b||x.contains(b)}else return!1},c.tileValues=function(o){var f=o.center,v=o.zoom,M=o.pixelDelta,x=o.zoomDelta,w=o.width,b=o.height,j=Math.round(v+(x||0)),e=v+(x||0)-j,n=Math.pow(2,e),r=w/n,a=b/n,s=V(f[1],j)-(M?M[0]/256/n:0),h=J(f[0],j)-(M?M[1]/256/n:0),p=r/2/256,g=a/2/256,S=Math.floor(s-p),_=Math.floor(s+p),C=Math.floor(h-g),T=Math.floor(h+g);return{tileMinX:S,tileMaxX:_,tileMinY:C,tileMaxY:T,tileCenterX:s,tileCenterY:h,roundedZoom:j,zoomDelta:x||0,scaleWidth:r,scaleHeight:a,scale:n}},c.renderTiles=function(){for(var o=this,f=this.state,v=f.oldTiles,M=f.width,x=f.height,w=this.props.dprs,b=this.props.provider||ut,j=this.tileValues(this.state),e=j.tileMinX,n=j.tileMaxX,r=j.tileMinY,a=j.tileMaxY,s=j.tileCenterX,h=j.tileCenterY,p=j.roundedZoom,g=j.scaleWidth,S=j.scaleHeight,_=j.scale,C=[],T=0;T<v.length;T++){var y=v[T],O=y.roundedZoom-p;if(!(Math.abs(O)>4||O===0))for(var z=1/Math.pow(2,O),P=-(e-y.tileMinX*z)*256,N=-(r-y.tileMinY*z)*256,se=Math.max(y.tileMinX,0),Le=Math.max(y.tileMinY,0),ze=Math.min(y.tileMaxX,Math.pow(2,y.roundedZoom)-1),Pe=Math.min(y.tileMaxY,Math.pow(2,y.roundedZoom)-1),U=se;U<=ze;U++)for(var $=Le;$<=Pe;$++)C.push({key:U+"-"+$+"-"+y.roundedZoom,url:b(U,$,y.roundedZoom),srcSet:Me(w,b,U,$,y.roundedZoom),left:P+(U-y.tileMinX)*256*z,top:N+($-y.tileMinY)*256*z,width:256*z,height:256*z,active:!1})}for(var Ze=Math.max(e,0),Oe=Math.max(r,0),ke=Math.min(n,Math.pow(2,p)-1),Ae=Math.min(a,Math.pow(2,p)-1),K=Ze;K<=ke;K++)for(var Q=Oe;Q<=Ae;Q++)C.push({key:K+"-"+Q+"-"+p,url:b(K,Q,p),srcSet:Me(w,b,K,Q,p),left:(K-e)*256,top:(Q-r)*256,width:256,height:256,active:!0});var Re={width:g,height:S,position:"absolute",top:"calc((100% - "+x+"px) / 2)",left:"calc((100% - "+M+"px) / 2)",overflow:"hidden",willChange:"transform",transform:"scale("+_+", "+_+")",transformOrigin:"top left"},We=this.props.boxClassname||"pigeon-tiles-box",Ie=-((s-e)*256-g/2),Fe=-((h-r)*256-S/2),Ne={position:"absolute",width:(n-e+1)*256,height:(a-r+1)*256,willChange:"transform",transform:"translate("+Ie+"px, "+Fe+"px)"},qe=this.props.tileComponent;return D.createElement("div",{style:Re,className:We},D.createElement("div",{className:"pigeon-tiles",style:Ne},C.map(function(le){return D.createElement(qe,{key:le.key,tile:le,tileLoaded:function(){return o.tileLoaded(le.key)}})})))},c.renderOverlays=function(){var o=this,f=this.state,v=f.width,M=f.height,x=f.center,w={bounds:this.getBounds(),zoom:this.zoomPlusDelta(),center:x,width:v,height:M},b=D.Children.map(this.props.children,function(e){if(!e)return null;if(!D.isValidElement(e))return e;var n=e.props,r=n.anchor,a=n.position,s=n.offset,h=o.latLngToPixel(r||a||x);return D.cloneElement(e,{left:h[0]-(s?s[0]:0),top:h[1]-(s?s[1]:0),latLngToPixel:o.latLngToPixel,pixelToLatLng:o.pixelToLatLng,setCenterZoom:o.setCenterZoomForChildren,mapProps:o.props,mapState:w})}),j={position:"absolute",width:v,height:M,top:"calc((100% - "+M+"px) / 2)",left:"calc((100% - "+v+"px) / 2)"};return D.createElement("div",{className:"pigeon-overlays",style:j},b)},c.renderAttribution=function(){var o=this.props,f=o.attribution,v=o.attributionPrefix;if(f===!1)return null;var M={position:"absolute",bottom:0,right:0,fontSize:"11px",padding:"2px 5px",background:"rgba(255, 255, 255, 0.7)",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif",color:"#333"},x={color:"#0078A8",textDecoration:"none"};return D.createElement("div",{key:"attr",className:"pigeon-attribution",style:M},v===!1?null:D.createElement("span",null,v||D.createElement("a",{href:"https://pigeon-maps.js.org/",style:x,target:"_blank",rel:"noreferrer noopener"},"Pigeon")," | "),f||D.createElement("span",null," © ",D.createElement("a",{href:"https://www.openstreetmap.org/copyright",style:x,target:"_blank",rel:"noreferrer noopener"},"OpenStreetMap")," contributors"))},c.renderWarning=function(){var o=this.props,f=o.metaWheelZoom,v=o.metaWheelZoomWarning,M=o.twoFingerDrag,x=o.twoFingerDragWarning,w=o.warningZIndex,b=this.state,j=b.showWarning,e=b.warningType,n=b.width,r=b.height;if(f&&v||M&&x){var a={position:"absolute",top:0,left:0,width:n,height:r,overflow:"hidden",pointerEvents:"none",opacity:j?100:0,transition:"opacity 300ms",background:"rgba(0,0,0,0.5)",color:"#fff",display:"flex",justifyContent:"center",alignItems:"center",fontSize:22,fontFamily:'"Arial", sans-serif',textAlign:"center",zIndex:w},s=typeof window<"u"&&window.navigator&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?"⌘":"ctrl",h=e==="fingers"?x:v;return D.createElement("div",{className:"pigeon-overlay-warning",style:a},h.replace("META",s))}else return null},c.render=function(){var o=this.props,f=o.touchEvents,v=o.twoFingerDrag,M=this.state,x=M.width,w=M.height,b={width:this.props.width?x:"100%",height:this.props.height?w:"100%",position:"relative",display:"inline-block",overflow:"hidden",background:"#dddddd",touchAction:f?v?"pan-x pan-y":"none":"auto"},j=!!(x&&w);return D.createElement("div",{style:b,ref:this.setRef,dir:"ltr"},j&&this.renderTiles(),j&&this.renderOverlays(),j&&this.renderAttribution(),j&&this.renderWarning())},l}(k.Component);u(De,"defaultProps",{animate:!0,metaWheelZoom:!1,metaWheelZoomWarning:"Use META + wheel to zoom!",twoFingerDrag:!1,twoFingerDragWarning:"Use two fingers to move the map",zoomSnap:!0,mouseEvents:!0,touchEvents:!0,warningZIndex:100,animateMaxScreens:5,minZoom:1,maxZoom:18,limitBounds:"center",dprs:[],tileComponent:wt});function Mt(i){var l=typeof i.width<"u"?i.width:typeof i.height<"u"?i.height*29/34:29,c=typeof i.height<"u"?i.height:typeof i.width<"u"?i.width*34/29:34,m=k.useState(i.hover||!1),o=m[0],f=m[1],v=typeof i.hover>"u"?o:i.hover,M=i.color||"#93C0D0",x=function(b){return{event:b,anchor:i.anchor,payload:i.payload}};return D.createElement("div",{style:B({position:"absolute",transform:"translate("+(i.left-l/2)+"px, "+(i.top-(c-1))+"px)",filter:v?"drop-shadow(0 0 4px rgba(0, 0, 0, .3))":"",pointerEvents:"none",cursor:"pointer"},i.style||{}),className:i.className?i.className+" pigeon-click-block":"pigeon-click-block",onClick:i.onClick?function(w){return i.onClick(x(w))}:null,onContextMenu:i.onContextMenu?function(w){return i.onContextMenu(x(w))}:null,onMouseOver:function(b){i.onMouseOver&&i.onMouseOver(x(b)),f(!0)},onMouseOut:function(b){i.onMouseOut&&i.onMouseOut(x(b)),f(!1)}},i.children||D.createElement("svg",{width:l,height:c,viewBox:"0 0 61 71",fill:"none",xmlns:"http://www.w3.org/2000/svg"},D.createElement("g",{style:{pointerEvents:"auto"}},D.createElement("path",{d:"M52 31.5C52 36.8395 49.18 42.314 45.0107 47.6094C40.8672 52.872 35.619 57.678 31.1763 61.6922C30.7916 62.0398 30.2084 62.0398 29.8237 61.6922C25.381 57.678 20.1328 52.872 15.9893 47.6094C11.82 42.314 9 36.8395 9 31.5C9 18.5709 18.6801 9 30.5 9C42.3199 9 52 18.5709 52 31.5Z",fill:M,stroke:"white",strokeWidth:"4"}),D.createElement("circle",{cx:"30.5",cy:"30.5",r:"8.5",fill:"white",opacity:v?.98:.6}))))}function _t(i){return D.createElement("div",{style:B({position:"absolute",transform:"translate("+i.left+"px, "+i.top+"px)"},i.style||{}),className:i.className?i.className+" pigeon-click-block":"pigeon-click-block"},i.children)}var _e={position:"absolute",top:10,left:10},oe={width:28,height:28,borderRadius:2,boxShadow:"0 1px 4px -1px rgba(0,0,0,.3)",background:"white",lineHeight:"26px",fontSize:"20px",fontWeight:700,color:"#666",marginBottom:1,cursor:"pointer",border:"none",display:"block",outline:"none"};function jt(i){var l=i.style,c=i.buttonStyle,m=i.setCenterZoom,o=i.mapState,f=i.mapProps;return D.createElement("div",{className:"pigeon-zoom-buttons pigeon-drag-block",style:l?B(B({},_e),l):_e},D.createElement("button",{className:"pigeon-zoom-in",type:"button",style:c?B(B({},oe),c):oe,onClick:function(){return m(o.center,Math.min(o.zoom+1,f.maxZoom))}},"+"),D.createElement("button",{className:"pigeon-zoom-out",type:"button",style:c?B(B({},oe),c):oe,onClick:function(){return m(o.center,Math.max(o.zoom-1,f.minZoom))}},"–"))}var St=function(l,c){return c===void 0&&(c="streets"),function(m,o,f,v){return v===void 0&&(v=1),"https://api.maptiler.com/maps/"+c+"/256/"+f+"/"+m+"/"+o+(v>=2?"@2x":"")+".png?key="+l}};const bt=({ctrl_id:i})=>{const{isLoading:l,isError:c,isSuccess:m,data:o}=Ye({ctrl_id:i},{refetchOnMountOrArgChange:!0}),{isLoading:f,isError:v,isSuccess:M,data:x}=He({ctrl_id:i},{refetchOnMountOrArgChange:!0}),{isLoading:w,isError:b,isSuccess:j,data:e}=Xe({ctrl_id:i}),{isLoading:n,isError:r,isSuccess:a,data:s}=Ge({ctrl_id:i});return t.jsx(t.Fragment,{children:t.jsx(Ue,{sx:{width:"100%",height:"100%"},children:t.jsxs(Z,{spacing:1,sx:{width:"100%"},children:[t.jsxs(te,{children:[t.jsx(re,{sx:{p:1},title:t.jsx(E,{component:"div",variant:"subtitle1",children:"Controlador"})}),t.jsx(W,{}),t.jsxs(ne,{children:[l&&t.jsx(X,{children:"Cargando datos del controlador."}),m&&o&&t.jsx(t.Fragment,{children:t.jsxs(L,{container:!0,rowSpacing:1,columnSpacing:1,children:[t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Nodo :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.nodo,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Region :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.region,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Dirección :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.direccion,20,!0)})]})}),t.jsx(L,{size:{xs:12},children:t.jsx(W,{})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Descripción :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.descripcion,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Latitud :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.latitud,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Longitud :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.longitud,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsx(W,{})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Serie :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.serie,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Ip :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.ip,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Personal Gestion :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.personalgestion,20,!0)})]})}),t.jsx(L,{size:{xs:12},children:t.jsx(W,{})}),t.jsx(L,{size:{xs:8},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Personal Implementador :"}),t.jsx(E,{component:"p",variant:"body2",children:I(o.personalimplementador,20,!0)})]})}),t.jsx(L,{size:{xs:4},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Conectado :"}),t.jsx(E,{component:"p",variant:"body2",children:o.conectado==1?"Si":"No"})]})})]})}),c&&t.jsx(G,{children:"Error al cargar datos del controlador."})]})]}),t.jsxs(te,{children:[t.jsx(re,{sx:{p:1},title:t.jsx(E,{component:"div",variant:"subtitle1",children:"Camaras"})}),t.jsx(W,{}),t.jsxs(ne,{children:[f&&t.jsx(X,{children:"Cargando camaras."}),M&&x&&t.jsx(t.Fragment,{children:t.jsx(tt,{component:nt,children:t.jsxs(it,{"aria-label":"simple table",size:"small",children:[t.jsx(rt,{children:t.jsxs(pe,{children:[t.jsx(F,{children:"N°"}),t.jsx(F,{children:"Tipo"}),t.jsx(F,{children:"Marca"}),t.jsx(F,{children:"Ip"}),t.jsx(F,{children:"Descripción"})]})}),t.jsx(at,{children:x.map((h,p)=>{const{cmr_id:g,tipo:S,marca:_,descripcion:C,ip:T}=h;return t.jsxs(pe,{children:[t.jsx(F,{children:p+1}),t.jsx(F,{children:S}),t.jsx(F,{children:_}),t.jsx(F,{children:T}),t.jsx(F,{children:C})]},g)})})]})})}),v&&t.jsx(G,{children:"Error al cargar camaras."})]})]}),t.jsxs(te,{children:[t.jsx(re,{sx:{p:1},title:t.jsx(E,{component:"div",variant:"subtitle1",children:"Equipos Entrada"})}),t.jsx(W,{}),t.jsxs(ne,{children:[w&&t.jsx(X,{children:"Cargando equipos de entrada."}),j&&e&&t.jsx(t.Fragment,{children:t.jsx(me,{disablePadding:!0,children:e.map(h=>{const{ee_id:p,detector:g}=h;return t.jsx(Et,{ctrl_id:i,ee_id:p,title:g},p)})})}),b&&t.jsx(G,{children:"Error al cargar equipos de entrada."})]})]}),t.jsxs(te,{children:[t.jsx(re,{sx:{p:1},title:t.jsx(E,{component:"div",variant:"subtitle1",children:"Equipos Salida"})}),t.jsx(W,{}),t.jsxs(ne,{children:[n&&t.jsx(X,{children:"Cargando equipos de salida."}),a&&s&&t.jsx(t.Fragment,{children:t.jsx(me,{disablePadding:!0,children:s.map(h=>{const{es_id:p,actuador:g}=h;return t.jsx(Ct,{ctrl_id:i,es_id:p,title:g},p)})})}),r&&t.jsx(G,{children:"Error al cargar equipos de entrada."})]})]})]})})})},Et=({ctrl_id:i,ee_id:l,title:c})=>{const{isLoading:m,isError:o,isSuccess:f,data:v}=$e({ctrl_id:i,ee_id:l}),[M,x]=k.useState(!1),w=()=>{x(!M)};return t.jsxs(t.Fragment,{children:[t.jsxs(Se,{onClick:w,divider:!0,children:[t.jsx(be,{primary:c}),M?t.jsx(Ce,{}):t.jsx(ye,{})]}),t.jsxs(Ee,{in:M,timeout:"auto",unmountOnExit:!0,sx:{px:2,py:1},children:[m&&t.jsx(X,{children:"Cargando equipo de entrada."}),o&&t.jsx(G,{children:"Error al cargar equipo de entrada. "}),f&&t.jsx(t.Fragment,{children:t.jsx(L,{container:!0,rowSpacing:1,columnSpacing:1,children:v.map((b,j,e)=>{const{pin:n,descripcion:r,estado:a}=b;return t.jsxs(D.Fragment,{children:[t.jsx(L,{size:{xs:3},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Pin :"}),t.jsx(E,{component:"p",variant:"body2",children:n})]})}),t.jsx(L,{size:{xs:6},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Descripción :"}),t.jsx(E,{component:"p",variant:"body2",children:r})]})}),t.jsx(L,{size:{xs:3},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Estado :"}),t.jsx(E,{component:"p",variant:"body2",children:a})]})}),j<e.length-1&&t.jsx(L,{size:{xs:12},children:t.jsx(W,{})})]},j)})})})]})]})},Ct=({ctrl_id:i,es_id:l,title:c})=>{const{isLoading:m,isError:o,isSuccess:f,data:v}=Ke({ctrl_id:i,es_id:l}),[M,x]=k.useState(!1),w=()=>{x(!M)};return t.jsxs(t.Fragment,{children:[t.jsxs(Se,{onClick:w,divider:!0,children:[t.jsx(be,{primary:c}),M?t.jsx(Ce,{}):t.jsx(ye,{})]}),t.jsxs(Ee,{in:M,timeout:"auto",unmountOnExit:!0,sx:{px:2,py:1},children:[m&&t.jsx(X,{children:"Cargando equipo de entrada."}),o&&t.jsx(G,{children:"Error al cargar equipo de entrada. "}),f&&t.jsx(t.Fragment,{children:t.jsx(L,{container:!0,rowSpacing:1,columnSpacing:1,children:v.map((b,j,e)=>{const{pin:n,descripcion:r,estado:a}=b;return t.jsxs(D.Fragment,{children:[t.jsx(L,{size:{xs:3},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Pin :"}),t.jsx(E,{component:"p",variant:"body2",children:n})]})}),t.jsx(L,{size:{xs:6},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Descripción :"}),t.jsx(E,{component:"p",variant:"body2",children:r})]})}),t.jsx(L,{size:{xs:3},children:t.jsxs(Z,{spacing:.5,children:[t.jsx(E,{component:"p",variant:"body1",children:"Estado :"}),t.jsx(E,{component:"p",variant:"body2",children:a})]})}),j<e.length-1&&t.jsx(L,{size:{xs:12},children:t.jsx(W,{})})]},j)})})})]})]})},yt=St("6iT4zBnrk40sLvf5PKC6","streets"),Tt=({locationsData:i})=>{const[l,c]=k.useState(!1),[m,o]=k.useState(null),[f,v]=k.useState(!1),[M,x]=k.useState(null),[w,b]=k.useState({center:[-9.5717863,-75.3154928],zoom:6,provider:yt,metaWheelZoom:!1,twoFingerDrag:!1,animate:!0,zoomSnap:!1,mouseEvents:!0,touchEvents:!0,minZoom:1,maxZoom:18}),{center:j,zoom:e,provider:n,animate:r,metaWheelZoom:a,twoFingerDrag:s,zoomSnap:h,mouseEvents:p,touchEvents:g,minZoom:S,maxZoom:_}=w,C=({center:P,zoom:N})=>{b(se=>({...se,zoom:N,center:P}))},T=P=>{x(P),v(!0)},y=P=>{c(!0),o(P)},O=()=>{c(!1),o(null)},z=k.useRef(null);return t.jsxs(t.Fragment,{children:[t.jsx(ie,{sx:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},component:"div",id:"map_drawer_container",ref:z,children:t.jsx(ie,{sx:{position:"absolute",width:"100%",height:"100%",overflow:"hidden"},children:t.jsxs(De,{limitBounds:"edge",center:j,zoom:e,provider:n,onBoundsChanged:C,metaWheelZoom:a,twoFingerDrag:s,zoomSnap:h,animate:r,mouseEvents:p,touchEvents:g,minZoom:S,maxZoom:_,children:[t.jsx(jt,{}),i.map((P,N)=>t.jsx(Mt,{width:50,anchor:[Number(P.latitud),Number(P.longitud)],onClick:()=>T(P),onMouseOver:()=>y(P),onMouseOut:O},N)),l&&m&&t.jsx(_t,{anchor:[Number(m.latitud),Number(m.longitud)],style:{},children:t.jsxs(te,{children:[t.jsx(re,{sx:{py:.5,px:1},title:t.jsxs(E,{component:"div",variant:"subtitle1",children:["Nodo: ",m.nodo]})}),t.jsx(W,{}),t.jsx(ne,{children:t.jsxs(Z,{spacing:.5,children:[t.jsxs("p",{children:["Region: ",m.region]}),t.jsx(W,{}),t.jsxs("p",{children:["Direccion: ",m.direccion]})]})})]})})]})})}),z.current&&t.jsx(Lt,{open:f&&M!==null,handleCloseDrawer:()=>v(!1),containerRef:z,children:t.jsxs(ie,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[t.jsxs(Z,{direction:"row",px:1,py:.5,alignItems:"center",justifyContent:"space-between",children:[t.jsx(E,{variant:"h5",children:"Detalles"}),t.jsx(Je,{"aria-label":"close",onClick:()=>v(!1),children:t.jsx(lt,{})})]}),t.jsx(ie,{sx:{flex:1,padding:1,overflow:"hidden"},children:M!==null&&t.jsx(bt,{ctrl_id:M.ctrl_id})})]})})]})},Dt=Qe(Ve)(({theme:i})=>({"& .MuiPaper-root":{transition:"all 700ms linear"},"& .MuiDrawer-paper":{[i.breakpoints.down("sm")]:{width:300},[i.breakpoints.up("sm")]:{width:600}},"& .MuiDrawer-modal":{}})),Lt=({open:i,handleCloseDrawer:l,containerRef:c,children:m})=>t.jsx(t.Fragment,{children:t.jsx(Dt,{open:i,onClose:l,elevation:5,anchor:"right",PaperProps:{style:{position:"absolute"}},ModalProps:{container:c.current,style:{position:"absolute"}},SlideProps:{direction:"left",timeout:{enter:0,exit:300}},children:m})});function je(i,l){return i.reduce((m,o)=>{const f=m,v=o[l];return f[v]=f[v]??[],f[v].push(o),f},{})}const qt=()=>{const[i,l]=k.useState("All"),c=w=>{l(w.target.value)},{isError:m,isSuccess:o,isLoading:f,data:v}=et(),M=k.useMemo(()=>{if(!v)return[];if(i==="All")return v;const w=je(v,"rgn_id");return w[Number(i)]?w[Number(i)]:[]},[v,i]),x=k.useMemo(()=>v===void 0?[]:je(v,"rgn_id"),[v]);return t.jsx(t.Fragment,{children:t.jsxs(ie,{sx:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:[t.jsx(ot,{size:"small",color:"primary",sx:{minWidth:160,position:"absolute",top:15,left:60,zIndex:10,"& .MuiInputLabel-formControl":{color:"#666666"},"& .MuiFormControlLabel-root":{color:"#666666",border:"1px solid red"}},children:t.jsxs(st,{id:"demo-simple-select",name:"demo-simple-select",value:i,onChange:c,sx:{"& .MuiSelect-select":{color:"#666666",backgroundColor:"#fff"},"& .MuiSelect-outlined":{},"& .MuiSelect-icon":{color:"#666666"}},children:[t.jsx(ve,{value:"All",children:"All"},"default_all_key"),o&&Object.keys(x).map(w=>{const j=x[Number(w)][0];return t.jsx(ve,{value:w,children:j.region},w)})]})}),m&&t.jsx(G,{}),f&&t.jsx(X,{}),o&&t.jsx(Tt,{locationsData:M})]})})};export{qt as SmartMapPage,qt as default};
