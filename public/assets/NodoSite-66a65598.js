import{a as oe,g as ie,s as M,r as u,b as Me,j as e,e as ae,h as le,o as F,b3 as ct,c as V,b4 as ce,b5 as Re,u as dt,b6 as C,b7 as Pe,b8 as ut,n as de,b9 as Ie,aP as ue,B as b,a0 as R,a1 as k,K as T,k as E,v as z,al as Z,am as re,aD as mt,as as Le,at as K,S as me,I as L,ba as pt,bb as J,bc as Fe,aZ as $e,Q as ee,U as te,bd as B,be as O,bf as ht,bg as xt,D as w,p as gt,W,G as j,F as pe,bh as ft,bi as jt,N as Se,bj as Oe,t as bt,x as Ct,y as vt,z as _t,C as St,E as yt,b2 as wt,bk as Tt,bl as ye,bm as kt,bn as we,bo as Dt,bp as Mt}from"./index-82986cbd.js";import{C as X}from"./CardHeader-87565142.js";import{D as Rt,M as A}from"./MenuItem-321b6a5e.js";import{A as $}from"./Alert-d7cc38f1.js";import{P as Pt,u as se,c as he,d as It,e as U,f as Te,g as Lt,r as Ae,C as Ft,h as Ee,i as $t,s as ze,j as Ye,k as a,l as Ve,m as Ot,n as At,D as Et,a as zt,b as Yt}from"./useMobilePicker-85a269f8.js";import{P as Vt,a as N,r as Ht,b as ke,c as Ut,d as ne}from"./date-time-utils-72093555.js";import{T as He,S as Nt}from"./StreamPlayer-d9e9d781.js";import{v as Ue}from"./validateTime-20a0d11f.js";import{D as Ne}from"./DatePicker-d2bcfb0b.js";import{T as Be,t as Ge}from"./Tooltip-def2cde8.js";import{d as Bt,a as Gt}from"./LastPage-8ef23493.js";import{d as qt,a as Wt,g as qe}from"./getFormattedDateTime-f28f8120.js";import{S as We}from"./ServerError-aac70d3e.js";import{b as Qe,a as Ze,f as Ke,c as xe,d as Y,T as v,e as ge}from"./PaperTable-580deb38.js";import{d as Qt}from"./DownloadRounded-583dc7bb.js";import{_ as Zt}from"./react-apexcharts.min-255737c1.js";import{D as Kt}from"./DialogTitle-73a74144.js";import{L as Xt}from"./LimitedTextDisplay-ef970130.js";import{M as Jt}from"./Link-16ff552d.js";import"./InputAdornment-c988aa7a.js";function es(t){return oe("MuiCardActions",t)}ie("MuiCardActions",["root","spacing"]);const ts=t=>{const{classes:s,disableSpacing:o}=t;return le({root:["root",!o&&"spacing"]},es,s)},ss=M("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,!o.disableSpacing&&s.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),rs=u.forwardRef(function(s,o){const r=Me({props:s,name:"MuiCardActions"}),{disableSpacing:i=!1,className:n,...c}=r,p={...r,disableSpacing:i},d=ts(p);return e.jsx(ss,{className:ae(d.root,n),ownerState:p,ref:o,...c})}),Xe=rs;function ns(t){return oe("MuiDialogContentText",t)}ie("MuiDialogContentText",["root"]);const os=t=>{const{classes:s}=t,r=le({root:["root"]},ns,s);return{...s,...r}},is=M(F,{shouldForwardProp:t=>ct(t)||t==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(t,s)=>s.root})({}),as=u.forwardRef(function(s,o){const r=Me({props:s,name:"MuiDialogContentText"}),{children:i,className:n,...c}=r,p=os(c);return e.jsx(is,{component:"p",variant:"body1",color:"textSecondary",ref:o,ownerState:c,className:ae(p.root,n),...r,classes:p})}),ls=as,cs=V([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),ds=V(e.jsx("path",{d:"M16.59 9H15V4c0-.55-.45-1-1-1h-4c-.55 0-1 .45-1 1v5H7.41c-.89 0-1.34 1.08-.71 1.71l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.63-.63.19-1.71-.7-1.71M5 19c0 .55.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1"}),"DownloadRounded"),us=V(e.jsx("path",{d:"m15.96 10.29-2.75 3.54-1.96-2.36L8.5 15h11zM3 5H1v16c0 1.1.9 2 2 2h16v-2H3zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2m0 16H7V3h14z"}),"Filter"),ms=V(e.jsx("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2"}),"Timeline"),ps=V(e.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8 12.5v-9l6 4.5z"}),"VideoLibrary"),hs=V(e.jsx("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11z"}),"Videocam"),xs=({state:t})=>e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M24 12C24 15.1826 22.7357 18.2349 20.4853 20.4853C18.2348 22.7357 15.1826 24 12 24C8.8174 24 5.76515 22.7357 3.51472 20.4853C1.26428 18.2349 0 15.1826 0 12C0 8.81743 1.26428 5.76518 3.51472 3.51475C5.76515 1.26431 8.8174 3.05176e-05 12 3.05176e-05C15.1826 3.05176e-05 18.2348 1.26431 20.4853 3.51475C22.7357 5.76518 24 8.81743 24 12Z",fill:"url(#paint0_linear_493_3)"}),e.jsx("path",{d:"M22.5391 12C22.5391 14.7952 21.4287 17.4758 19.4522 19.4523C17.4758 21.4288 14.7951 22.5391 11.9999 22.5391C9.20479 22.5391 6.52412 21.4288 4.54765 19.4523C2.57118 17.4758 1.46082 14.7952 1.46082 12C1.46082 9.20485 2.57118 6.52419 4.54765 4.54771C6.52412 2.57124 9.20479 1.46088 11.9999 1.46088C14.7951 1.46088 17.4758 2.57124 19.4522 4.54771C21.4287 6.52419 22.5391 9.20485 22.5391 12Z",fill:"url(#paint1_linear_493_3)"}),e.jsx("path",{d:"M22.226 12C22.226 14.7121 21.1486 17.3132 19.2309 19.2309C17.3131 21.1487 14.7121 22.2261 11.9999 22.2261C9.28782 22.2261 6.68678 21.1487 4.76901 19.2309C2.85125 17.3132 1.77386 14.7121 1.77386 12C1.77386 9.28787 2.85125 6.68682 4.76901 4.76906C6.68678 2.8513 9.28782 1.77391 11.9999 1.77391C14.7121 1.77391 17.3131 2.8513 19.2309 4.76906C21.1486 6.68682 22.226 9.28787 22.226 12Z",fill:t==="warning"?"#F00000":t==="active"?"#26CF12":"#767E75"}),e.jsx("path",{d:"M19.9826 8.76521C19.3816 11.9488 15.6599 13.0962 11.8956 13.6174C8.1246 14.1395 3.7497 13.7075 2.90117 10.0453C2.05448 6.39108 6.35515 1.77391 12 1.77391C17.6448 1.77391 20.5817 5.59149 19.9826 8.76521Z",fill:"url(#paint2_linear_493_3)"}),e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"paint0_linear_493_3",x1:"19.3044",y1:"21.287",x2:"4.38262",y2:"3.02612",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#101010"}),e.jsx("stop",{offset:"1",stopColor:"#404040"})]}),e.jsxs("linearGradient",{id:"paint1_linear_493_3",x1:"5.467",y1:"3.89601",x2:"18.3583",y2:"20.3789",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#101010"}),e.jsx("stop",{offset:"1",stopColor:"#404040"})]}),e.jsxs("linearGradient",{id:"paint2_linear_493_3",x1:"8.97387",y1:"2.45217",x2:"11.4112",y2:"13.3565",gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"white"}),e.jsx("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]})]})]});function gs(t){return oe("MuiTimePickerToolbar",t)}const G=ie("MuiTimePickerToolbar",["root","separator","hourMinuteLabel","hourMinuteLabelLandscape","hourMinuteLabelReverse","ampmSelection","ampmLandscape","ampmLabel"]),fs=["ampm","ampmInClock","value","isLandscape","onChange","view","onViewChange","views","disabled","readOnly","className"],js=t=>{const{isLandscape:s,classes:o,isRtl:r}=t;return le({root:["root"],separator:["separator"],hourMinuteLabel:["hourMinuteLabel",s&&"hourMinuteLabelLandscape",r&&"hourMinuteLabelReverse"],ampmSelection:["ampmSelection",s&&"ampmLandscape"],ampmLabel:["ampmLabel"]},gs,o)},bs=M(Pt,{name:"MuiTimePickerToolbar",slot:"Root",overridesResolver:(t,s)=>s.root})({}),Cs=M(Vt,{name:"MuiTimePickerToolbar",slot:"Separator",overridesResolver:(t,s)=>s.separator})({outline:0,margin:"0 4px 0 2px",cursor:"default"}),vs=M("div",{name:"MuiTimePickerToolbar",slot:"HourMinuteLabel",overridesResolver:(t,s)=>[{[`&.${G.hourMinuteLabelLandscape}`]:s.hourMinuteLabelLandscape,[`&.${G.hourMinuteLabelReverse}`]:s.hourMinuteLabelReverse},s.hourMinuteLabel]})({display:"flex",justifyContent:"flex-end",alignItems:"flex-end",variants:[{props:{isRtl:!0},style:{flexDirection:"row-reverse"}},{props:{isLandscape:!0},style:{marginTop:"auto"}}]}),_s=M("div",{name:"MuiTimePickerToolbar",slot:"AmPmSelection",overridesResolver:(t,s)=>[{[`.${G.ampmLabel}`]:s.ampmLabel},{[`&.${G.ampmLandscape}`]:s.ampmLandscape},s.ampmSelection]})({display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:12,[`& .${G.ampmLabel}`]:{fontSize:17},variants:[{props:{isLandscape:!0},style:{margin:"4px 0 auto",flexDirection:"row",justifyContent:"space-around",flexBasis:"100%"}}]});function Ss(t){const s=ce({props:t,name:"MuiTimePickerToolbar"}),{ampm:o,ampmInClock:r,value:i,isLandscape:n,onChange:c,view:p,onViewChange:d,views:l,disabled:m,readOnly:h,className:g}=s,x=Re(s,fs),f=se(),_=he(),S=dt(),D=!!(o&&!r&&l.includes("hours")),{meridiemMode:y,handleMeridiemChange:H}=It(i,o,c),Q=_e=>o?f.format(_e,"hours12h"):f.format(_e,"hours24h"),I=C({},s,{isRtl:S}),P=js(I),ve=e.jsx(Cs,{tabIndex:-1,value:":",variant:"h3",selected:!1,className:P.separator});return e.jsxs(bs,C({landscapeDirection:"row",toolbarTitle:_.timePickerToolbarTitle,isLandscape:n,ownerState:I,className:ae(P.root,g)},x,{children:[e.jsxs(vs,{className:P.hourMinuteLabel,ownerState:I,children:[U(l,"hours")&&e.jsx(N,{tabIndex:-1,variant:"h3",onClick:()=>d("hours"),selected:p==="hours",value:i?Q(i):"--"}),U(l,["hours","minutes"])&&ve,U(l,"minutes")&&e.jsx(N,{tabIndex:-1,variant:"h3",onClick:()=>d("minutes"),selected:p==="minutes",value:i?f.format(i,"minutes"):"--"}),U(l,["minutes","seconds"])&&ve,U(l,"seconds")&&e.jsx(N,{variant:"h3",onClick:()=>d("seconds"),selected:p==="seconds",value:i?f.format(i,"seconds"):"--"})]}),D&&e.jsxs(_s,{className:P.ampmSelection,ownerState:I,children:[e.jsx(N,{disableRipple:!0,variant:"subtitle2",selected:y==="am",typographyClassName:P.ampmLabel,value:Te(f,"am"),onClick:h?void 0:()=>H("am"),disabled:m}),e.jsx(N,{disableRipple:!0,variant:"subtitle2",selected:y==="pm",typographyClassName:P.ampmLabel,value:Te(f,"pm"),onClick:h?void 0:()=>H("pm"),disabled:m})]})]}))}function Je(t,s){var c;const o=se(),r=ce({props:t,name:s}),i=r.ampm??o.is12HourCycleInCurrentLocale(),n=u.useMemo(()=>{var p;return((p=r.localeText)==null?void 0:p.toolbarTitle)==null?r.localeText:C({},r.localeText,{timePickerToolbarTitle:r.localeText.toolbarTitle})},[r.localeText]);return C({},r,{ampm:i,localeText:n},Lt({views:r.views,openTo:r.openTo,defaultViews:["hours","minutes"],defaultOpenTo:"hours"}),{disableFuture:r.disableFuture??!1,disablePast:r.disablePast??!1,slots:C({toolbar:Ss},r.slots),slotProps:C({},r.slotProps,{toolbar:C({ampm:i,ampmInClock:r.ampmInClock},(c=r.slotProps)==null?void 0:c.toolbar)})})}const et=u.forwardRef(function(s,o){var D,y,H,Q;const r=he(),i=se(),n=Je(s,"MuiDesktopTimePicker"),{shouldRenderTimeInASingleColumn:c,views:p,timeSteps:d}=Ht(n),l=c?Ut:ke,m=C({hours:l,minutes:l,seconds:l,meridiem:l},n.viewRenderers),h=n.ampmInClock??!0,g=c?[]:["accept"],f=((D=m.hours)==null?void 0:D.name)===ke.name?p:p.filter(I=>I!=="meridiem"),_=C({},n,{ampmInClock:h,timeSteps:d,viewRenderers:m,format:Ae(i,n),views:c?["hours"]:f,slots:C({field:He,openPickerIcon:Ft},n.slots),slotProps:C({},n.slotProps,{field:I=>{var P;return C({},Pe((P=n.slotProps)==null?void 0:P.field,I),Ee(n),{ref:o})},toolbar:C({hidden:!0,ampmInClock:h},(y=n.slotProps)==null?void 0:y.toolbar),actionBar:C({actions:g},(H=n.slotProps)==null?void 0:H.actionBar)})}),{renderPicker:S}=$t({props:_,valueManager:ze,valueType:"time",getOpenDialogAriaText:Ye({utils:i,formatKey:"fullTime",contextTranslation:r.openTimePickerDialogue,propsTranslation:(Q=_.localeText)==null?void 0:Q.openTimePickerDialogue}),validator:Ue});return S()});et.propTypes={ampm:a.bool,ampmInClock:a.bool,autoFocus:a.bool,className:a.string,closeOnSelect:a.bool,defaultValue:a.object,disabled:a.bool,disableFuture:a.bool,disableIgnoringDatePartForTimeValidation:a.bool,disableOpenPicker:a.bool,disablePast:a.bool,enableAccessibleFieldDOMStructure:a.any,format:a.string,formatDensity:a.oneOf(["dense","spacious"]),inputRef:Ve,label:a.node,localeText:a.object,maxTime:a.object,minTime:a.object,minutesStep:a.number,name:a.string,onAccept:a.func,onChange:a.func,onClose:a.func,onError:a.func,onOpen:a.func,onSelectedSectionsChange:a.func,onViewChange:a.func,open:a.bool,openTo:a.oneOf(["hours","meridiem","minutes","seconds"]),orientation:a.oneOf(["landscape","portrait"]),readOnly:a.bool,reduceAnimations:a.bool,referenceDate:a.object,selectedSections:a.oneOfType([a.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),a.number]),shouldDisableTime:a.func,skipDisabled:a.bool,slotProps:a.object,slots:a.object,sx:a.oneOfType([a.arrayOf(a.oneOfType([a.func,a.object,a.bool])),a.func,a.object]),thresholdToRenderTimeInASingleColumn:a.number,timeSteps:a.shape({hours:a.number,minutes:a.number,seconds:a.number}),timezone:a.string,value:a.object,view:a.oneOf(["hours","meridiem","minutes","seconds"]),viewRenderers:a.shape({hours:a.func,meridiem:a.func,minutes:a.func,seconds:a.func}),views:a.arrayOf(a.oneOf(["hours","minutes","seconds"]).isRequired)};const tt=u.forwardRef(function(s,o){var m,h;const r=he(),i=se(),n=Je(s,"MuiMobileTimePicker"),c=C({hours:ne,minutes:ne,seconds:ne},n.viewRenderers),p=n.ampmInClock??!1,d=C({},n,{ampmInClock:p,viewRenderers:c,format:Ae(i,n),slots:C({field:He},n.slots),slotProps:C({},n.slotProps,{field:g=>{var x;return C({},Pe((x=n.slotProps)==null?void 0:x.field,g),Ee(n),{ref:o})},toolbar:C({hidden:!1,ampmInClock:p},(m=n.slotProps)==null?void 0:m.toolbar)})}),{renderPicker:l}=Ot({props:d,valueManager:ze,valueType:"time",getOpenDialogAriaText:Ye({utils:i,formatKey:"fullTime",contextTranslation:r.openTimePickerDialogue,propsTranslation:(h=d.localeText)==null?void 0:h.openTimePickerDialogue}),validator:Ue});return l()});tt.propTypes={ampm:a.bool,ampmInClock:a.bool,autoFocus:a.bool,className:a.string,closeOnSelect:a.bool,defaultValue:a.object,disabled:a.bool,disableFuture:a.bool,disableIgnoringDatePartForTimeValidation:a.bool,disableOpenPicker:a.bool,disablePast:a.bool,enableAccessibleFieldDOMStructure:a.any,format:a.string,formatDensity:a.oneOf(["dense","spacious"]),inputRef:Ve,label:a.node,localeText:a.object,maxTime:a.object,minTime:a.object,minutesStep:a.number,name:a.string,onAccept:a.func,onChange:a.func,onClose:a.func,onError:a.func,onOpen:a.func,onSelectedSectionsChange:a.func,onViewChange:a.func,open:a.bool,openTo:a.oneOf(["hours","minutes","seconds"]),orientation:a.oneOf(["landscape","portrait"]),readOnly:a.bool,reduceAnimations:a.bool,referenceDate:a.object,selectedSections:a.oneOfType([a.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),a.number]),shouldDisableTime:a.func,slotProps:a.object,slots:a.object,sx:a.oneOfType([a.arrayOf(a.oneOfType([a.func,a.object,a.bool])),a.func,a.object]),timezone:a.string,value:a.object,view:a.oneOf(["hours","minutes","seconds"]),viewRenderers:a.shape({hours:a.func,minutes:a.func,seconds:a.func}),views:a.arrayOf(a.oneOf(["hours","minutes","seconds"]).isRequired)};const ys=["desktopModeMediaQuery"],ws=u.forwardRef(function(s,o){const r=ce({props:s,name:"MuiTimePicker"}),{desktopModeMediaQuery:i=At}=r,n=Re(r,ys);return ut(i,{defaultMatches:!0})?e.jsx(et,C({ref:o},n)):e.jsx(tt,C({ref:o},n))}),De={p:.5,"& .MuiCardHeader-action":{m:"auto auto",display:"flex"}},q=u.forwardRef(({border:t=!0,boxShadow:s,children:o,content:r=!0,contentSX:i={},darkTitle:n,elevation:c,secondary:p,shadow:d,sx:l={},title:m,isDivider:h=!1,codeHighlight:g,cardActions:x,...f},_)=>{const S=de();return s=S.palette.mode==="dark"?s||!0:s,e.jsxs(Ie,{elevation:c||0,ref:_,...f,sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%",border:t?"1px solid":"none",borderRadius:2,borderColor:S.palette.mode==="dark"?S.palette.divider:S.palette.grey.A800,boxShadow:s&&(!t||S.palette.mode==="dark")?d||S.shadows[10]:"inherit",":hover":{boxShadow:s?d||S.shadows[10]:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:S.typography.fontFamily,fontSize:"0.75rem"},...l},children:[p&&!m&&e.jsx(X,{sx:De,action:p}),m&&e.jsx(X,{sx:De,title:e.jsx(F,{variant:"h5",children:m}),action:p}),h&&e.jsx(Rt,{}),r&&e.jsx(ue,{sx:{flex:1,padding:.5,...i,"&:last-child":{paddingBottom:.5}},children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"absolute"},children:o})})}),x&&e.jsx(Xe,{disableSpacing:!0,sx:{padding:.5},children:x})]})}),Ts=({ctrl_id:t})=>{const[s,o]=u.useState(null),r=u.useRef(null);return u.useEffect(()=>(r.current||(r.current=R(`${k}/last_snapshot/${t}`)),r.current.on("last_snapshot",i=>{o(i)}),()=>{r.current&&(r.current.disconnect(),r.current=null)}),[t]),e.jsx(e.Fragment,{children:e.jsxs(q,{title:"Ultima Foto",children:[s!==null&&e.jsx(b,{component:"img",sx:{height:"100%",width:"100%",overflow:"hidden",borderRadius:"4px"},src:s}),s===null&&e.jsx(b,{component:"div",sx:{width:"100%",height:"100%",display:"grid",placeItems:"center"},children:e.jsx($,{severity:"info",variant:"outlined",children:"Caputura no disponible"})})]})})},ks=({timePicked:t,datePicked:s,setDatePicked:o,setTimePicked:r})=>e.jsxs(T,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Ne,{value:s,onChange:i=>o(i),slotProps:{textField:{size:"small",sx:{maxWidth:150,"& .MuiOutlinedInput-root":{"& fieldset":{}}}}}}),e.jsx(ws,{views:["hours"],ampm:!1,defaultValue:t,onChange:i=>r(i),slotProps:{textField:{size:"small",sx:{maxWidth:85,"& .MuiOutlinedInput-root":{"& fieldset":{}}}},digitalClockSectionItem:{}}})]}),Ds=M(({className:t,...s})=>e.jsx(Be,{...s,classes:{popper:t}}))(({theme:t})=>({[`& .${Ge.tooltip}`]:{backgroundColor:t.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:t.shadows[1],fontSize:11}})),Ms=({camaras:t,ctrl_id:s})=>{const o=E(d=>d.stream),r=E(d=>d.controllerSiteState),[i,n]=u.useState(null),c=z(),p=(d,l)=>{if(l!==null&&r.controller!==void 0){const m=t.find(h=>h.ip===l);n(l),m&&c(Z({ctrl_id:s,cmr_id:m.cmr_id,tc_id:m.tc_id,descripcion:m.descripcion}))}};return u.useEffect(()=>{if(t.length>0&&r.controller!==void 0){const d=o.cmr_id;if(d!==null){const l=t.find(m=>m.cmr_id===d);l?(n(l.ip),c(Z({ctrl_id:s,cmr_id:l.cmr_id,tc_id:l.tc_id,descripcion:l.descripcion})),c(re({isSelected:!0}))):(n(t[0].ip),c(Z({ctrl_id:s,cmr_id:t[0].cmr_id,tc_id:t[0].tc_id,descripcion:t[0].descripcion})),c(re({isSelected:!0})))}else n(t[0].ip),c(Z({ctrl_id:s,cmr_id:t[0].cmr_id,tc_id:t[0].tc_id,descripcion:t[0].descripcion})),c(re({isSelected:!0}))}},[t]),u.useEffect(()=>()=>{c(mt())},[]),e.jsx(e.Fragment,{children:e.jsx(Le,{color:"primary",value:i,exclusive:!0,onChange:p,"aria-label":"Cameras",size:"small",children:t.map((d,l)=>e.jsx(K,{value:d.ip,"aria-label":"Camara 1",sx:{padding:0},children:e.jsx(Ds,{title:d.descripcion,arrow:!0,children:e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",padding:{lg:1,xs:.5},children:[e.jsx(cs,{}),e.jsxs("div",{children:["Cam ",l+1]})]})})},d.ip))})})},Rs=()=>{const t=E(s=>s.stream);return e.jsx(e.Fragment,{children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"relative"},children:t.cmr_id!==null&&t.ctrl_id!==null&&e.jsx(e.Fragment,{children:e.jsx(Nt,{ctrl_id:t.ctrl_id,cmr_id:t.cmr_id,q:"q1"},t.ctrl_id+t.cmr_id+"q1")})})})},st=u.forwardRef(({title:t,count:s,onChangeIndex:o,current_index:r},i)=>{const[n,c]=u.useState(1),p=g=>{c(g.target.value)},d=()=>{o(0)},l=()=>{const g=r-n<0?0:r-n;o(g)},m=()=>{const g=r+n>s-1?s-1:r+n;o(g)},h=()=>{o(s-1)};return e.jsx(b,{component:"div",sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1},ref:i,children:s>=0&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{component:"p",color:"white",sx:{userSelect:"none"},children:[t," :"]}),e.jsxs(me,{id:"control-select",name:"control-select",value:n,onChange:p,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5,borderColor:"white"}},sx:{color:"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"& .MuiSvgIcon-root":{color:"white"}},children:[e.jsx(A,{value:1,children:1}),e.jsx(A,{value:10,children:10}),e.jsx(A,{value:20,children:20}),e.jsx(A,{value:50,children:50})]}),e.jsx(F,{component:"div",color:"white",sx:{userSelect:"none"},children:`${r+1} de ${s}`}),e.jsxs(b,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(L,{onClick:d,disabled:r===0,"aria-label":"first page",children:e.jsx(Bt,{})}),e.jsx(L,{onClick:l,disabled:r===0,"aria-label":"previous page",children:e.jsx(qt,{})}),e.jsx(L,{onClick:m,disabled:r===s-1,"aria-label":"next page",children:e.jsx(Wt,{})}),e.jsx(L,{onClick:h,disabled:r===s-1,"aria-label":"last page",children:e.jsx(Gt,{})})]})]})})}),Ps=({slides:t})=>{const[s,o]=u.useState([]),[r,i]=u.useState(0),[n]=pt(),c=async()=>{if(s.length>0&&s[r])try{const m=s[r],h=`motion_capture_${m.cmr_id}_${Date.now()}.jpg`,g=await n({filePath:m.ruta}).unwrap(),x=document.createElement("a");x.href=g,x.download=h,x.style.display="none",document.body.appendChild(x),x.click(),document.body.removeChild(x)}catch(m){console.error("Ocurrio un error al descargar imagen",m)}},p=z(),d=m=>{m.currentTarget===m.target&&p(J())},l=m=>{i(m)};return u.useEffect(()=>{o(t),i(0)},[t]),e.jsx(e.Fragment,{children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsxs(b,{sx:{position:"relative",height:"100%",width:"100%"},children:[e.jsx(b,{component:"div",sx:{position:"absolute",bottom:0,left:0,width:"100%",background:"rgba(0, 0, 0, 0.3)",py:1,"&: hover":{}},children:e.jsxs(T,{spacing:1,direction:"row",alignItems:"center",justifyContent:"center",sx:{position:"relative"},onDoubleClickCapture:d,children:[e.jsx(st,{title:"N° Fotos",count:s.length,current_index:r,onChangeIndex:l}),e.jsx(L,{"aria-label":"back",sx:{position:"absolute",bottom:"cacl(50% - 23px)",left:10,cursor:"pointer"},onClick:c,children:e.jsx(ds,{sx:{color:"#FD8D14",fontSize:30}})})]})}),s.length>0&&s[r]&&e.jsx(b,{component:"img",sx:{height:"100%",overflow:"hidden",width:"100%",borderRadius:"4px",userSelect:"none"},src:`${k+"/"+s[r].ruta}`,onDoubleClickCapture:d})]})})})},Is="/assets/emptyData-e7a50cc8.svg",rt=({children:t})=>e.jsxs(T,{spacing:1,alignItems:"center",children:[e.jsx("img",{src:Is,alt:"",width:100}),e.jsx(F,{component:"p",variant:"body1",children:t&&t||"No data"})]}),Ls=({data:t})=>{const{cmr_id:s,ctrl_id:o,date:r,hour:i}=t,{isError:n,isSuccess:c,isLoading:p,data:d}=Fe({ctrl_id:o,date:r,hour:i,tipo:0,cmr_id:s}),l=z(),m=h=>{h.currentTarget===h.target&&l(J())};return e.jsxs(b,{sx:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},onDoubleClickCapture:m,children:[p&&e.jsx($e,{children:"Cargando Fotos"}),n&&e.jsx(We,{children:"Error no se encontraron imagenes!"}),c&&d.length>0&&e.jsx(Ps,{slides:d}),c&&d.length==0&&e.jsx(rt,{children:"No se encontraron fotos."})]})},Fs=({slides:t})=>{const[s,o]=u.useState([]),[r,i]=u.useState(0),n=z(),c=m=>{m.currentTarget===m.target&&n(J())},p=m=>{i(m)},d=u.useRef(null),l=u.useMemo(()=>d.current?`calc( 50% - ${d.current.getBoundingClientRect().width*.5}px )`:0,[d.current]);return u.useEffect(()=>{o(t),i(0)},[t]),e.jsx(e.Fragment,{children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsxs(b,{sx:{position:"relative",height:"100%",width:"100%"},children:[s.length>0&&s[r]&&e.jsx(b,{component:"video",sx:{height:"100%",overflow:"hidden",width:"100%",borderRadius:"4px"},controls:!0,src:`${k+"/"+s[r].ruta}`,onDoubleClickCapture:c,onClick:m=>{m.preventDefault(),m.detail==2&&m.stopPropagation()}}),e.jsx(b,{component:"div",sx:{position:"absolute",bottom:"7%",left:l},children:e.jsx(st,{ref:d,title:"N° Videos",count:s.length,current_index:r,onChangeIndex:p})})]})})})},$s=({data:t})=>{const{cmr_id:s,ctrl_id:o,date:r,hour:i}=t,{isError:n,isSuccess:c,isLoading:p,data:d}=Fe({ctrl_id:o,date:r,hour:i,tipo:1,cmr_id:s}),l=z(),m=h=>{h.currentTarget===h.target&&l(J())};return e.jsxs(b,{sx:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},onDoubleClickCapture:m,children:[p&&e.jsx($e,{children:"Cargando videos"}),n&&e.jsx(We,{children:"Error no se encontraron videos!"}),c&&d.length>0&&e.jsx(Fs,{slides:d}),c&&d.length==0&&e.jsx(rt,{children:"No se encontraron videos."})]})},Os=({option:t,handleChangeOption:s})=>e.jsxs(Le,{color:"primary",value:t,exclusive:!0,onChange:s,"aria-label":"Options",size:"small",children:[e.jsx(K,{value:"vivo","aria-label":"Vivo",children:e.jsxs(T,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(hs,{}),e.jsx("span",{children:" Vivo"})]})}),e.jsx(K,{value:"video","aria-label":"Video",children:e.jsxs(T,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ps,{}),e.jsx("span",{children:" Video"})]})}),e.jsx(K,{value:"fotos","aria-label":"Fotos",children:e.jsxs(T,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(us,{}),e.jsx("span",{children:" Fotos"})]})})]});var fe={},As=te;Object.defineProperty(fe,"__esModule",{value:!0});var nt=fe.default=void 0,Es=As(ee()),zs=e;nt=fe.default=(0,Es.default)((0,zs.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2M9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2z"}),"LockRounded");var je={},Ys=te;Object.defineProperty(je,"__esModule",{value:!0});var ot=je.default=void 0,Vs=Ys(ee()),Hs=e;ot=je.default=(0,Vs.default)((0,Hs.jsx)("path",{d:"M12 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6-5h-1V6c0-2.76-2.24-5-5-5-2.28 0-4.27 1.54-4.84 3.75-.14.54.18 1.08.72 1.22.53.14 1.08-.18 1.22-.72C9.44 3.93 10.63 3 12 3c1.65 0 3 1.35 3 3v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 11c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-8c0-.55.45-1 1-1h10c.55 0 1 .45 1 1z"}),"LockOpenRounded");const Us=t=>{const[s,o]=u.useState(null),[r,i]=u.useState(null),[n,c]=u.useState(null),p=u.useRef(null),[d,l]=u.useState(!1),[m,h]=u.useState(null),[g,x]=u.useState(void 0);return u.useEffect(()=>(t!==void 0&&(p.current||(p.current=R(`${k}/controller_state/${t}`)),p.current.on("controller_info",f=>{const{modo:_,seguridad:S,conectado:D,disableSecurityButton:y}=f;i(_),o(S),c(D),x(y)}),p.current.on("update_controller",f=>{const{conectado:_,modo:S,seguridad:D}=f;c(y=>_!==y?_:y),i(y=>S!==y?S:y),o(y=>D!==y?D:y)}),p.current.on("update_security_button",f=>{x(_=>_!==f?f:_)}),p.current.on("connect_error",f=>{l(!0),h(f.message)})),()=>{p.current&&(p.current.disconnect(),p.current=null),o(null),i(null),l(!1),h(null),c(null)}),[t]),{isError:d,error:m,socket:p,mode:r,security:s,connected:n,disableSecurity:g}},Ns=M(({className:t,...s})=>e.jsx(Be,{...s,classes:{popper:t}}))(({theme:t})=>({[`& .${Ge.tooltip}`]:{backgroundColor:t.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:t.shadows[3],fontSize:11}})),Bs=({ctrl_id:t})=>{const{mode:s,security:o,socket:r,disableSecurity:i}=Us(t),n=()=>{r.current&&(o===O.Armado?r.current.emit("setSecurity",O.Desarmado):r.current.emit("setSecurity",O.Armado))};return e.jsx(e.Fragment,{children:s===B.Seguridad&&e.jsx(Ns,{title:o===O.Armado?"Armado":"Desarmado",placement:"left",children:e.jsx("span",{children:e.jsx(L,{onClick:n,disabled:i===void 0?!0:i,children:o===O.Armado?e.jsx(nt,{}):e.jsx(ot,{})})})})})};var be={},Gs=te;Object.defineProperty(be,"__esModule",{value:!0});var it=be.default=void 0,qs=Gs(ee()),Ws=e;it=be.default=(0,qs.default)((0,Ws.jsx)("path",{d:"M8.54 8.54c.35.35.37.88.1 1.29C8.24 10.45 8 11.2 8 12s.24 1.55.64 2.17c.27.41.24.95-.11 1.29-.43.43-1.17.4-1.51-.11C6.38 14.4 6 13.24 6 12c0-1.21.36-2.33.97-3.28.36-.54 1.11-.64 1.57-.18m6.92 6.92c.43.43 1.17.4 1.51-.11C17.62 14.4 18 13.24 18 12s-.38-2.4-1.03-3.36c-.34-.5-1.08-.54-1.51-.11-.35.35-.37.88-.11 1.29.41.63.65 1.38.65 2.18s-.24 1.55-.64 2.17c-.27.41-.24.95.1 1.29M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6.32 8.32c.42.42 1.12.39 1.5-.08C21.18 16.53 22 14.36 22 12s-.82-4.53-2.18-6.24c-.37-.47-1.07-.5-1.5-.08-.36.36-.4.92-.08 1.32 1.1 1.37 1.76 3.11 1.76 5s-.66 3.63-1.76 5c-.32.39-.28.96.08 1.32M5.68 5.68c-.42-.42-1.12-.39-1.5.08C2.82 7.47 2 9.64 2 12s.82 4.53 2.18 6.24c.37.47 1.07.5 1.5.08.36-.36.4-.92.08-1.32C4.66 15.63 4 13.89 4 12s.66-3.63 1.76-5c.32-.39.28-.96-.08-1.32"}),"SensorsRounded");var Ce={},Qs=te;Object.defineProperty(Ce,"__esModule",{value:!0});var at=Ce.default=void 0,Zs=Qs(ee()),Ks=e;at=Ce.default=(0,Zs.default)((0,Ks.jsx)("path",{d:"M5.68 18.32c-.42.42-1.12.39-1.5-.08C2.82 16.53 2 14.36 2 12c0-2.04.61-3.93 1.66-5.51L2.1 4.93a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0l16.97 16.97c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0L8.14 10.96c-.09.33-.14.68-.14 1.04 0 .8.24 1.55.64 2.17.27.41.24.94-.1 1.29-.43.43-1.17.4-1.51-.11C6.38 14.4 6 13.24 6 12c0-.93.21-1.8.58-2.59L5.11 7.94C4.4 9.13 4 10.52 4 12c0 1.89.66 3.63 1.76 5 .32.39.28.96-.08 1.32m9.78-9.78c-.35.35-.37.88-.11 1.29.41.62.65 1.37.65 2.17 0 .36-.05.71-.14 1.04l1.55 1.55c.38-.79.59-1.66.59-2.59 0-1.24-.38-2.4-1.03-3.36-.34-.5-1.07-.54-1.51-.1m2.86-2.86c-.36.36-.4.92-.08 1.32 1.1 1.37 1.76 3.11 1.76 5 0 1.48-.4 2.87-1.11 4.06l1.45 1.45C21.39 15.93 22 14.04 22 12c0-2.36-.82-4.53-2.18-6.24-.38-.47-1.08-.5-1.5-.08"}),"SensorsOffRounded");const Xs=()=>{const t=E(s=>s.controllerSiteState);return e.jsx(e.Fragment,{children:e.jsx(T,{direction:"row",spacing:1,alignItems:"center",children:t.controller!==void 0&&(t.controller.conectado===ht.Conectado?e.jsxs(e.Fragment,{children:[e.jsx(it,{color:"success",fontSize:"large"}),e.jsx(F,{children:"Conectado"})]}):e.jsxs(e.Fragment,{children:[e.jsx(at,{color:"error",fontSize:"large"}),e.jsx(F,{children:"Desconectado"})]}))})})},Js=({ctrl_id:t})=>{const s=E(x=>x.stream),{isError:o,isSuccess:r,data:i}=xt({ctrl_id:t},{refetchOnMountOrArgChange:!0}),[n,c]=u.useState("vivo"),p=(x,f)=>{f!==null&&c(f)},[d,l]=u.useState(w()),[m,h]=u.useState(w()),g=u.useRef(null);return e.jsxs(gt,{children:[e.jsx(X,{ref:g,sx:{p:.5,"& .MuiCardHeader-action":{m:"auto auto",display:"flex"},overflow:"auto",margin:0},title:e.jsx(Xs,{}),action:e.jsx("div",{style:{width:"100%",height:"100%"},children:e.jsxs(T,{direction:"row",spacing:2,alignItems:"center",children:[(n==="fotos"||n==="video")&&e.jsx(ks,{timePicked:m,datePicked:d,setDatePicked:l,setTimePicked:h}),r&&i.length>0&&e.jsx(Ms,{camaras:i,ctrl_id:t}),o&&e.jsx($,{variant:"filled",severity:"error",children:"Error al cargar camaras."})]})})}),e.jsxs(ue,{sx:{flex:1,padding:.5,"&:last-child":{paddingBottom:.5}},children:[n==="vivo"&&s.ctrl_id!==null&&s.cmr_id!==null&&r&&i.length>0&&e.jsx(Rs,{},s.ctrl_id+s.cmr_id),n==="fotos"&&s.ctrl_id!==null&&s.cmr_id!==null&&e.jsx(Ls,{data:{cmr_id:s.cmr_id,ctrl_id:s.ctrl_id,date:d.format("YYYY-MM-DD"),hour:Number(m.format("HH"))}},s.ctrl_id+s.cmr_id),n==="video"&&s.ctrl_id!==null&&s.cmr_id!==null&&e.jsx($s,{data:{cmr_id:s.cmr_id,ctrl_id:s.ctrl_id,date:d.format("YYYY-MM-DD"),hour:Number(m.format("HH"))}},s.ctrl_id+s.cmr_id)]}),e.jsx(Xe,{disableSpacing:!0,sx:{padding:.5},children:e.jsxs(T,{width:"100%",direction:"row",alignItems:"center",spacing:2,justifyContent:"space-between",children:[e.jsx(Os,{option:n,handleChangeOption:p}),e.jsx(Bs,{ctrl_id:t})]})})]})},er=({ctrl_id:t})=>{const[s,o]=u.useState([]),r=u.useRef(null),i=de(),[n,c]=u.useState(B.Seguridad),[p,d]=u.useState(O.Desarmado);return u.useEffect(()=>(r.current||(r.current=R(`${k}/pin_entrada/${t}`)),r.current.on("list_pines_entrada",l=>{o(l)}),r.current.on("controller_mode",l=>{c(l)}),r.current.on("controller_security",l=>{d(l)}),r.current.on("item_pin_entrada",l=>{o(m=>{if(l.activo==1){const h=m.filter(g=>g.pe_id!=l.pe_id);return h.unshift(l),h}return m})}),()=>{r.current&&(r.current.disconnect(),r.current=null)}),[t]),e.jsx(e.Fragment,{children:e.jsxs(Ie,{sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%",border:n===B.Seguridad?"2px solid":"1px solid",borderRadius:2,backgroundImage:"inherit",borderColor:n===B.Seguridad?p===O.Armado?"green":"darkgray":i.palette.mode==="dark"?i.palette.divider:i.palette.grey.A800,boxShadow:"inherit",":hover":{boxShadow:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:i.typography.fontFamily,fontSize:"0.75rem"}},children:[e.jsx(X,{title:"Site",sx:{p:.5,"& .MuiCardHeader-action":{m:"auto auto",display:"flex"}}}),e.jsx(ue,{sx:{flex:1,padding:.5,"&:last-child":{paddingBottom:.5}},children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(b,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(W,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsxs(j,{container:!0,rowSpacing:1,columnSpacing:2,width:"100%",children:[s.length===0&&e.jsx(j,{size:{xs:12},sx:{display:"grid",placeItems:"center"},children:e.jsx($,{severity:"warning",variant:"outlined",children:"Asignar al menos un pin de entrada"})}),s.map((l,m,h)=>{const g=e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[e.jsx("div",{children:pe(l.descripcion,20)}),e.jsx(xs,{state:n===B.Seguridad?l.estado===1?"warning":"active":l.estado===1?"active":"disable"})]});return h.length==1?e.jsxs(u.Fragment,{children:[e.jsx(j,{size:{xs:3}}),e.jsx(j,{size:{xs:12},children:g}),e.jsx(j,{size:{xs:3}})]},t+l.pe_id):e.jsx(j,{size:{xs:12,lg:6},children:g},t+l.pe_id)})]})})})})})]})})},tr=M(Qe)(({theme:t})=>({border:"1px solid",borderRadius:2,borderColor:t.palette.mode==="dark"?t.palette.divider:t.palette.grey.A800,backgroundColor:t.palette.background.paper,boxShadow:" rgba(0, 0, 0, 0.2) 0px 2px 1px -1px, rgba(0, 0, 0, 0.14) 0px 1px 1px 0px, rgba(0, 0, 0, 0.12) 0px 1px 3px 0px",backgroundImage:t.palette.mode==="dark"?"linear-gradient(rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.05))":"none"})),sr=({ctrl_id:t})=>{const[s,o]=u.useState([]),r=u.useRef(null);return u.useEffect(()=>(r.current||(r.current=R(`${k}/modulo_energia/${t}`)),r.current.on("initial_list_energia",i=>{o(i)}),r.current.on("list_energia",(i,n)=>{n==="add"&&o(c=>c.some(d=>d.me_id===i.me_id)?c:[...c,i].sort((m,h)=>m.me_id-h.me_id)),n==="delete"&&o(c=>c.filter(d=>d.me_id!==i.me_id))}),()=>{r.current&&(r.current.disconnect(),r.current=null)}),[t]),e.jsx(e.Fragment,{children:e.jsxs(b,{component:"div",sx:{width:"100%",height:"100%",display:"grid",placeItems:"center"},children:[s.length===0&&e.jsx($,{severity:"warning",variant:"outlined",children:"Asignar al menos un modulo de energia"}),s.length>0&&e.jsx(Ze,{component:Ke,variant:"outlined",sx:{height:"100%",width:"100%",overflowY:"auto"},children:e.jsx(W,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsxs(tr,{"aria-label":"customized table",stickyHeader:!0,size:"small",sx:{position:"relative"},children:[e.jsx(xe,{children:e.jsxs(Y,{children:[e.jsx(v,{children:"N°"}),e.jsx(v,{children:"Amp (A)"}),e.jsx(v,{children:"Volt (V)"}),e.jsx(v,{children:"Pot (W)"}),e.jsx(v,{children:"kWh"})]})}),e.jsx(ge,{children:r.current!==null&&s.map((i,n)=>r.current!==null?e.jsx(rr,{index:n,dataEnergia:i,socket:r.current},i.me_id):null)})]})})})]})})},rr=({dataEnergia:t,index:s,socket:o})=>{const[r,i]=u.useState(t);return o.on("energia",n=>{n.me_id===t.me_id&&i(n)}),e.jsxs(Y,{children:[e.jsx(v,{component:"th",scope:"row",children:s+1}),e.jsx(v,{children:r.amperaje}),e.jsx(v,{children:r.voltaje}),e.jsx(v,{children:r.potenciaw}),e.jsx(v,{children:r.potenciakwh})]})},nr=({date:t,registerData:s,info:o})=>{const[r,i]=u.useState({configs:{chart:{height:350,type:"line",zoom:{enabled:!1},background:"#121212",id:"temperature-graph-chart",toolbar:{show:!0,export:{png:{filename:`grafica_temperatura_${encodeURIComponent(o.nodo)}_${encodeURIComponent(o.st_id)}_${encodeURIComponent(o.ubicacion)}_${encodeURIComponent(w(t,"YYYY-MM-DD").unix())}`},svg:{filename:`grafica_temperatura_${encodeURIComponent(o.nodo)}_${encodeURIComponent(o.st_id)}_${encodeURIComponent(o.ubicacion)}_${encodeURIComponent(w(t,"YYYY-MM-DD").unix())}`}}}},dataLabels:{enabled:!1},stroke:{curve:"straight"},grid:{row:{colors:["#1e1e1e","transparent"],opacity:.5}},xaxis:{type:"datetime",tickAmount:24,min:new Date(w(t,"YYYY-MM-DD").startOf("day").toISOString()).getTime(),max:new Date(w(t,"YYYY-MM-DD").add(1,"day").startOf("day").toISOString()).getTime(),labels:{formatter:function(l,m){return w(m).format("HH:mm")},style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}},title:{text:"Tiempo ( h )",style:{color:"#8c8c8c"}},tooltip:{enabled:!1,formatter:(l,m)=>w(l).format("HH:mm:ss")}},yaxis:{min:0,decimalsInFloat:2,title:{text:"Temperatura ( °C )",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!0,x:{show:!0,formatter(l,m){return w(l).format("HH:mm:ss")}},y:{}}}}),n=de(),c=n.palette.mode,[p,d]=u.useState([]);return u.useEffect(()=>{i(l=>{const m=c=="dark"?n.palette.text.secondary:n.palette.text.primary;return{configs:{...l.configs,chart:{...l.configs.chart,background:n.palette.background.default},grid:{row:{colors:[n.palette.background.paper,"transparent"],opacity:.5}},xaxis:{...l.configs.xaxis,labels:{...l.configs.xaxis?l.configs.xaxis.labels:{},style:{...l.configs.xaxis&&l.configs.xaxis.labels?l.configs.xaxis.labels.style:{},colors:m,cssClass:"apexcharts-xaxis-label"}},title:{...l.configs.xaxis?l.configs.xaxis.title:{},style:{color:m}}},yaxis:{...l.configs.yaxis,title:{text:"Temperatura ( °C )",style:{color:m}},labels:{style:{colors:m,cssClass:"apexcharts-yaxis-label"}}}}}})},[c]),u.useEffect(()=>{d([{name:"temperatura",data:s}]),i(l=>({configs:{...l.configs,xaxis:{...l.configs.xaxis,min:new Date(w(t,"YYYY-MM-DD").startOf("day").toISOString()).getTime(),max:new Date(w(t,"YYYY-MM-DD").add(1,"day").startOf("day").toISOString()).getTime()}}}))},[s]),u.useEffect(()=>{i(l=>({configs:{...l.configs,chart:{...l.configs.chart,toolbar:{show:!1,export:{png:{filename:`grafica_temperatura_${encodeURIComponent(o.nodo)}_${encodeURIComponent(o.st_id)}_${encodeURIComponent(o.ubicacion)}_${encodeURIComponent(w(t,"YYYY-MM-DD").unix())}`},svg:{filename:`grafica_temperatura_${encodeURIComponent(o.nodo)}_${encodeURIComponent(o.st_id)}_${encodeURIComponent(o.ubicacion)}_${encodeURIComponent(w(t,"YYYY-MM-DD").unix())}`}}}}}}))},[o,t]),e.jsx(e.Fragment,{children:e.jsx(Zt,{options:r.configs,series:p,type:"line",width:"100%",height:500})})};function or(t,s){const o=ApexCharts.getChartByID(t);o&&(s==="png"?o.exports.exportToPng():s==="svg"&&o.exports.exportToSVG())}const ir=({open:t,setOpen:s,data:o})=>{const[r,i]=u.useState(w()),{nodo:n,ctrl_id:c,st_id:p,serie:d,ubicacion:l}=o,m=()=>{s(!1)},h=u.useRef(null);u.useEffect(()=>(t?h.current||(h.current=R(`${k}/sensor_temperatura/${c}/${p}`)):h.current&&(h.current.disconnect(),h.current=null),()=>{h.current&&(h.current.disconnect(),h.current=null)}),[t,o]);const[g,{data:x,isSuccess:f}]=ft(),_=()=>{g({ctrl_id:c,st_id:p,date:r.format("YYYY-MM-DD")})};return e.jsx(e.Fragment,{children:e.jsxs(Et,{fullWidth:!0,maxWidth:"lg",open:t,onClose:m,sx:{"& .MuiDialog-paper":{backgroundColor:"background.paper",backgroundImage:"inherit"}},children:[e.jsx(Kt,{children:e.jsx(F,{component:"div",variant:"h5",children:"Gráfica Temperatura"})}),e.jsxs(zt,{children:[e.jsxs(ls,{children:["Nodo: ",n," , Ubicacion: ",l," , Serie: ",d]}),e.jsxs(T,{direction:"row",justifyContent:"end",alignItems:"center",spacing:2,marginBottom:2,children:[e.jsx(Ne,{value:r,onChange:S=>{i(S)},slotProps:{textField:{size:"small",sx:{maxWidth:150}}}}),e.jsx(L,{"aria-label":"get register",onClick:_,color:"primary",children:e.jsx(jt,{})})]}),e.jsx(nr,{date:r.format("YYYY-MM-DD"),registerData:f&&x?x:[],info:o})]}),e.jsxs(Yt,{children:[e.jsx(Se,{variant:"contained",onClick:()=>{or("temperature-graph-chart","png")},startIcon:e.jsx(Qt,{}),children:"Descargar"}),e.jsx(Se,{variant:"contained",color:"error",onClick:m,children:"Cerrar"})]})]})})},ar=({ctrl_id:t})=>e.jsx(e.Fragment,{children:e.jsx(b,{sx:{width:"100%",height:"100%"},children:e.jsx(W,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsx(lr,{ctrl_id:Number(t)})})})}),lr=({ctrl_id:t})=>{const{xregion:s,xnodo:o}=Oe(),[r,i]=u.useState([]),n=u.useRef(null),[c,p]=u.useState(!1),[d,l]=u.useState(null),m=h=>{l(h),p(!0)};return u.useEffect(()=>(n.current||(n.current=R(`${k}/sensor_temperatura/${t}`)),n.current.on("initial_list_temperature",h=>{i(h)}),n.current.on("list_temperature",(h,g)=>{g==="add"&&i(x=>x.some(_=>_.st_id===h.st_id)?x:[...x,h].sort((D,y)=>D.st_id-y.st_id)),g==="delete"&&i(x=>x.filter(_=>_.st_id!==h.st_id))}),()=>{n.current&&(n.current.disconnect(),n.current=null)}),[t]),e.jsxs(e.Fragment,{children:[e.jsxs(j,{container:!0,rowSpacing:1,columnSpacing:2,sx:{width:"100%"},children:[r.length===0&&e.jsx(j,{size:{xs:12},sx:{display:"grid",placeItems:"center"},children:e.jsx($,{severity:"warning",variant:"outlined",children:"Asignar al menos un sensor de temperatura"})}),n.current!==null&&r.map((h,g,x)=>{if(n.current===null)return null;const f=e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[e.jsx(cr,{dataViewer:h,socket:n.current}),e.jsx(L,{size:"small","aria-label":"Temperature Graph",color:"primary",onClick:()=>m({...h,nodo:o,region:s,ctrl_id:t}),children:e.jsx(ms,{fontSize:"small"})})]});return x.length===1?e.jsxs(j,{container:!0,sx:{width:"100%"},children:[e.jsx(j,{size:{xs:3}}),e.jsx(j,{size:{xs:6},children:f}),e.jsx(j,{size:{xs:3}})]},t+h.st_id):e.jsx(j,{size:{xs:12,lg:6},children:f},t+h.st_id)})]}),d&&c&&e.jsx(ir,{open:c,setOpen:p,data:d})]})},cr=({dataViewer:t,socket:s})=>{const[o,r]=u.useState(t);return s.on("temperature",i=>{t.st_id===i.st_id&&r(i)}),e.jsx(e.Fragment,{children:e.jsxs(T,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",sx:{flex:1},children:[e.jsx("span",{children:`${pe(o.ubicacion,15)}:`}),e.jsxs(b,{children:[o.actual,"°C"]})]})})},dr=({ctrl_id:t,region:s})=>{const o=bt(),r=z(),[i,n]=u.useState("accesos"),c=p=>{n(p.target.value)};return e.jsx(q,{title:e.jsxs(me,{size:"small",value:i,onChange:c,placeholder:"select-tipo-prioridad",inputProps:{id:"select-prioridad"},children:[e.jsx(A,{value:"accesos",children:"Accesos"}),e.jsx(A,{value:"alarmas",children:"Alarmas"})]}),secondary:e.jsx(Jt,{component:"button",underline:"none",onClick:()=>{r(Ct(s)),r(vt(t)),r(_t(i==="accesos"?"acceso":"entrada")),r(St(w().startOf("day").format("YYYY-MM-DD HH:mm:ss"))),r(yt(w().endOf("day").format("YYYY-MM-DD HH:mm:ss"))),o("/logs")},children:"Ver Mas"}),children:e.jsx(Ze,{component:Ke,variant:"outlined",sx:{height:"100%",width:"100%",overflowY:"auto"},children:e.jsxs(W,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:[i==="accesos"&&e.jsx(ur,{ctrl_id:t}),i==="alarmas"&&e.jsx(mr,{ctrl_id:t})]})})})},lt=M(Qe)(({theme:t})=>({border:"1px solid",borderRadius:2,borderColor:t.palette.mode==="dark"?t.palette.divider:t.palette.grey.A800,backgroundColor:t.palette.background.paper,boxShadow:" rgba(0, 0, 0, 0.2) 0px 2px 1px -1px, rgba(0, 0, 0, 0.14) 0px 1px 1px 0px, rgba(0, 0, 0, 0.12) 0px 1px 3px 0px",backgroundImage:t.palette.mode==="dark"?"linear-gradient(rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.05))":"none"})),ur=({ctrl_id:t})=>{const[s,o]=u.useState([]),r=u.useRef(null);return u.useEffect(()=>(r.current||(r.current=R(`${k}/registro_acceso/${t}`)),r.current.on("list_registros_acceso",i=>{o(i)}),r.current.on("new_registro_acceso",i=>{o(n=>{const c=[i,...n];return c.length>5&&c.splice(5),c})}),()=>{r.current&&(r.current.disconnect(),r.current=null)}),[t]),e.jsxs(e.Fragment,{children:[s.length===0&&e.jsx($,{severity:"info",variant:"outlined",children:"Sin registros de acceso."}),s.length>0&&e.jsxs(lt,{size:"small","aria-label":"a dense table",stickyHeader:!0,sx:{position:"relative"},children:[e.jsx(xe,{children:e.jsxs(Y,{children:[e.jsx(v,{children:"Personal"}),e.jsx(v,{children:"Autorización"}),e.jsx(v,{children:"Fecha"})]})}),e.jsx(ge,{children:s.map((i,n)=>{const{autorizacion:c,fecha:p,personal:d,administrador:l}=i,m=qe(p);return e.jsxs(Y,{children:[e.jsx(v,{children:e.jsx(Xt,{text:d!==void 0?`${d.nombre+" "+d.apellido}`:"no-identificado",maxLength:15,insertDots:!0})}),e.jsxs(v,{children:[c===1&&l===0&&"Autorizado",c===1&&l===1&&"Administrador",c===0&&"Denegado"]}),e.jsx(v,{children:m})]},n)})})]})]})},mr=({ctrl_id:t})=>{const[s,o]=u.useState([]),r=u.useRef(null);return u.useEffect(()=>(r.current||(r.current=R(`${k}/registro_entrada/${t}`)),r.current.on("list_registros_entrada",i=>{o(i)}),r.current.on("new_registro_entrada",i=>{o(n=>{const c=[i,...n];return c.length>5&&c.splice(5),c})}),()=>{r.current&&(r.current.disconnect(),r.current=null)}),[t]),e.jsxs(e.Fragment,{children:[s.length===0&&e.jsx($,{severity:"info",variant:"outlined",children:"Sin registros de alarma."}),s.length>0&&e.jsxs(lt,{size:"small","aria-label":"a dense table",stickyHeader:!0,sx:{position:"relative"},children:[e.jsx(xe,{children:e.jsxs(Y,{children:[e.jsx(v,{children:"Pin"}),e.jsx(v,{children:"Estado"}),e.jsx(v,{children:"Fecha"})]})}),e.jsx(ge,{children:s.map((i,n)=>{const{pin:c,estado:p,fecha:d}=i,l=qe(d);return e.jsxs(Y,{children:[e.jsx(v,{children:c}),e.jsx(v,{children:p===0?"Desactivado":p===1?"Activado":p}),e.jsx(v,{children:l})]},n)})})]})]})};const pr=({ctrl_id:t})=>{const s=u.useRef(null),[o,r]=u.useState([]),[i,n]=u.useState(""),c=o.find(d=>String(d.es_id)===String(i)),p=d=>{n(d.target.value)};return u.useEffect(()=>{o.length>0&&i===""&&n(String(o[0].es_id)),o.find(l=>String(l.es_id)===i)===void 0&&(o.length>0?n(String(o[0].es_id)):n(""))},[o]),u.useEffect(()=>(s.current||(s.current=R(`${k}/pines_salida/${t}`)),s.current.on("equipos_salida",d=>{r(d)}),s.current.on("list_pines_salida",(d,l)=>{r(m=>m.find(({es_id:g})=>g===l.es_id)===void 0?[l,...m].sort((x,f)=>x.es_id-f.es_id):m)}),()=>{s.current&&(s.current.disconnect(),s.current=null)}),[t]),e.jsx(e.Fragment,{children:e.jsx(q,{title:"Control",secondary:e.jsx(wt,{size:"small",sx:{maxWidth:200},children:o.length>0&&e.jsx(me,{id:"control-select",name:"control-select",value:i,onChange:p,size:"small",inputProps:{"aria-label":"Select Control"},children:o.map(d=>e.jsx(A,{value:d.es_id,children:d.actuador},d.es_id))})}),children:e.jsxs(b,{sx:{width:"100%",height:"100%",position:"relative"},children:[o.length===0&&e.jsx(b,{component:"div",sx:{width:"100%",height:"100%",display:"grid",placeItems:"center"},children:e.jsx($,{severity:"warning",variant:"outlined",children:"Asignar al menos un pin de salida"})}),c&&s.current&&e.jsx(hr,{ctrl_id:t,equipo_salida:c,socketRef:s.current},t+c.es_id)]})})})},hr=({equipo_salida:t,socketRef:s,ctrl_id:o})=>{const[r,i]=u.useState([]);return s.on("list_pines_salida",(n,c)=>{t.es_id===c.es_id&&i(n)}),u.useEffect(()=>{s.emit("initial_list_pines_salida",t.es_id)},[t.es_id]),e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"100%",width:"100%",position:"absolute",top:0,left:0},children:e.jsx(W,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsx("div",{className:"grid-container-pinsal-list",children:r.map(n=>e.jsx(xr,{pinSalItem:n,socketRef:s,ctrl_id:o},n.ps_id))})})})})},xr=({pinSalItem:t,socketRef:s,ctrl_id:o})=>{const[r,i]=u.useState(t);return u.useEffect(()=>{s.emit("initial_item_pin_salida",t.ps_id),s.on("item_pin_salida",n=>{t.ps_id===n.ps_id&&i(n)})},[t.ps_id]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid-item-pinsal",children:[e.jsx("span",{children:`${pe(r.descripcion,20)}:`}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:"button_item",onClick:()=>{const{pin:n,es_id:c,ps_id:p}=r;s.emit("orden_pin_salida",{action:0,ctrl_id:o,es_id:c,pin:n,ps_id:p})},style:{backgroundColor:r.orden===0?"#d9d9d9":"transparent",color:r.orden===0?"black":"#1668dc"},children:"A"}),e.jsx("button",{className:"button_item",onClick:()=>{const{pin:n,es_id:c,ps_id:p}=r;s.emit("orden_pin_salida",{action:1,ctrl_id:o,es_id:c,pin:n,ps_id:p})},style:{backgroundColor:r.orden===1?"#49aa19":"transparent",color:r.orden===1?"white":"#1668dc"},children:"ON"}),e.jsx("button",{className:"button_item",onClick:()=>{const{pin:n,es_id:c,ps_id:p}=r;s.emit("orden_pin_salida",{action:-1,ctrl_id:o,es_id:c,pin:n,ps_id:p})},style:{backgroundColor:r.orden===-1?"#a61d24":"transparent",color:r.orden===-1?"white":"#1668dc"},children:"OFF"})]})]})})},Or=()=>{const{xctrl_id:t}=Oe(),s=z(),o=u.useRef(null),r=E(n=>n.multimediaSlice),i=E(n=>n.controllerSiteState);return u.useEffect(()=>(t!==void 0&&(s(Tt({openItem:[`nodo-${t}`]})),o.current||(o.current=R(`${k}/controller_state/${t}`)),o.current.on("controller_info",n=>{s(ye(n))}),o.current.on("update_region",n=>{s(kt(n))}),o.current.on("update_controller",n=>{s(ye(n))}),o.current.on("error_message",n=>{s(we(n.message))}),o.current.on("connect",()=>{s(Dt())}),o.current.on("connect_error",n=>{s(we(`Socket connect error: ${n.message}`))})),()=>{o.current&&(o.current.disconnect(),o.current=null),s(Mt())}),[t]),e.jsxs(b,{sx:{width:"100%",height:"100%",padding:1,overflowY:"auto"},children:[i.isError&&e.jsx("div",{children:i.error??"Ocurrio un error al obtener el controlador"}),i.isSuccess&&i.controller!==void 0&&e.jsx(j,{container:!0,sx:{width:"100%",height:"100%",overflowY:"auto"},rowGap:1,children:e.jsxs(e.Fragment,{children:[e.jsx(j,{size:{xs:12},sx:{height:r.isExpandMultimedia?"100%":"calc(66.7% - 4px)"},children:e.jsxs(j,{container:!0,columnSpacing:1,sx:{height:"100%"},children:[e.jsx(j,{size:{xs:r.isExpandMultimedia?12:8},children:e.jsx(Js,{ctrl_id:i.controller.ctrl_id})}),!r.isExpandMultimedia&&e.jsx(j,{size:{xs:4},sx:{height:"100%"},children:e.jsxs(j,{container:!0,sx:{width:"100%",height:"100%"},gap:1,children:[e.jsx(j,{size:{xs:12},sx:{width:"100%"},children:e.jsx(q,{title:"Temperaturas",children:e.jsx(ar,{ctrl_id:i.controller.ctrl_id})})}),e.jsx(j,{size:{xs:12},sx:{width:"100%"},children:e.jsx(q,{title:"Energia",children:e.jsx(sr,{ctrl_id:i.controller.ctrl_id})})}),e.jsx(j,{size:{xs:12},sx:{width:"100%"},children:e.jsx(pr,{ctrl_id:i.controller.ctrl_id})})]})})]})}),!r.isExpandMultimedia&&e.jsx(j,{size:{xs:12},sx:{height:"calc(33.3% - 4px)"},children:e.jsxs(j,{container:!0,columnSpacing:1,sx:{height:"100%"},children:[e.jsx(j,{size:{xs:4},children:e.jsx(Ts,{ctrl_id:i.controller.ctrl_id})}),e.jsx(j,{size:{xs:4},children:e.jsx(dr,{ctrl_id:i.controller.ctrl_id,region:i.controller.region})}),e.jsx(j,{size:{xs:4},children:e.jsx(er,{ctrl_id:i.controller.ctrl_id})})]})})]})},i.controller.ctrl_id)]})};export{Or as NodoSite,Or as default};
