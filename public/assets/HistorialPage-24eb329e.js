import{g as Le,a as Ge,s as Me,m as Ne,aE as He,r as g,b as Ue,bC as We,j as e,e as Ve,aD as _,f as qe,M as H,N as U,l as Je,bD as Qe,bE as Ke,al as Z,B as X,n as i,am as Y,I as N,aL as Ce,G as l,S as W,au as V,H as x,Z as te,$ as se,a0 as ae,a5 as le,bF as Ze,bG as Xe,D as re,bH as Ye,bI as et,h as tt}from"./index-9bd1da2a.js";import{d as rt,a as ot,T as it}from"./KeyboardArrowUp-e33b894e.js";import{d as ee}from"./CloseRounded-09bbcad0.js";import{a as ye,P as $e,b as Be,c as Re,d as Q,T as p,e as ke}from"./PaperTable-379db512.js";import{g as q}from"./getFormattedDateTime-a73f566b.js";import{S as nt,s as Se}from"./ServerError-9b260039.js";import{d as st}from"./SaveAltRounded-a738c146.js";import{d as de}from"./DownloadRounded-91a2894a.js";import{d as at}from"./Close-83f5d310.js";import{C as lt,d as dt}from"./ChooseFiles-d1bbcb3b.js";import{D as ct,a as pt,b as ut}from"./DialogContent-512bdb02.js";import{D as ht}from"./DialogTitle-40f885de.js";import{C as J}from"./CardHeader-84ffc792.js";import{D as w}from"./Divider-e5407c8e.js";import{a as xt,b as mt,B as E}from"./InputLabel-9c0bbf31.js";import{P as jt,S as gt}from"./Select-97d3f45d.js";import{A as _e}from"./Alert-61a9387e.js";import{C as P}from"./Chip-dd1b7b0c.js";import{M as ce}from"./MenuItem-a1adfdc7.js";import"./LastPage-9b22ebd0.js";function vt(t){return Ge("MuiButtonGroup",t)}const ft=Le("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),a=ft,bt=(t,n)=>{const{ownerState:r}=t;return[{[`& .${a.grouped}`]:n.grouped},{[`& .${a.grouped}`]:n[`grouped${_(r.orientation)}`]},{[`& .${a.grouped}`]:n[`grouped${_(r.variant)}`]},{[`& .${a.grouped}`]:n[`grouped${_(r.variant)}${_(r.orientation)}`]},{[`& .${a.grouped}`]:n[`grouped${_(r.variant)}${_(r.color)}`]},{[`& .${a.firstButton}`]:n.firstButton},{[`& .${a.lastButton}`]:n.lastButton},{[`& .${a.middleButton}`]:n.middleButton},n.root,n[r.variant],r.disableElevation===!0&&n.disableElevation,r.fullWidth&&n.fullWidth,r.orientation==="vertical"&&n.vertical]},Ct=t=>{const{classes:n,color:r,disabled:u,disableElevation:c,fullWidth:s,orientation:o,variant:m}=t,y={root:["root",m,o,s&&"fullWidth",c&&"disableElevation",`color${_(r)}`],grouped:["grouped",`grouped${_(o)}`,`grouped${_(m)}`,`grouped${_(m)}${_(o)}`,`grouped${_(m)}${_(r)}`,u&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return qe(y,vt,n)},yt=Me("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:bt})(Ne(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${a.lastButton},& .${a.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${a.lastButton},& .${a.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${a.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${a.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(([,n])=>n&&n.main).flatMap(([n])=>[{props:{variant:"text",color:n},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / 0.5)`:He(t.palette[n].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${a.lastButton},& .${a.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${a.lastButton},& .${a.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${a.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${a.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(([,n])=>n&&n.dark).map(([n])=>({props:{variant:"contained",color:n},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderColor:(t.vars||t).palette[n].dark}}}))],[`& .${a.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),$t=g.forwardRef(function(n,r){const u=Ue({props:n,name:"MuiButtonGroup"}),{children:c,className:s,color:o="primary",component:m="div",disabled:y=!1,disableElevation:$=!1,disableFocusRipple:B=!1,disableRipple:C=!1,fullWidth:D=!1,orientation:T="horizontal",size:j="medium",variant:d="outlined",...L}=u,F={...u,color:o,component:m,disabled:y,disableElevation:$,disableFocusRipple:B,disableRipple:C,fullWidth:D,orientation:T,size:j,variant:d},R=Ct(F),G=g.useMemo(()=>({className:R.grouped,color:o,disabled:y,disableElevation:$,disableFocusRipple:B,disableRipple:C,fullWidth:D,size:j,variant:d}),[o,y,$,B,C,D,j,d,R.grouped]),z=We(c),K=z.length,oe=M=>{const A=M===0,O=M===K-1;return A&&O?"":A?R.firstButton:O?R.lastButton:R.middleButton};return e.jsx(yt,{as:m,role:"group",className:Ve(R.root,s),ref:r,ownerState:F,...L,children:e.jsx(xt.Provider,{value:G,children:z.map((M,A)=>e.jsx(mt.Provider,{value:oe(A),children:M},A))})})}),Bt=$t;var he={},Rt=U;Object.defineProperty(he,"__esModule",{value:!0});var ze=he.default=void 0,kt=Rt(H()),St=e;ze=he.default=(0,kt.default)((0,St.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6m6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26"}),"Autorenew");var xe={},_t=U;Object.defineProperty(xe,"__esModule",{value:!0});var De=xe.default=void 0,zt=_t(H()),Dt=e;De=xe.default=(0,zt.default)((0,Dt.jsx)("path",{d:"M9 16.17 5.53 12.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0z"}),"CheckRounded");var me={},Tt=U;Object.defineProperty(me,"__esModule",{value:!0});var Te=me.default=void 0,wt=Tt(H()),Et=e;Te=me.default=(0,wt.default)((0,Et.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2M4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12m8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8"}),"DoDisturbAltRounded");var je={},At=U;Object.defineProperty(je,"__esModule",{value:!0});var we=je.default=void 0,Pt=At(H()),Ft=e;we=je.default=(0,Pt.default)((0,Ft.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1m3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"}),"AssignmentRounded");const pe=({fechacomienzo:t,fechatermino:n,children:r,rangeDate:u=!1})=>{const[c,s]=g.useState(!1),o=()=>{const m=new Date(t),y=new Date(n),$=new Date,B=u?$>=m&&$<y:$<m;s(B)};return g.useEffect(()=>{o()},[]),g.useEffect(()=>{const m=setInterval(o,1e3);return()=>clearInterval(m)},[]),e.jsx(e.Fragment,{children:c&&r})};var ge={},Ot=U;Object.defineProperty(ge,"__esModule",{value:!0});var Ee=ge.default=void 0,It=Ot(H()),Lt=e;Ee=ge.default=(0,It.default)((0,Lt.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m4.3 14.3c-.39.39-1.02.39-1.41 0L12 13.41 9.11 16.3c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L10.59 12 7.7 9.11a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 10.59l2.89-2.89c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 12l2.89 2.89c.38.38.38 1.02 0 1.41"}),"CancelRounded");var ve={},Gt=U;Object.defineProperty(ve,"__esModule",{value:!0});var Ae=ve.default=void 0,Mt=Gt(H()),Nt=e;Ae=ve.default=(0,Mt.default)((0,Nt.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd");const Ht=({foto:t})=>{const[n,r]=g.useState(null),u=m=>{r(m.currentTarget)},c=()=>{r(null)},s=!!n,o=s?"simple-popover":void 0;return e.jsxs("div",{children:[e.jsx(E,{"aria-describedby":o,variant:"contained",onClick:u,size:"small",children:"Ver Foto"}),e.jsx(jt,{id:o,open:s,anchorEl:n,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx("img",{src:`${te}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(t)}`,onError:m=>{m.currentTarget.src=Se},alt:"actividad_personal_foto_perfil",width:200,height:200,style:{objectFit:"cover",borderRadius:"50%"}})})]})};function ue(t,n){return n=="docs"?t.reduce((u,c)=>{const s=u,{tipo:o}=c;return(o=="application/pdf"||o=="application/vnd.ms-powerpoint"||o=="application/vnd.openxmlformats-officedocument.presentationml.presentation"||o=="application/vnd.ms-excel"||o=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||o=="application/msword"||o=="application/vnd.openxmlformats-officedocument.wordprocessingml.document")&&s.push(c),s},[]):n=="imgs"?t.reduce((u,c)=>{const s=u,{tipo:o}=c;return(o=="image/jpeg"||o=="image/png"||o=="image/svg+xml"||o=="image/gif"||o=="image/avif"||o=="image/apng"||o=="image/webp")&&s.push(c),s},[]):n=="vids"?t.reduce((u,c)=>{const s=u,{tipo:o}=c;return(o=="video/x-msvideo"||o=="video/mp4"||o=="video/mpeg"||o=="video/ogg"||o=="video/webm"||o=="video/3gpp")&&s.push(c),s},[]):[]}const Ut=({handleCloseDialog:t,isOpen:n,data:r})=>{const{ctrl_id:u,rt_id:c}=r,s=Je(),[o,m]=g.useState(null),[y,{isError:$,isSuccess:B,data:C,error:D,isLoading:T}]=Qe(),{isSuccess:j,data:d,isLoading:L,isError:F}=Ke({ctrl_id:u,rt_id:c}),R=async(h,v)=>{try{const k=JSON.stringify({path:h}),b=await fetch(`${te}/api/v1/ticket/download/archivo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:k});if(!b.ok)throw new Error(`Error al descargar el archivo: ${b.statusText}`);const S=await b.blob(),ne=window.URL.createObjectURL(S),I=document.createElement("a");I.href=ne,I.setAttribute("download",v),document.body.appendChild(I),I.click(),document.body.removeChild(I)}catch(f){console.error("Error al descargar el archivo",f)}},G=async()=>{try{const h=await fetch(`${te}/api/v1/ticket/download?rt_id=${c}&ctrl_id=${u}`,{method:"GET",credentials:"include"});if(!h.ok){Z.error(()=>e.jsx(X,{children:e.jsx(i,{component:"p",variant:"body1",children:JSON.stringify(h)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:Y,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}});return}const v=`TicketDetalles_${Date.now()}.pdf`,f=await h.blob(),k=window.URL.createObjectURL(f),b=document.createElement("a");b.href=k,b.setAttribute("download",v),document.body.appendChild(b),b.click(),document.body.removeChild(b)}catch(h){console.error("Error al descargar archivo pdf de los detalles del ticket.",h)}},[z,K]=g.useState(!1),oe=()=>{z&&(O(null),ie([])),K(!z)},M=["image/jpeg","image/jpg","image/png","application/pdf","video/mp4"],[A,O]=g.useState(null),[fe,ie]=g.useState([]),Pe=h=>{Z.warn(()=>e.jsx(X,{children:e.jsx(i,{component:"p",variant:"body1",children:h})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:Y,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}})},Fe=h=>{const v=new FormData;h.forEach(f=>{v.append("archivos",f)}),O(v)},Oe=h=>{const v=new FormData;h.forEach(f=>{v.append("archivos",f)}),O(v)},Ie=()=>{if(A){const h=new FormData,v=JSON.stringify({ctrl_id:u,rt_id:c});h.append("formvalues",v);for(const[f,k]of A.entries())h.append(f,k);y(h)}};return g.useEffect(()=>{if(j&&d){const{archivos_respaldo:h}=d;m(h)}},[j,d]),g.useEffect(()=>{$&&D&&Z.error(()=>e.jsx(X,{children:e.jsx(i,{component:"p",variant:"body1",children:JSON.stringify(D)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:Y,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}}),B&&C&&(Z.success(()=>e.jsx(X,{children:e.jsx(i,{component:"p",variant:"body1",children:C.message})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:Y,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}}),O(null),ie([]),K(!1),m(C.data))},[$,B,C]),e.jsxs(ct,{open:n,onClose:t,fullWidth:!0,maxWidth:"xl",sx:{"& .MuiDialog-paper":{}},children:[e.jsx(ht,{children:e.jsx(i,{component:"div",variant:"h5",children:"Detalles"})}),e.jsx(N,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(at,{})}),e.jsxs(pt,{dividers:!0,children:[L&&e.jsx(Ce,{children:"Cargando detalles ..."}),F&&e.jsx(nt,{children:"Error al cargar detalles del ticket."}),j&&d&&e.jsxs(l,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(l,{size:{xs:4},children:e.jsxs(W,{children:[e.jsx(J,{sx:{p:1},title:e.jsx(i,{component:"div",variant:"h5",children:"Solicitante"})}),e.jsx(w,{}),e.jsx(V,{children:e.jsxs(l,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(l,{size:{xs:12},children:e.jsxs(x,{spacing:.5,alignItems:"center",children:[e.jsx("img",{src:`${te}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(d.solicitante.foto)}`,alt:"solicitante_foto_perfil",onError:h=>{h.currentTarget.src=Se},width:100,height:100,style:{objectFit:"cover",borderRadius:"50%"}}),e.jsx(i,{component:"p",variant:"h6",children:d.solicitante.nombre}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.cargo})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Nombre"}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.nombre})]})}),e.jsx(l,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.telefono})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Correo"}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.correo})]})}),e.jsx(l,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"DNI"}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.dni})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Cargo"}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.cargo})]})}),e.jsx(l,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(i,{component:"p",variant:"body1",children:d.solicitante.contrata})]})})]})})]})}),e.jsx(l,{size:{xs:8},children:e.jsxs(W,{children:[e.jsx(J,{sx:{p:1},title:e.jsx(i,{component:"div",variant:"h5",children:"Ticket"})}),e.jsx(w,{}),e.jsx(V,{children:e.jsxs(l,{container:!0,rowSpacing:1.5,columnSpacing:1,children:[e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Tipo Trabajo"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.tipotrabajo})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Descripción"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.descripcion})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Prioridad"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.prioridad==1?"Alta":(d.ticket.prioridad==2?"Medio":"Bajo")||"Error_Prioridad"})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.contrata})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Estado"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.estado})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Creación"}),e.jsx(i,{component:"p",variant:"body1",children:q(d.ticket.fechacreacion)})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Comienzo"}),e.jsx(i,{component:"p",variant:"body1",children:q(d.ticket.fechacomienzo)})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Termino"}),e.jsx(i,{component:"p",variant:"body1",children:q(d.ticket.fechatermino)})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Estado Final"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.fechaestadofinal&&q(d.ticket.fechaestadofinal)})]})}),e.jsx(l,{size:{xs:12},children:e.jsx(w,{})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.telefono})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Correo"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.correo})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Numero Ticket:"}),e.jsx(i,{component:"p",variant:"body1",children:d.ticket.rt_id})]})})]})})]})}),e.jsx(l,{size:{xs:12},children:e.jsxs(W,{children:[e.jsx(J,{sx:{p:1},title:e.jsx(i,{component:"div",variant:"h5",children:"Personales"})}),e.jsx(w,{}),e.jsx(V,{children:e.jsx(ye,{component:$e,children:e.jsxs(Be,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(Re,{children:e.jsxs(Q,{children:[e.jsx(p,{children:"N°"}),e.jsx(p,{children:"Nombre"}),e.jsx(p,{children:"Telefono"}),e.jsx(p,{children:"DNI"}),e.jsx(p,{children:"Cargo"}),e.jsx(p,{children:"Contrata"}),e.jsx(p,{children:"Foto"})]})}),e.jsx(ke,{children:d.personales.map((h,v)=>{const{ap_id:f,nombre:k,telefono:b,dni:S,cargo:ne,contrata:I,foto:be}=h;return e.jsxs(Q,{children:[e.jsx(p,{children:v+1}),e.jsx(p,{children:k}),e.jsx(p,{children:b}),e.jsx(p,{children:S}),e.jsx(p,{children:ne}),e.jsx(p,{children:I}),e.jsx(p,{children:be&&e.jsx(Ht,{foto:be},f+S)})]},f)})})]})})})]})}),e.jsx(l,{size:{xs:12},children:e.jsxs(W,{children:[e.jsx(J,{sx:{pl:1,py:1,pr:2},title:e.jsx(i,{component:"div",variant:"h5",children:"Archivos de Respaldo"}),action:e.jsxs(N,{"aria-label":"editar_archivos_respaldo",size:"small",onClick:oe,children:[!z&&e.jsx(Ae,{color:"warning"}),z&&e.jsx(Ee,{color:"error"})]})}),e.jsx(w,{}),e.jsx(V,{children:e.jsxs(l,{container:!0,rowSpacing:1,columnSpacing:1,children:[z&&e.jsx(l,{size:{xs:12},sx:{marginBottom:1,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:s.palette.divider},children:e.jsxs(x,{spacing:1,pb:1,children:[e.jsx(lt,{supportedFormats:M,handleError:Pe,onUpload:Fe,onDelete:Oe,count:5,maxSize:10,files:fe,setFiles:ie,buttonStyle:{maxWidth:300},children:"Nuevos archivos de respaldo:"}),T&&e.jsx(Ce,{children:"Enviando ..."}),fe.length>0&&e.jsx(x,{alignItems:"end",children:e.jsx(E,{sx:{maxWidth:300},onClick:Ie,variant:"contained",type:"submit",startIcon:e.jsx(dt,{}),children:"Guardar"})})]})}),e.jsx(l,{size:{xs:4},sx:{borderRightWidth:"2px",borderRightColor:s.palette.mode==="dark"?s.palette.divider:s.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(x,{direction:"column",spacing:1,children:[e.jsx(i,{component:"div",variant:"body1",children:"Documentos:"}),e.jsx(se,{sx:{pr:1},children:o&&ue(o,"docs").map((h,v,f)=>{const{at_id:k,ruta:b,nombreoriginal:S}=h;return e.jsx(ae,{divider:v<f.length-1,secondaryAction:e.jsx(N,{edge:"end","aria-label":"download_doc",onClick:()=>{R(b,S)},children:e.jsx(de,{color:"info"})}),children:e.jsx(le,{primary:S})},k)})})]})}),e.jsx(l,{size:{xs:4},sx:{borderRightWidth:"2px",borderRightColor:s.palette.mode==="dark"?s.palette.divider:s.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(x,{direction:"column",spacing:1,children:[e.jsx(i,{component:"div",variant:"body1",children:"Fotos:"}),e.jsx(se,{sx:{pr:1},children:o&&ue(o,"imgs").map((h,v,f)=>{const{at_id:k,ruta:b,nombreoriginal:S}=h;return e.jsx(ae,{divider:v<f.length-1,secondaryAction:e.jsx(N,{edge:"end","aria-label":"download_img",onClick:()=>{R(b,S)},children:e.jsx(de,{color:"info"})}),children:e.jsx(le,{primary:S})},k)})})]})}),e.jsx(l,{size:{xs:4},children:e.jsxs(x,{direction:"column",spacing:1,children:[e.jsx(i,{component:"div",variant:"body1",children:"Videos:"}),e.jsx(se,{sx:{pr:1},children:o&&ue(o,"vids").map((h,v,f)=>{const{at_id:k,ruta:b,nombreoriginal:S}=h;return e.jsx(ae,{divider:v<f.length-1,secondaryAction:e.jsx(N,{edge:"end","aria-label":"download_vids",onClick:()=>{R(b,S)},children:e.jsx(de,{color:"info"})}),children:e.jsx(le,{primary:S})},k)})})]})})]})})]})})]})]}),e.jsx(ut,{children:e.jsx(E,{variant:"contained",startIcon:e.jsx(st,{}),onClick:G,children:"Descargar"})})]})},Wt=({id:t})=>t==1?e.jsx(P,{icon:e.jsx(ze,{}),color:"warning",variant:"filled",label:"Pendiente"}):t==2?e.jsx(P,{icon:e.jsx(De,{}),color:"success",variant:"filled",label:"Aceptado"}):t==3?e.jsx(P,{icon:e.jsx(Te,{}),color:"error",variant:"filled",label:"Cancelado"}):t==4?e.jsx(P,{icon:e.jsx(ee,{}),label:"Rechazado"}):t==16?e.jsx(P,{icon:e.jsx(ee,{}),label:"Finalizado"}):t==17?e.jsx(P,{icon:e.jsx(ee,{}),label:"Anulado"}):t==18?e.jsx(P,{icon:e.jsx(ee,{}),label:"No Atendido"}):e.jsx(P,{label:"Error id"}),Vt=({handleChangePage:t,handleChangeRowsPerPage:n,page:r,rowsPerPage:u,tickets:c})=>e.jsx(e.Fragment,{children:e.jsxs(x,{spacing:1,direction:"row",alignItems:"center",justifyContent:"end",children:[e.jsx("p",{children:"N° Tickets:"}),e.jsxs(gt,{id:"control-select",name:"control-select",value:u,onChange:n,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5}},children:[e.jsx(ce,{value:10,children:10}),e.jsx(ce,{value:20,children:20}),e.jsx(ce,{value:50,children:50})]}),e.jsxs("p",{children:[c>0?r*u+1:0,"-",(r+1)*u<c?(r+1)*u:c," ","de ",c]}),e.jsx(it,{count:c,onPageChange:t,rowsPerPage:u,page:r})]})}),qt=({ctrl_id:t,nodo:n})=>{const[r,u]=g.useState(!0),[c,s]=g.useState(0),[o,m]=g.useState(10),y=j=>{m(j.target.value),s(0)},$=(j,d)=>{s(d)},[B,{isError:C,isSuccess:D,data:T}]=Xe();return g.useEffect(()=>{B({ctrl_id:t,limit:o,offset:c*o})},[t,c,o]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{children:[e.jsx(p,{children:e.jsx(N,{"aria-label":"expand row",size:"small",onClick:()=>u(!r),children:r?e.jsx(rt,{}):e.jsx(ot,{})})}),e.jsx(p,{children:re(n,15)}),e.jsx(p,{colSpan:6,children:e.jsxs(e.Fragment,{children:[D&&r&&T&&e.jsx(Vt,{handleChangePage:$,handleChangeRowsPerPage:y,page:c,rowsPerPage:o,tickets:T.total_size}),C&&e.jsxs(_e,{variant:"filled",severity:"error",children:["Error obtener tickets del nodo : ",n]})]})})]}),r&&D&&T&&e.jsx(e.Fragment,{children:T.data.map(j=>e.jsx(Jt,{ctrl_id:t,registroTicket:j},j.rt_id))})]})},Jt=({ctrl_id:t,registroTicket:n})=>{var d,L,F,R,G;const[r,u]=g.useState(n),[c,{isSuccess:s}]=Ye(),[o,{isSuccess:m,data:y}]=et(),[$,B]=g.useState(!1),C=tt(z=>z.auth),D=()=>{B(!1)},T=()=>{B(!0)},j=z=>{c({action:z,ctrl_id:t,rt_id:r.rt_id})};return g.useEffect(()=>{m&&y&&u(y)},[m,y]),g.useEffect(()=>{s&&o({ctrl_id:t,rt_id:r.rt_id})},[s]),e.jsx(e.Fragment,{children:e.jsxs(Q,{children:[e.jsx(p,{}),e.jsx(p,{}),e.jsx(p,{children:r.rt_id}),e.jsx(p,{children:`${re(r.nombre.split(" ")[0],15)}  ${re(r.apellido.split(" ")[0],15)}`}),e.jsx(p,{children:re(r.descripcion.split(" ")[0],40,!0)}),e.jsx(p,{children:e.jsx(Wt,{id:r.estd_id})}),e.jsx(p,{children:q(r.fechacomienzo)}),e.jsx(p,{children:e.jsxs(x,{direction:"row",spacing:r.estd_id==1||r.estd_id==2?2:void 0,justifyContent:"space-between",children:[e.jsxs(Bt,{variant:"contained","aria-label":"outlined button group",size:"small",color:"primary",children:[((d=C.user)==null?void 0:d.rol)==="Invitado"&&r.estd_id==1&&e.jsx(pe,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:e.jsx(E,{onClick:()=>j(3),children:"Cancelar"})}),(((L=C.user)==null?void 0:L.rol)==="Usuario"||((F=C.user)==null?void 0:F.rol)==="Administrador")&&(r.estd_id==1||r.estd_id==2)&&e.jsxs(pe,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:[r.estd_id==1&&e.jsx(E,{onClick:()=>j(2),children:"Aceptar"}),e.jsx(E,{onClick:()=>j(4),children:"Rechazar"}),e.jsx(E,{onClick:()=>j(3),children:"Cancelar"})]}),(((R=C.user)==null?void 0:R.rol)==="Usuario"||((G=C.user)==null?void 0:G.rol)==="Administrador")&&r.estd_id==2&&e.jsxs(pe,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!0,children:[e.jsx(E,{onClick:()=>j(16),children:"Finalizar"}),e.jsx(E,{onClick:()=>j(17),children:"Anular"})]})]}),e.jsx(E,{variant:"contained",color:"info",startIcon:e.jsx(we,{}),onClick:T,children:"Detalles"})]})}),$&&e.jsx(Ut,{isOpen:$,handleCloseDialog:D,data:{ctrl_id:t,p_id:r.p_id,rt_id:r.rt_id}})]})})},Qt=()=>{const{isSuccess:t,isError:n,data:r}=Ze();return e.jsxs(e.Fragment,{children:[e.jsx(J,{title:e.jsx(i,{component:"h5",variant:"h5",children:"HISTORIAL DE TICKETS"})}),e.jsx(V,{children:e.jsx(ye,{component:$e,children:e.jsxs(Be,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(Re,{children:e.jsxs(Q,{children:[e.jsx(p,{}),e.jsx(p,{children:"Nodo"}),e.jsx(p,{children:"#Ticket"}),e.jsx(p,{children:"Solicitante"}),e.jsx(p,{children:"Descripcion"}),e.jsx(p,{children:"Estado"}),e.jsx(p,{children:"Fecha Trabajo"}),e.jsx(p,{children:"Acciones"})]})}),e.jsxs(ke,{children:[t&&r.map(u=>{const{ctrl_id:c,nodo:s,region:o}=u;return e.jsx(qt,{ctrl_id:c,nodo:s,region:o},u.ctrl_id)}),n&&e.jsx(_e,{variant:"filled",severity:"error",children:"Error al cargar nodos."})]})]})})})]})},jr=()=>e.jsx(e.Fragment,{children:e.jsx(l,{size:{xs:12},children:e.jsx(W,{children:e.jsx(Qt,{})})})});export{jr as HistorialPage,jr as default};
