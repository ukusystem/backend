import{c as we,j as e,r as h,u as Ae,I as z,g as Ee,a as Fe,s as E,m as ne,T as He,S as oe,b as Ne,d as je,e as se,f as $e,i as Ve,h as We,k,l as Ge,n as G,B as v,G as p,o as y,p as L,q as Qe,t as re,v as K,w as Ue,x as le,y as ce,z as V,A as ie,C as de,D as R,E as xe,F as $,H as Ke,J as qe,K as P,R as Xe,L as Je,M as Ze,N as pe,O as Oe,P as et,Q as tt,U as st,V as at,W as Pe,X as ot,Y as it,Z as B,_ as ae}from"./index-82986cbd.js";import{_ as q}from"./react-apexcharts.min-255737c1.js";import{M as Me}from"./Link-16ff552d.js";import{d as nt}from"./Close-6dcbe0e4.js";import{D as rt,a as lt}from"./useMobilePicker-85a269f8.js";import{D as ct}from"./DialogTitle-73a74144.js";import{u as dt,f as ye,N as xt,g as ht,a as ut,b as gt}from"./index-8e9f4ca6.js";import{T as mt,d as ft,a as pt}from"./KeyboardArrowUp-ba5ea0a8.js";import{T as w,a as _e,P as Te,b as Ie,c as Ye,d as W,e as Re}from"./PaperTable-580deb38.js";import{K as bt,a as jt,D as yt}from"./DateTimePicker-b26b9546.js";import{M as A,D as ke}from"./MenuItem-321b6a5e.js";import{g as St}from"./getFormattedDateTime-f28f8120.js";import{d as me}from"./ArrowDropDownOutlined-d02a8e41.js";import{d as fe}from"./CloseRounded-508ed96d.js";import{g as Q}from"./groupByKey-ca6ec8a0.js";import"./InputAdornment-c988aa7a.js";import"./LastPage-8ef23493.js";import"./date-time-utils-72093555.js";import"./validateTime-20a0d11f.js";const Ct=we(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),vt=we(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),wt=h.forwardRef(function(a,r){const{backIconButtonProps:d,count:x,disabled:n=!1,getItemAriaLabel:i,nextIconButtonProps:m,onPageChange:u,page:l,rowsPerPage:o,showFirstButton:c,showLastButton:g,slots:j={},slotProps:s={},...b}=a,S=Ae(),I=H=>{u(H,0)},f=H=>{u(H,l-1)},C=H=>{u(H,l+1)},D=H=>{u(H,Math.max(0,Math.ceil(x/o)-1))},M=j.firstButton??z,X=j.lastButton??z,F=j.nextButton??z,J=j.previousButton??z,Z=j.firstButtonIcon??Ct,N=j.lastButtonIcon??vt,_=j.nextButtonIcon??bt,T=j.previousButtonIcon??jt,O=S?X:M,ee=S?F:J,ue=S?J:F,te=S?M:X,ge=S?s.lastButton:s.firstButton,Y=S?s.nextButton:s.previousButton,ze=S?s.previousButton:s.nextButton,Le=S?s.firstButton:s.lastButton;return e.jsxs("div",{ref:r,...b,children:[c&&e.jsx(O,{onClick:I,disabled:n||l===0,"aria-label":i("first",l),title:i("first",l),...ge,children:S?e.jsx(N,{...s.lastButtonIcon}):e.jsx(Z,{...s.firstButtonIcon})}),e.jsx(ee,{onClick:f,disabled:n||l===0,color:"inherit","aria-label":i("previous",l),title:i("previous",l),...Y??d,children:S?e.jsx(_,{...s.nextButtonIcon}):e.jsx(T,{...s.previousButtonIcon})}),e.jsx(ue,{onClick:C,disabled:n||(x!==-1?l>=Math.ceil(x/o)-1:!1),color:"inherit","aria-label":i("next",l),title:i("next",l),...ze??m,children:S?e.jsx(T,{...s.previousButtonIcon}):e.jsx(_,{...s.nextButtonIcon})}),g&&e.jsx(te,{onClick:D,disabled:n||l>=Math.ceil(x/o)-1,"aria-label":i("last",l),title:i("last",l),...Le,children:S?e.jsx(Z,{...s.firstButtonIcon}):e.jsx(N,{...s.lastButtonIcon})})]})}),Pt=wt;function Mt(t){return Fe("MuiTablePagination",t)}const _t=Ee("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]),U=_t;var Se;const Tt=E(w,{name:"MuiTablePagination",slot:"Root",overridesResolver:(t,a)=>a.root})(ne(({theme:t})=>({overflow:"auto",color:(t.vars||t).palette.text.primary,fontSize:t.typography.pxToRem(14),"&:last-child":{padding:0}}))),It=E(He,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(t,a)=>({[`& .${U.actions}`]:a.actions,...a.toolbar})})(ne(({theme:t})=>({minHeight:52,paddingRight:2,[`${t.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[t.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${U.actions}`]:{flexShrink:0,marginLeft:20}}))),Yt=E("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(t,a)=>a.spacer})({flex:"1 1 100%"}),Rt=E("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(t,a)=>a.selectLabel})(ne(({theme:t})=>({...t.typography.body2,flexShrink:0}))),kt=E(oe,{name:"MuiTablePagination",slot:"Select",overridesResolver:(t,a)=>({[`& .${U.selectIcon}`]:a.selectIcon,[`& .${U.select}`]:a.select,...a.input,...a.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${U.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),Dt=E(A,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(t,a)=>a.menuItem})({}),Bt=E("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(t,a)=>a.displayedRows})(ne(({theme:t})=>({...t.typography.body2,flexShrink:0})));function zt({from:t,to:a,count:r}){return`${t}â€“${a} of ${r!==-1?r:`more than ${a}`}`}function Lt(t){return`Go to ${t} page`}const At=t=>{const{classes:a}=t;return We({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},Mt,a)},Et=h.forwardRef(function(a,r){const d=Ne({props:a,name:"MuiTablePagination"}),{ActionsComponent:x=Pt,backIconButtonProps:n,className:i,colSpan:m,component:u=w,count:l,disabled:o=!1,getItemAriaLabel:c=Lt,labelDisplayedRows:g=zt,labelRowsPerPage:j="Rows per page:",nextIconButtonProps:s,onPageChange:b,onRowsPerPageChange:S,page:I,rowsPerPage:f,rowsPerPageOptions:C=[10,25,50,100],SelectProps:D={},showFirstButton:M=!1,showLastButton:X=!1,slotProps:F={},slots:J={},...Z}=d,N=d,_=At(N),T=(F==null?void 0:F.select)??D,O=T.native?"option":Dt;let ee;(u===w||u==="td")&&(ee=m||1e3);const ue=je(T.id),te=je(T.labelId),ge=()=>l===-1?(I+1)*f:f===-1?l:Math.min(l,(I+1)*f);return e.jsx(Tt,{colSpan:ee,ref:r,as:u,ownerState:N,className:se(_.root,i),...Z,children:e.jsxs(It,{className:_.toolbar,children:[e.jsx(Yt,{className:_.spacer}),C.length>1&&e.jsx(Rt,{className:_.selectLabel,id:te,children:j}),C.length>1&&e.jsx(kt,{variant:"standard",...!T.variant&&{input:Se||(Se=e.jsx($e,{}))},value:f,onChange:S,id:ue,labelId:te,...T,classes:{...T.classes,root:se(_.input,_.selectRoot,(T.classes||{}).root),select:se(_.select,(T.classes||{}).select),icon:se(_.selectIcon,(T.classes||{}).icon)},disabled:o,children:C.map(Y=>h.createElement(O,{...!Ve(O)&&{ownerState:N},className:_.menuItem,key:Y.label?Y.label:Y,value:Y.value?Y.value:Y},Y.label?Y.label:Y))}),e.jsx(Bt,{className:_.displayedRows,children:g({from:l===0?0:I*f+1,to:ge(),count:l===-1?-1:l,page:I})}),e.jsx(x,{className:_.actions,backIconButtonProps:n,count:l,nextIconButtonProps:s,onPageChange:b,page:I,rowsPerPage:f,showFirstButton:M,showLastButton:X,slotProps:F.actions,slots:J.actions,getItemAriaLabel:c,disabled:o})]})})}),Ft=Et;function he(t,a,r){const d=[],x=[];return t.length>0?(t.forEach(n=>{n[a]&&n[r]&&(d.push(n[a]),x.push(n[r]))}),{categories:d,series:x}):{categories:d,series:x}}const Ht=()=>{const[t,a]=h.useState({configs:{chart:{type:"bar",id:"bar_active_pin_entrada",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#1668dc","#65a9f3"]}}),[r,d]=h.useState([]),{ctrl_id:x,date:n,period_time:i}=k(s=>s.dashboardStore),[m,{isError:u,isLoading:l,isSuccess:o,data:c}]=Ge(),g=G(),j=g.palette.mode;return h.useEffect(()=>{a(s=>{const b=j==="dark"?g.palette.text.secondary:g.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:g.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:b,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:b}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:b,cssClass:"apexcharts-yaxis-label"}}}}}})},[j]),h.useEffect(()=>{x!==""&&n!==null&&i!==""&&m({ctrl_id:Number(x),date:n,monthly:i==="monthly"?"true":"false"})},[x,n,i]),h.useEffect(()=>{if(!l&&o&&c){const s=he(c,"detector","total_activo");a(b=>({configs:{...b.configs,xaxis:{...b.configs.xaxis,categories:s.categories}}})),d([{data:s.series,name:"activaciones"}])}!l&&u&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),d([]))},[o,c,l,u]),e.jsx(e.Fragment,{children:e.jsxs(v,{children:[e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsx(y,{variant:"h5",children:"Pines Entrada"})}),e.jsx(p,{})]}),e.jsx(L,{sx:{mt:2},children:e.jsx(q,{options:t.configs,series:r,type:"bar",height:365})})]})})},Nt=()=>{const[t,a]=h.useState({configs:{chart:{type:"bar",id:"bar_active_pin_salida",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#d89614"]}}),[r,d]=h.useState([]),{ctrl_id:x,date:n,period_time:i}=k(s=>s.dashboardStore),[m,{isError:u,isLoading:l,isSuccess:o,data:c}]=Qe(),g=G(),j=g.palette.mode;return h.useEffect(()=>{a(s=>{const b=j==="dark"?g.palette.text.secondary:g.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:g.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:b,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:b}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:b,cssClass:"apexcharts-yaxis-label"}}}}}})},[j]),h.useEffect(()=>{x!==""&&n!==null&&i!==""&&m({ctrl_id:Number(x),date:n,monthly:i==="monthly"?"true":"false"})},[x,n,i]),h.useEffect(()=>{if(!l&&o&&c){const s=he(c,"actuador","total_activo");a(b=>({configs:{...b.configs,xaxis:{...b.configs.xaxis,categories:s.categories}}})),d([{data:s.series,name:"activaciones"}])}!l&&u&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),d([]))},[o,c,l,u]),e.jsx(e.Fragment,{children:e.jsxs(v,{children:[e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsx(y,{variant:"h5",children:"Pines Salida"})}),e.jsx(p,{})]}),e.jsx(L,{sx:{mt:2},children:e.jsx(q,{options:t.configs,series:r,type:"bar",height:365})})]})})},$t=()=>{const{ctrl_id:t,region:a,date:r,period_time:d}=k(f=>f.dashboardStore),x=re(),n=K(),[i,m]=h.useState({configs:{chart:{type:"donut",height:365},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:"#8c8c8c"},value:{color:"#8c8c8c"}}}}},labels:["Registrado","No registrado","Remoto"],dataLabels:{formatter(f,C){return C.w.globals.series[C.seriesIndex]}},legend:{labels:{colors:"#8c8c8c"}}}}),[u,l]=h.useState([0,0,0]),[o,{isError:c,isLoading:g,isSuccess:j,data:s}]=Ue(),b=G(),S=b.palette.mode,I=h.useCallback((f,C,D)=>{const M=D.dataPointIndex;M!=null&&M>-1&&d==="monthly"&&(n(le(a)),n(ce(t)),M===0?(n(V("acceso")),n(ie([{id:"autorizacion",value:"1"},{id:"tipo",value:"1"}]))):M===1?(n(V("acceso")),n(ie([{id:"autorizacion",value:"0"},{id:"tipo",value:"1"},{id:"co_id",value:"0"}]))):M===2&&(n(V("salida")),n(ie([{id:"es_id",value:"1"},{id:"estado",value:"1"}]))),n(de(R(r,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),n(xe(R(r,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),x("/logs"))},[d]);return h.useEffect(()=>{m(f=>{const C=S==="dark"?b.palette.text.secondary:b.palette.text.primary;return{configs:{...f.configs,chart:{...f.configs.chart,background:b.palette.background.paper},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:C},value:{color:C}}}}},legend:{...f.configs.legend,labels:{colors:C}}}}})},[S]),h.useEffect(()=>{t!==""&&r!==null&&d!==""&&o({ctrl_id:Number(t),date:r,monthly:d==="monthly"?"true":"false"})},[t,r,d]),h.useEffect(()=>{!g&&j&&s&&(l([s.data.tarjeta.total_registrado,s.data.tarjeta.total_noregistrado,s.data.remoto.total_remoto]),m(f=>({configs:{...f.configs,chart:{...f.configs.chart,events:{click:I}}}}))),!g&&c&&l([0,0,0])},[j,s,g,c,d]),e.jsx(e.Fragment,{children:e.jsxs(v,{children:[e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsx(y,{variant:"h5",children:"Accesos"})}),e.jsx(p,{})]}),e.jsx(L,{sx:{mt:2,height:365},children:e.jsx(q,{options:i.configs,series:u,type:"donut",height:365})})]})})},Vt=()=>{const[t,a]=h.useState({configs:{chart:{type:"bar",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(s,b,S){return $(String(s),15,!0)}}},yaxis:{stepSize:1,min:0,max:s=>s+1,title:{text:"Numero Tickets",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[r,d]=h.useState([]),{ctrl_id:x,date:n,period_time:i}=k(s=>s.dashboardStore),[m,{isError:u,isLoading:l,isSuccess:o,data:c}]=Ke(),g=G(),j=g.palette.mode;return h.useEffect(()=>{a(s=>{const b=j==="dark"?g.palette.text.secondary:g.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:g.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:b,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:b}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:b,cssClass:"apexcharts-yaxis-label"}}}}}})},[j]),h.useEffect(()=>{x!==""&&n!==null&&i!==""&&m({ctrl_id:Number(x),date:n,monthly:i==="monthly"?"true":"false"})},[x,n,i]),h.useEffect(()=>{if(!l&&o&&c){const s=he(c.data,"contrata","total_ticket");a(b=>({configs:{...b.configs,xaxis:{...b.configs.xaxis,categories:s.categories}}})),d([{data:s.series,name:"tickets"}])}!l&&u&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),d([]))},[o,c,l,u]),e.jsx(e.Fragment,{children:e.jsxs(v,{children:[e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsx(y,{variant:"h5",children:"Tickets"})}),e.jsx(p,{})]}),e.jsx(L,{sx:{mt:2,height:365},children:e.jsx(q,{options:t.configs,series:r,type:"bar",height:365})})]})})},Wt="/assets/alarm-icon-a43fb34b.svg",Gt=()=>{const{ctrl_id:t,region:a,date:r,period_time:d}=k(j=>j.dashboardStore),[x,{isError:n,isLoading:i,isSuccess:m,data:u}]=qe(),[l,o]=h.useState(0),c=re(),g=K();return h.useEffect(()=>{t!==""&&r!==""&&d!==""&&x({ctrl_id:Number(t),date:r,monthly:d==="monthly"?"true":"false"})},[t,r,d]),h.useEffect(()=>{!i&&m&&u&&o(u.data.total_alarma),!i&&n&&o(0)},[m,u,i,n]),e.jsxs(L,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Alarmas"}),e.jsxs(v,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(P,{direction:"row",alignItems:"end",children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:l}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"activaciones"})]}),e.jsx("img",{src:Wt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),d==="monthly"&&e.jsx(P,{direction:"row",justifyContent:"end",children:e.jsx(Me,{component:"button",underline:"hover",onClick:()=>{g(le(a)),g(ce(t)),g(V("salida")),g(de(R(r,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),g(xe(R(r,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),c("/logs")},children:"Ver Mas"})})]})},Qt="/assets/tarjeta-icon-b78bb548.svg",De=({onClose:t,open:a,title:r,children:d})=>e.jsxs(rt,{open:a,onClose:t,fullWidth:!0,maxWidth:"md",children:[e.jsx(ct,{children:e.jsx(y,{component:"div",variant:"h5",children:r})}),e.jsx(z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(nt,{})}),e.jsx(lt,{dividers:!0,children:d})]}),Ut=({data:t})=>{const a=h.useMemo(()=>t.length===0?[]:Object.keys(t[0]).map(n=>({accessorKey:n,header:()=>e.jsx("span",{children:n})})),[t]),r=dt({data:t,columns:a,getCoreRowModel:ht(),getFilteredRowModel:ut(),getPaginationRowModel:gt(),initialState:{pagination:{pageSize:25}}}),{pageSize:d,pageIndex:x}=r.getState().pagination;return e.jsx(e.Fragment,{children:e.jsxs(v,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden",rowGap:1},children:[e.jsx(v,{sx:{flex:1,overflow:"hidden"},children:e.jsxs(_e,{sx:{height:"100%",display:"flex",flexDirection:"column"},component:Te,variant:"outlined",children:[e.jsxs(Ie,{size:"small",stickyHeader:!0,"aria-label":"sticky table",sx:{position:"relative"},children:[e.jsx(Ye,{children:r.getHeaderGroups().map(n=>e.jsxs(Xe.Fragment,{children:[e.jsx(W,{children:n.headers.map(i=>e.jsx(w,{colSpan:i.colSpan,children:i.isPlaceholder?null:e.jsx("div",{children:ye(i.column.columnDef.header,i.getContext())})},i.id))}),e.jsx(W,{children:n.headers.map(i=>e.jsx(w,{colSpan:i.colSpan,children:i.isPlaceholder?null:e.jsx("div",{children:i.column.getCanFilter()&&e.jsx("div",{children:e.jsx(Kt,{column:i.column,table:r})})})},i.id))})]},n.id))}),e.jsx(Re,{children:r.getRowModel().rows.map(n=>e.jsx(W,{children:n.getVisibleCells().map(i=>e.jsx(w,{children:ye(i.column.columnDef.cell,i.getContext())},i.id))},n.id))})]}),r.getFilteredRowModel().rows.length===0&&e.jsxs(v,{sx:{width:"100%",height:"100%",textAlign:"center",py:2,display:"flex",flexDirection:"column",alignItems:"center",rowGap:2},children:[e.jsx(xt,{}),"Datos no encontrados"]})]})}),e.jsx(Ft,{rowsPerPageOptions:[25,50,100,{label:"All",value:t.length}],component:"div",count:r.getFilteredRowModel().rows.length,rowsPerPage:d,page:x,labelDisplayedRows:({from:n,to:i,count:m})=>`${n}â€“${i} de ${m!==-1?m:`more than ${i}`}`,labelRowsPerPage:"Filas por Pagina :",SelectProps:{inputProps:{"aria-label":"rows per page"},id:"test-id"},onPageChange:(n,i)=>{r.setPageIndex(i)},onRowsPerPageChange:n=>{const i=n.target.value?Number(n.target.value):25;r.setPageSize(i)},ActionsComponent:mt})]})})};function Kt({column:t}){const a=t.getFilterValue();return e.jsx(Je,{value:a??"",onChange:r=>t.setFilterValue(r.target.value),placeholder:"Buscar...",inputProps:{"aria-label":"search"},id:`filter-column-by-${t.id}`,size:"small",fullWidth:!0})}const qt=()=>{const{ctrl_id:t,date:a,period_time:r}=k(s=>s.dashboardStore),[d,{isError:x,isLoading:n,isSuccess:i,data:m}]=Ze(),[u,l]=h.useState(0),[o,c]=h.useState(!1),g=()=>{c(!1)},j=()=>{!n&&i&&m&&c(!0)};return h.useEffect(()=>{t!==""&&a!==""&&d()},[t,a]),h.useEffect(()=>{!n&&i&&m&&l(m.total_tarjeta),!n&&x&&l(0)},[i,m,n,x]),e.jsxs(L,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Tarjetas"}),e.jsxs(v,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(P,{direction:"row",alignItems:"end",children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:u}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"asignados"})]}),e.jsx("img",{src:Qt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),e.jsx(P,{direction:"row",justifyContent:"end",children:r==="monthly"&&e.jsx(pe,{size:"small",onClick:j,children:"Ver Detalles"})}),e.jsx(De,{title:"Detalles Tarjetas Asignadas",onClose:g,open:o,children:!n&&i&&m&&e.jsx(Ut,{data:m.data})})]})},Xt="/assets/electricity-icon-e7ff5bd6.svg",Jt=()=>{const{ctrl_id:t,date:a,period_time:r,region:d}=k(j=>j.dashboardStore),[x,{isError:n,isLoading:i,isSuccess:m,data:u}]=Oe(),[l,o]=h.useState(0),c=re(),g=K();return h.useEffect(()=>{t!==""&&a!==""&&r!==""&&x({ctrl_id:Number(t),date:a,monthly:r==="monthly"?"true":"false"})},[t,a,r]),h.useEffect(()=>{!i&&m&&u&&o(u.acumulado),!i&&n&&o(0)},[m,u,i,n]),e.jsxs(L,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Potencia"}),e.jsxs(v,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(P,{direction:"row",alignItems:"end",spacing:1,children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:l}),e.jsx(y,{color:"inherit",component:"span",fontSize:30,lineHeight:1,children:"kw"}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"consumidos"})]}),e.jsx("img",{src:Xt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),r==="monthly"&&e.jsx(P,{direction:"row",justifyContent:"end",children:e.jsx(Me,{component:"button",underline:"hover",onClick:()=>{g(le(d)),g(ce(t)),g(V("energia")),g(de(R(a,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),g(xe(R(a,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),c("/logs")},children:"Ver Mas"})})]})},Zt=()=>{const[t,a]=h.useState({configs:{chart:{height:365,type:"bar",toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(f,C,D){return $(String(f),15,!0)}}},yaxis:{stepSize:1,min:0,max:f=>f+1,title:{text:"Temperatura Max",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[r,d]=h.useState([]),{ctrl_id:x,date:n,period_time:i}=k(f=>f.dashboardStore),[m,{isError:u,isLoading:l,isSuccess:o,data:c}]=et(),g=G(),j=g.palette.mode;h.useEffect(()=>{a(f=>{const C=j==="dark"?g.palette.text.secondary:g.palette.text.primary;return{configs:{...f.configs,chart:{...f.configs.chart,background:g.palette.background.paper},xaxis:{...f.configs.xaxis,labels:{...f.configs.xaxis?f.configs.xaxis.labels:{},style:{...f.configs.xaxis&&f.configs.xaxis.labels?f.configs.xaxis.labels.style:{},colors:C,cssClass:"apexcharts-xaxis-label"}},title:{...f.configs.xaxis?f.configs.xaxis.title:{},style:{color:C}}},yaxis:{...f.configs.yaxis,labels:{style:{colors:C,cssClass:"apexcharts-yaxis-label"}}}}}})},[j]),h.useEffect(()=>{x!==""&&n!==null&&i!==""&&m({ctrl_id:Number(x),date:n,monthly:i==="monthly"?"true":"false"})},[x,n,i]),h.useEffect(()=>{if(!l&&o&&c){const f=Ce(c.data),C=Object.values(f).map(M=>M[0]),D=he(C,"ubicacion","max_valor");a(M=>({configs:{...M.configs,xaxis:{...M.configs.xaxis,categories:D.categories}}})),d([{data:D.series,name:"tickets"}])}!l&&u&&(a(f=>({configs:{...f.configs,xaxis:{...f.configs.xaxis,categories:[]}}})),d([]))},[o,c,l,u]);const[s,b]=h.useState(!1),S=()=>{b(!1)},I=()=>{!l&&o&&c&&b(!0)};return e.jsx(e.Fragment,{children:e.jsxs(v,{children:[e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsx(y,{variant:"h5",children:"Temperatura"})}),e.jsx(p,{})]}),e.jsxs(L,{sx:{mt:2,height:i==="monthly"?420:365},children:[e.jsx(q,{options:t.configs,series:r,type:"bar",height:365}),e.jsx(P,{direction:"row",justifyContent:"end",children:i==="monthly"&&e.jsx(pe,{size:"small",onClick:I,children:"Ver Detalles"})})]}),e.jsx(De,{title:"Detalles Temperatura",onClose:S,open:s,children:!l&&o&&c&&e.jsx(Ot,{data:Object.values(Ce(c.data))})})]})})},Ot=({data:t})=>e.jsx(_e,{component:Te,variant:"outlined",children:e.jsxs(Ie,{size:"small","aria-label":"a dense table",children:[e.jsx(Ye,{children:e.jsxs(W,{children:[e.jsx(w,{children:"Sensor Temperatura"}),e.jsx(w,{children:"Serie"}),e.jsx(w,{children:"Max Valor"}),e.jsx(w,{children:"Fecha"}),e.jsx(w,{children:"AcciÃ³n"})]})}),e.jsx(Re,{children:t.map((a,r)=>e.jsx(es,{data:a},r))})]})}),es=({data:t})=>{const[a,r]=h.useState(!0),{ctrl_id:d,date:x,region:n}=k(u=>u.dashboardStore),i=re(),m=K();return e.jsxs(e.Fragment,{children:[e.jsxs(W,{children:[e.jsx(w,{children:e.jsxs(P,{direction:"row",alignItems:"center",children:[e.jsx(z,{"aria-label":"expand row",size:"small",onClick:()=>r(!a),children:a?e.jsx(ft,{}):e.jsx(pt,{})}),e.jsx(y,{children:t[0].ubicacion})]})}),e.jsx(w,{colSpan:4})]}),a&&t.map(u=>e.jsxs(W,{children:[e.jsx(w,{}),e.jsx(w,{children:u.serie}),e.jsx(w,{children:u.max_valor}),e.jsxs(w,{children:[" ",St(u.fecha)]}),e.jsxs(w,{children:[" ",e.jsx(pe,{variant:"contained",color:"info",onClick:()=>{m(le(n)),m(ce(d)),m(V("temperatura")),m(ie([{id:"st_id",value:u.st_id}])),m(de(R(x,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),m(xe(R(x,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})]})]},u.rtmp_id))]})};function Ce(t){const a={};return t.forEach(r=>{a[r.st_id]||(a[r.st_id]=[]),a[r.st_id].push(r)}),a}var be={},ts=st;Object.defineProperty(be,"__esModule",{value:!0});var Be=be.default=void 0,ss=ts(tt()),as=e;Be=be.default=(0,ss.default)((0,as.jsx)("path",{d:"M15 9H9v6h6zm-2 4h-2v-2h2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2zm-4 6H7V7h10z"}),"Memory");const os=()=>{const{ctrl_id:t,period_time:a}=k(o=>o.dashboardStore),[r,{isError:d,isLoading:x,isSuccess:n,data:i}]=at(),[m,u]=h.useState({camera:[],controller:[]}),l=G();return h.useEffect(()=>{t!==""&&r({ctrl_id:Number(t)})},[t]),h.useEffect(()=>{!x&&n&&i&&u(i.states),!x&&d&&u({camera:[],controller:[]})},[n,i,x,d]),e.jsxs(v,{children:[e.jsxs(p,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{children:e.jsx(y,{variant:"h5",children:"Estados"})}),e.jsx(p,{})]}),e.jsx(L,{sx:{mt:2,height:a==="monthly"?420:365},children:e.jsx(v,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(v,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(Pe,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(p,{container:!0,padding:2,rowSpacing:2,columnSpacing:2.5,children:[e.jsx(p,{size:{xs:12},children:e.jsx(y,{variant:"h6",color:l.palette.text.secondary,children:"Camaras"})}),m.camera.map((o,c)=>e.jsx(p,{size:{xs:12,sm:6,md:4},children:e.jsxs(P,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(P,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(ot,{isSelected:!1}),e.jsxs(P,{children:[e.jsx(y,{variant:"h6",children:$(o.descripcion,15,!0)}),e.jsx(y,{variant:"caption",color:l.palette.text.secondary,children:$(o.tipo,15,!0)})]})]}),e.jsx(ve,{conectado:o.conectado})]})},c)),e.jsx(p,{size:{xs:12},children:e.jsx(ke,{})}),e.jsx(p,{size:{xs:12},children:e.jsx(y,{variant:"h6",color:l.palette.text.secondary,children:"Controladores"})}),m.controller.map((o,c)=>e.jsx(p,{size:{xs:12,sm:6,md:4},children:e.jsxs(P,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(P,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Be,{fontSize:"large"}),e.jsxs(P,{children:[e.jsx(y,{variant:"h6",children:$(o.nodo,15,!0)}),e.jsx(y,{variant:"caption",color:l.palette.text.secondary,children:$(o.descripcion,15,!0)})]})]}),e.jsx(ve,{conectado:o.conectado})]})},c))]})})})})})]})},ve=({conectado:t})=>t===0?e.jsx(v,{sx:{width:30,height:30,backgroundColor:"#f74c48",borderRadius:"50%"}}):t===1?e.jsx(v,{sx:{width:30,height:30,backgroundColor:"#04c584",borderRadius:"50%"}}):e.jsx(v,{sx:{width:30,height:30,backgroundColor:"#bfbfbf",borderRadius:"50%"}}),is=()=>{const t=K(),{isSuccess:a,data:r}=it(),{period_time:d,ctrl_id:x,date:n,rgn_id:i}=k(o=>o.dashboardStore),m=o=>{t(B({rgn_id:o.target.value,ctrl_id:""}))},u=o=>{t(B({ctrl_id:o.target.value}))},l=o=>{t(B({period_time:o.target.value}))};return h.useEffect(()=>{if(a){const o=r[0];o!==void 0&&x===""&&(t(B({rgn_id:String(o.rgn_id),region:o.region.region})),t(B({ctrl_id:String(o.ctrl_id)})))}},[a,r]),h.useEffect(()=>{t(B({date:R().format("YYYY-MM")}))},[]),e.jsx(e.Fragment,{children:e.jsxs(p,{container:!0,size:{xs:12},rowSpacing:3,columnSpacing:2.75,children:[e.jsx(p,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(P,{spacing:1,children:[e.jsx(ae,{htmlFor:"group_site",sx:{display:"none"},children:"Grupo de sitio"}),e.jsxs(oe,{displayEmpty:!0,value:i,onChange:m,inputProps:{id:"group_site"},renderValue:o=>{if(o.length===0)return e.jsx(e.Fragment,{children:"Grupo de sitio"});let c;return a&&(c=Q(r,"rgn_id")[o]?Q(r,"rgn_id")[o][0]:void 0),e.jsx(e.Fragment,{children:c==null?void 0:c.region.region})},IconComponent:({...o})=>i!==""?e.jsx(z,{onClick:c=>{c.stopPropagation(),console.log("delete filter"),t(B({rgn_id:"",ctrl_id:""}))},sx:{width:"1em",height:"1em",position:"absolute",right:7,top:"calc(50% - .5em)"},children:e.jsx(fe,{fontSize:"small"})}):e.jsx(me,{...o}),MenuProps:{PaperProps:{style:{maxHeight:200}}},children:[e.jsx(A,{disabled:!0,value:"",children:e.jsx(e.Fragment,{children:"Grupo de sitio"})}),a&&Object.entries(Q(r,"rgn_id")).map(([o,c])=>e.jsx(A,{value:o,children:e.jsx(v,{sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%"},children:c[0].region.region})},o))]})]})}),e.jsx(p,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(P,{spacing:1,children:[e.jsx(ae,{htmlFor:"site_item",sx:{display:"none"},children:"Sitio"}),e.jsxs(oe,{disabled:i==="",displayEmpty:!0,value:x,onChange:u,inputProps:{id:"site_item"},renderValue:o=>{if(o.length===0)return e.jsx(e.Fragment,{children:"Sitio"});let c;return a&&(c=r.find(g=>String(g.ctrl_id)===String(o))),e.jsx(e.Fragment,{children:c==null?void 0:c.nodo})},IconComponent:({...o})=>x!==""?e.jsx(z,{onClick:c=>{c.stopPropagation(),t(B({ctrl_id:""}))},sx:{width:"1em",height:"1em",position:"absolute",right:7,top:"calc(50% - .5em)"},children:e.jsx(fe,{fontSize:"small"})}):e.jsx(me,{...o}),MenuProps:{PaperProps:{style:{maxHeight:200}}},children:[e.jsx(A,{disabled:!0,value:"",children:e.jsx(e.Fragment,{children:"Sitio"})}),a&&i!==""&&Q(r,"rgn_id")[i]&&Q(r,"rgn_id")[i].map(o=>e.jsx(A,{value:o.ctrl_id,children:e.jsx(v,{sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%"},children:o.nodo})},o.ctrl_id))]})]})}),e.jsx(p,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(P,{spacing:1,children:[e.jsx(ae,{htmlFor:"period_time",sx:{display:"none"},children:"Periodo"}),e.jsxs(oe,{displayEmpty:!0,value:d,onChange:l,inputProps:{id:"period_time"},renderValue:o=>o.length===0?e.jsx(e.Fragment,{children:"Mes o aÃ±o"}):e.jsx(e.Fragment,{children:o==="monthly"?"Mes":o==="anualy"?"AÃ±o":"No controlado"}),IconComponent:({...o})=>d!==""?e.jsx(z,{onClick:c=>{c.stopPropagation(),t(B({period_time:""}))},sx:{width:"1em",height:"1em",position:"absolute",right:7,top:"calc(50% - .5em)"},children:e.jsx(fe,{fontSize:"small"})}):e.jsx(me,{...o}),MenuProps:{PaperProps:{style:{}}},children:[e.jsx(A,{disabled:!0,value:"",children:e.jsx(e.Fragment,{children:"Mes o aÃ±o"})}),e.jsx(A,{value:"monthly",children:"Mes"},"monthly"),e.jsx(A,{value:"anualy",children:"AÃ±o"},"anualy")]})]})}),e.jsx(p,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(P,{spacing:1,children:[e.jsx(ae,{htmlFor:"date-select-dashboard",sx:{display:"none"},children:"Fecha"}),e.jsx(yt,{disabled:d==="",views:d==="anualy"?["year"]:["month","year"],ampm:!1,format:d==="anualy"?"YYYY":"MM/YYYY",value:n!==""?R(n,"YYYY-MM"):R(),onChange:o=>{o&&t(B({date:o.format("YYYY-MM")}))},slotProps:{textField:{size:"medium",id:"date-select-dashboard"}}})]})})]})})},ns=E(p)(({theme:t})=>({[t.breakpoints.down("sm")]:{padding:"16px"},[t.breakpoints.up("sm")]:{padding:"24px"}}));function Ms(){return e.jsx(e.Fragment,{children:e.jsx(v,{sx:{width:"100%",height:"100%"},children:e.jsx(Pe,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(ns,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(p,{size:{xs:12},sx:{mb:-2.25},children:e.jsx(y,{variant:"h5",children:"Panel"})}),e.jsx(is,{}),e.jsx(p,{size:{xs:12},children:e.jsx(ke,{})}),e.jsx(p,{size:{xs:12,sm:6,md:4},children:e.jsx(Gt,{})}),e.jsx(p,{size:{xs:12,sm:6,md:4},children:e.jsx(qt,{})}),e.jsx(p,{size:{xs:12,sm:12,md:4},children:e.jsx(Jt,{})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(Ht,{})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(Nt,{})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx($t,{})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(Vt,{})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(Zt,{})}),e.jsx(p,{size:{xs:12,md:6},children:e.jsx(os,{})})]})})})})}export{Ms as default};
