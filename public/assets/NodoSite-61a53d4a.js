import{b as le,g as ce,s as R,a as f,r as u,d as F,_ as k,j as e,f as Ae,h as de,m as E,aO as Mt,c as W,aP as Ee,aQ as ue,aR as Ye,u as pe,aS as Ve,au as ve,B as _,X as O,Y as S,F as w,k as U,p as B,ab as se,ac as ge,ap as It,ah as He,ai as re,I as V,aT as me,aU as Ne,aK as Ue,L as he,M as xe,aV as $t,aW as Z,aX as Ft,aY as Ot,z as T,S as Lt,O as ne,G as y,C as ye,aZ as zt,a_ as Be,o as At,t as Et,v as Yt,w as Vt,y as Ht,A as Nt,a$ as Ut,b0 as Ie,b1 as Bt,b2 as $e,b3 as qt,b4 as Gt}from"./index-83afeab6.js";import{C as ae}from"./CardHeader-759658f7.js";import{D as Wt,M as N}from"./MenuItem-93e28968.js";import{A as H}from"./Alert-f4f0b96c.js";import{s as qe,u as Ge,a as Q,b as We,v as _e,c as L,d as Qe,e as ie,f as Ce,P as Ke,g as K,r as Pe,h as Xe,i as Ze,j as q,C as Qt,k as fe,l as Je,m as t,n as et,D as tt,o as Kt,p as Xt,q as J,t as ee,w as Fe,x as Oe,y as ot,z as Zt,A as Jt,B as be}from"./timeViewRenderers-6943ade0.js";import{T as nt}from"./TextField-df3bb6ad.js";import{T as st,t as rt,L as eo}from"./LimitedTextDisplay-3a921ecb.js";import{S as to}from"./StreamPlayer-51ad0714.js";import{d as oo,a as no}from"./LastPage-ac832881.js";import{d as so,a as ro,g as at}from"./getFormattedDateTime-93199493.js";import{S as Te}from"./Select-8c656a15.js";import{S as it}from"./ServerError-436f42ba.js";import{b as lt,a as ct,f as dt,c as we,d as G,T as C,e as Se}from"./PaperTable-7d18355c.js";import{d as ao}from"./DownloadRounded-03c8d222.js";import{_ as io}from"./react-apexcharts.min-1038ce7b.js";import{D as lo,a as co,b as uo}from"./DialogContent-d94138cf.js";import{D as po}from"./DialogTitle-5e150ee5.js";import{S as mo}from"./Send-37cf0347.js";import{B as Le}from"./InputLabel-a01ea7c7.js";import{M as ho}from"./Link-84f933ee.js";import{F as xo}from"./FormControl-8b31c5e5.js";import"./InputAdornment-ca976e16.js";import"./Chip-308c01b2.js";function fo(o){return le("MuiCardActions",o)}ce("MuiCardActions",["root","spacing"]);const go=["disableSpacing","className"],bo=o=>{const{classes:n,disableSpacing:a}=o;return de({root:["root",!a&&"spacing"]},fo,n)},jo=R("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(o,n)=>{const{ownerState:a}=o;return[n.root,!a.disableSpacing&&n.spacing]}})(({ownerState:o})=>f({display:"flex",alignItems:"center",padding:8},!o.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})),vo=u.forwardRef(function(n,a){const s=F({props:n,name:"MuiCardActions"}),{disableSpacing:r=!1,className:i}=s,d=k(s,go),m=f({},s,{disableSpacing:r}),c=bo(m);return e.jsx(jo,f({className:Ae(c.root,i),ownerState:m,ref:a},d))}),ut=vo;function yo(o){return le("MuiDialogContentText",o)}ce("MuiDialogContentText",["root"]);const _o=["children","className"],Co=o=>{const{classes:n}=o,s=de({root:["root"]},yo,n);return f({},n,s)},Po=R(E,{shouldForwardProp:o=>Mt(o)||o==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(o,n)=>n.root})({}),To=u.forwardRef(function(n,a){const s=F({props:n,name:"MuiDialogContentText"}),{className:r}=s,i=k(s,_o),d=Co(i);return e.jsx(Po,f({component:"p",variant:"body1",color:"text.secondary",ref:a,ownerState:i,className:Ae(d.root,r)},s,{classes:d}))}),wo=To,So=W([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"},"1")],"CameraAlt"),Do=W(e.jsx("path",{d:"M16.59 9H15V4c0-.55-.45-1-1-1h-4c-.55 0-1 .45-1 1v5H7.41c-.89 0-1.34 1.08-.71 1.71l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.63-.63.19-1.71-.7-1.71zM5 19c0 .55.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1z"}),"DownloadRounded"),ko=W(e.jsx("path",{d:"m15.96 10.29-2.75 3.54-1.96-2.36L8.5 15h11l-3.54-4.71zM3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"}),"Filter"),Ro=W(e.jsx("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2z"}),"Timeline"),Mo=W(e.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 12.5v-9l6 4.5-6 4.5z"}),"VideoLibrary"),Io=W(e.jsx("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"}),"Videocam"),$o=o=>{var n,a,s;const r=L(),i=Qe();return f({},o,{disablePast:(n=o.disablePast)!=null?n:!1,disableFuture:(a=o.disableFuture)!=null?a:!1,format:(s=o.format)!=null?s:r.formats.keyboardDate,minDate:ie(r,o.minDate,i.minDate),maxDate:ie(r,o.maxDate,i.maxDate)})},Fo=({props:o,inputRef:n})=>{const a=$o(o),{forwardedProps:s,internalProps:r}=qe(a,"date");return Ge({inputRef:n,forwardedProps:s,internalProps:r,valueManager:Q,fieldValueManager:We,validator:_e,valueType:"date"})},Oo=["components","componentsProps","slots","slotProps","InputProps","inputProps"],Lo=["inputRef"],zo=["ref","onPaste","onKeyDown","inputMode","readOnly"],pt=u.forwardRef(function(n,a){var s,r,i;const d=F({props:n,name:"MuiDateField"}),{components:m,componentsProps:c,slots:l,slotProps:p,InputProps:h,inputProps:x}=d,g=k(d,Oo),b=d,v=(s=(r=l==null?void 0:l.textField)!=null?r:m==null?void 0:m.TextField)!=null?s:nt,j=Ee({elementType:v,externalSlotProps:(i=p==null?void 0:p.textField)!=null?i:c==null?void 0:c.textField,externalForwardedProps:g,ownerState:b}),{inputRef:M}=j,P=k(j,Lo);P.inputProps=f({},x,P.inputProps),P.InputProps=f({},h,P.InputProps);const z=Fo({props:P,inputRef:M}),{ref:I,onPaste:D,onKeyDown:A,inputMode:Y,readOnly:X}=z,$=k(z,zo);return e.jsx(v,f({ref:a},$,{InputProps:f({},$.InputProps,{readOnly:X}),inputProps:f({},$.inputProps,{inputMode:Y,onPaste:D,onKeyDown:A,ref:I})}))}),Ao=o=>{var n,a,s,r;const i=L(),m=((n=o.ampm)!=null?n:i.is12HourCycleInCurrentLocale())?i.formats.fullTime12h:i.formats.fullTime24h;return f({},o,{disablePast:(a=o.disablePast)!=null?a:!1,disableFuture:(s=o.disableFuture)!=null?s:!1,format:(r=o.format)!=null?r:m})},Eo=({props:o,inputRef:n})=>{const a=Ao(o),{forwardedProps:s,internalProps:r}=qe(a,"time");return Ge({inputRef:n,forwardedProps:s,internalProps:r,valueManager:Q,fieldValueManager:We,validator:Ce,valueType:"time"})},Yo=["slots","slotProps","components","componentsProps","InputProps","inputProps"],Vo=["inputRef"],Ho=["ref","onPaste","onKeyDown","inputMode","readOnly"],mt=u.forwardRef(function(n,a){var s,r,i;const d=F({props:n,name:"MuiTimeField"}),{slots:m,slotProps:c,components:l,componentsProps:p,InputProps:h,inputProps:x}=d,g=k(d,Yo),b=d,v=(s=(r=m==null?void 0:m.textField)!=null?r:l==null?void 0:l.TextField)!=null?s:nt,j=Ee({elementType:v,externalSlotProps:(i=c==null?void 0:c.textField)!=null?i:p==null?void 0:p.textField,externalForwardedProps:g,ownerState:b}),{inputRef:M}=j,P=k(j,Vo);P.inputProps=f({},x,P.inputProps),P.InputProps=f({},h,P.InputProps);const z=Eo({props:P,inputRef:M}),{ref:I,onPaste:D,onKeyDown:A,inputMode:Y,readOnly:X}=z,$=k(z,Ho);return e.jsx(v,f({ref:a},$,{InputProps:f({},$.InputProps,{readOnly:X}),inputProps:f({},$.inputProps,{inputMode:Y,onPaste:D,onKeyDown:A,ref:I})}))});function No(o){return le("MuiDatePickerToolbar",o)}ce("MuiDatePickerToolbar",["root","title"]);const Uo=["value","isLandscape","onChange","toolbarFormat","toolbarPlaceholder","views"],Bo=o=>{const{classes:n}=o;return de({root:["root"],title:["title"]},No,n)},qo=R(Ke,{name:"MuiDatePickerToolbar",slot:"Root",overridesResolver:(o,n)=>n.root})({}),Go=R(E,{name:"MuiDatePickerToolbar",slot:"Title",overridesResolver:(o,n)=>n.title})(({ownerState:o})=>f({},o.isLandscape&&{margin:"auto 16px auto auto"})),Wo=u.forwardRef(function(n,a){const s=F({props:n,name:"MuiDatePickerToolbar"}),{value:r,isLandscape:i,toolbarFormat:d,toolbarPlaceholder:m="––",views:c}=s,l=k(s,Uo),p=L(),h=K(),x=Bo(s),g=u.useMemo(()=>{if(!r)return m;const v=Pe(p,{format:d,views:c},!0);return p.formatByString(r,v)},[r,d,m,p,c]),b=s;return e.jsx(qo,f({ref:a,toolbarTitle:h.datePickerToolbarTitle,isLandscape:i,className:x.root},l,{children:e.jsx(Go,{variant:"h4",align:i?"left":"center",ownerState:b,className:x.title,children:g})}))});function ht(o,n){var a,s,r,i;const d=L(),m=Qe(),c=F({props:o,name:n}),l=u.useMemo(()=>{var h;return((h=c.localeText)==null?void 0:h.toolbarTitle)==null?c.localeText:f({},c.localeText,{datePickerToolbarTitle:c.localeText.toolbarTitle})},[c.localeText]),p=(a=c.slots)!=null?a:Xe(c.components);return f({},c,{localeText:l},Ze({views:c.views,openTo:c.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{disableFuture:(s=c.disableFuture)!=null?s:!1,disablePast:(r=c.disablePast)!=null?r:!1,minDate:ie(d,c.minDate,m.minDate),maxDate:ie(d,c.maxDate,m.maxDate),slots:f({toolbar:Wo},p),slotProps:(i=c.slotProps)!=null?i:c.componentsProps})}const xt=u.forwardRef(function(n,a){var s,r,i,d;const m=K(),c=L(),l=ht(n,"MuiDesktopDatePicker"),p=f({day:q,month:q,year:q},l.viewRenderers),h=f({},l,{viewRenderers:p,format:Pe(c,l,!1),yearsPerRow:(s=l.yearsPerRow)!=null?s:4,slots:f({openPickerIcon:Qt,field:pt},l.slots),slotProps:f({},l.slotProps,{field:g=>{var b;return f({},ue((b=l.slotProps)==null?void 0:b.field,g),fe(l),{ref:a})},toolbar:f({hidden:!0},(r=l.slotProps)==null?void 0:r.toolbar)})}),{renderPicker:x}=Je({props:h,valueManager:Q,valueType:"date",getOpenDialogAriaText:(i=(d=h.localeText)==null?void 0:d.openDatePickerDialogue)!=null?i:m.openDatePickerDialogue,validator:_e});return x()});xt.propTypes={autoFocus:t.bool,className:t.string,closeOnSelect:t.bool,components:t.object,componentsProps:t.object,dayOfWeekFormatter:t.func,defaultCalendarMonth:t.any,defaultValue:t.any,disabled:t.bool,disableFuture:t.bool,disableHighlightToday:t.bool,disableOpenPicker:t.bool,disablePast:t.bool,displayWeekNumber:t.bool,fixedWeekNumber:t.number,format:t.string,formatDensity:t.oneOf(["dense","spacious"]),inputRef:t.oneOfType([t.func,t.shape({current:t.object})]),label:t.node,loading:t.bool,localeText:t.object,maxDate:t.any,minDate:t.any,monthsPerRow:t.oneOf([3,4]),onAccept:t.func,onChange:t.func,onClose:t.func,onError:t.func,onMonthChange:t.func,onOpen:t.func,onSelectedSectionsChange:t.func,onViewChange:t.func,onYearChange:t.func,open:t.bool,openTo:t.oneOf(["day","month","year"]),orientation:t.oneOf(["landscape","portrait"]),readOnly:t.bool,reduceAnimations:t.bool,referenceDate:t.any,renderLoading:t.func,selectedSections:t.oneOfType([t.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),t.number,t.shape({endIndex:t.number.isRequired,startIndex:t.number.isRequired})]),shouldDisableDate:t.func,shouldDisableMonth:t.func,shouldDisableYear:t.func,showDaysOutsideCurrentMonth:t.bool,slotProps:t.object,slots:t.object,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object]),timezone:t.string,value:t.any,view:t.oneOf(["day","month","year"]),viewRenderers:t.shape({day:t.func,month:t.func,year:t.func}),views:t.arrayOf(t.oneOf(["day","month","year"]).isRequired),yearsPerRow:t.oneOf([3,4])};const ft=u.forwardRef(function(n,a){var s,r,i;const d=K(),m=L(),c=ht(n,"MuiMobileDatePicker"),l=f({day:q,month:q,year:q},c.viewRenderers),p=f({},c,{viewRenderers:l,format:Pe(m,c,!1),slots:f({field:pt},c.slots),slotProps:f({},c.slotProps,{field:x=>{var g;return f({},ue((g=c.slotProps)==null?void 0:g.field,x),fe(c),{ref:a})},toolbar:f({hidden:!1},(s=c.slotProps)==null?void 0:s.toolbar)})}),{renderPicker:h}=et({props:p,valueManager:Q,valueType:"date",getOpenDialogAriaText:(r=(i=p.localeText)==null?void 0:i.openDatePickerDialogue)!=null?r:d.openDatePickerDialogue,validator:_e});return h()});ft.propTypes={autoFocus:t.bool,className:t.string,closeOnSelect:t.bool,components:t.object,componentsProps:t.object,dayOfWeekFormatter:t.func,defaultCalendarMonth:t.any,defaultValue:t.any,disabled:t.bool,disableFuture:t.bool,disableHighlightToday:t.bool,disableOpenPicker:t.bool,disablePast:t.bool,displayWeekNumber:t.bool,fixedWeekNumber:t.number,format:t.string,formatDensity:t.oneOf(["dense","spacious"]),inputRef:t.oneOfType([t.func,t.shape({current:t.object})]),label:t.node,loading:t.bool,localeText:t.object,maxDate:t.any,minDate:t.any,monthsPerRow:t.oneOf([3,4]),onAccept:t.func,onChange:t.func,onClose:t.func,onError:t.func,onMonthChange:t.func,onOpen:t.func,onSelectedSectionsChange:t.func,onViewChange:t.func,onYearChange:t.func,open:t.bool,openTo:t.oneOf(["day","month","year"]),orientation:t.oneOf(["landscape","portrait"]),readOnly:t.bool,reduceAnimations:t.bool,referenceDate:t.any,renderLoading:t.func,selectedSections:t.oneOfType([t.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),t.number,t.shape({endIndex:t.number.isRequired,startIndex:t.number.isRequired})]),shouldDisableDate:t.func,shouldDisableMonth:t.func,shouldDisableYear:t.func,showDaysOutsideCurrentMonth:t.bool,slotProps:t.object,slots:t.object,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object]),timezone:t.string,value:t.any,view:t.oneOf(["day","month","year"]),viewRenderers:t.shape({day:t.func,month:t.func,year:t.func}),views:t.arrayOf(t.oneOf(["day","month","year"]).isRequired),yearsPerRow:t.oneOf([3,4])};const Qo=["desktopModeMediaQuery"],gt=u.forwardRef(function(n,a){const s=F({props:n,name:"MuiDatePicker"}),{desktopModeMediaQuery:r=tt}=s,i=k(s,Qo);return Ye(r,{defaultMatches:!0})?e.jsx(xt,f({ref:a},i)):e.jsx(ft,f({ref:a},i))});function Ko(o){return le("MuiTimePickerToolbar",o)}const te=ce("MuiTimePickerToolbar",["root","separator","hourMinuteLabel","hourMinuteLabelLandscape","hourMinuteLabelReverse","ampmSelection","ampmLandscape","ampmLabel"]),Xo=["ampm","ampmInClock","value","isLandscape","onChange","view","onViewChange","views","disabled","readOnly"],Zo=o=>{const{theme:n,isLandscape:a,classes:s}=o,r={root:["root"],separator:["separator"],hourMinuteLabel:["hourMinuteLabel",a&&"hourMinuteLabelLandscape",n.direction==="rtl"&&"hourMinuteLabelReverse"],ampmSelection:["ampmSelection",a&&"ampmLandscape"],ampmLabel:["ampmLabel"]};return de(r,Ko,s)},Jo=R(Ke,{name:"MuiTimePickerToolbar",slot:"Root",overridesResolver:(o,n)=>n.root})({}),en=R(Kt,{name:"MuiTimePickerToolbar",slot:"Separator",overridesResolver:(o,n)=>n.separator})({outline:0,margin:"0 4px 0 2px",cursor:"default"}),bt=R("div",{name:"MuiTimePickerToolbar",slot:"HourMinuteLabel",overridesResolver:(o,n)=>[{[`&.${te.hourMinuteLabelLandscape}`]:n.hourMinuteLabelLandscape,[`&.${te.hourMinuteLabelReverse}`]:n.hourMinuteLabelReverse},n.hourMinuteLabel]})(({theme:o,ownerState:n})=>f({display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},n.isLandscape&&{marginTop:"auto"},o.direction==="rtl"&&{flexDirection:"row-reverse"}));bt.propTypes={as:t.elementType,ownerState:t.object.isRequired,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object])};const jt=R("div",{name:"MuiTimePickerToolbar",slot:"AmPmSelection",overridesResolver:(o,n)=>[{[`.${te.ampmLabel}`]:n.ampmLabel},{[`&.${te.ampmLandscape}`]:n.ampmLandscape},n.ampmSelection]})(({ownerState:o})=>f({display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:12},o.isLandscape&&{margin:"4px 0 auto",flexDirection:"row",justifyContent:"space-around",flexBasis:"100%"},{[`& .${te.ampmLabel}`]:{fontSize:17}}));jt.propTypes={as:t.elementType,ownerState:t.object.isRequired,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object])};function tn(o){const n=F({props:o,name:"MuiTimePickerToolbar"}),{ampm:a,ampmInClock:s,value:r,isLandscape:i,onChange:d,view:m,onViewChange:c,views:l,disabled:p,readOnly:h}=n,x=k(n,Xo),g=L(),b=K(),v=pe(),j=!!(a&&!s&&l.includes("hours")),{meridiemMode:M,handleMeridiemChange:P}=Xt(r,a,d),z=Y=>a?g.format(Y,"hours12h"):g.format(Y,"hours24h"),I=n,D=Zo(f({},I,{theme:v})),A=e.jsx(en,{tabIndex:-1,value:":",variant:"h3",selected:!1,className:D.separator});return e.jsxs(Jo,f({landscapeDirection:"row",toolbarTitle:b.timePickerToolbarTitle,isLandscape:i,ownerState:I,className:D.root},x,{children:[e.jsxs(bt,{className:D.hourMinuteLabel,ownerState:I,children:[J(l,"hours")&&e.jsx(ee,{tabIndex:-1,variant:"h3",onClick:()=>c("hours"),selected:m==="hours",value:r?z(r):"--"}),J(l,["hours","minutes"])&&A,J(l,"minutes")&&e.jsx(ee,{tabIndex:-1,variant:"h3",onClick:()=>c("minutes"),selected:m==="minutes",value:r?g.format(r,"minutes"):"--"}),J(l,["minutes","seconds"])&&A,J(l,"seconds")&&e.jsx(ee,{variant:"h3",onClick:()=>c("seconds"),selected:m==="seconds",value:r?g.format(r,"seconds"):"--"})]}),j&&e.jsxs(jt,{className:D.ampmSelection,ownerState:I,children:[e.jsx(ee,{disableRipple:!0,variant:"subtitle2",selected:M==="am",typographyClassName:D.ampmLabel,value:Fe(g,"am"),onClick:h?void 0:()=>P("am"),disabled:p}),e.jsx(ee,{disableRipple:!0,variant:"subtitle2",selected:M==="pm",typographyClassName:D.ampmLabel,value:Fe(g,"pm"),onClick:h?void 0:()=>P("pm"),disabled:p})]})]}))}function vt(o,n){var a,s,r,i,d;const m=L(),c=F({props:o,name:n}),l=(a=c.ampm)!=null?a:m.is12HourCycleInCurrentLocale(),p=u.useMemo(()=>{var g;return((g=c.localeText)==null?void 0:g.toolbarTitle)==null?c.localeText:f({},c.localeText,{timePickerToolbarTitle:c.localeText.toolbarTitle})},[c.localeText]),h=(s=c.slots)!=null?s:Xe(c.components),x=(r=c.slotProps)!=null?r:c.componentsProps;return f({},c,{ampm:l,localeText:p},Ze({views:c.views,openTo:c.openTo,defaultViews:["hours","minutes"],defaultOpenTo:"hours"}),{disableFuture:(i=c.disableFuture)!=null?i:!1,disablePast:(d=c.disablePast)!=null?d:!1,slots:f({toolbar:tn},h),slotProps:f({},x,{toolbar:f({ampm:l,ampmInClock:c.ampmInClock},x==null?void 0:x.toolbar)})})}const yt=u.forwardRef(function(n,a){var s,r,i,d,m,c,l;const p=K(),h=L(),x=vt(n,"MuiDesktopTimePicker"),g=(s=x.thresholdToRenderTimeInASingleColumn)!=null?s:24,b=f({hours:1,minutes:5,seconds:5},x.timeSteps),v=24*60/(b.hours*b.minutes)<=g,j=v?Jt:Oe,M=f({hours:j,minutes:j,seconds:j,meridiem:j},x.viewRenderers),P=(r=x.ampmInClock)!=null?r:!0,z=v?[]:["accept"],I=((i=M.hours)==null?void 0:i.name)===Oe.name,D=x.ampm&&I?[...x.views,"meridiem"]:x.views,A=f({},x,{ampmInClock:P,timeSteps:b,viewRenderers:M,format:ot(h,x),views:v?["hours"]:D,slots:f({field:mt,openPickerIcon:Zt},x.slots),slotProps:f({},x.slotProps,{field:X=>{var $;return f({},ue(($=x.slotProps)==null?void 0:$.field,X),fe(x),{ref:a})},toolbar:f({hidden:!0,ampmInClock:P},(d=x.slotProps)==null?void 0:d.toolbar),actionBar:f({actions:z},(m=x.slotProps)==null?void 0:m.actionBar)})}),{renderPicker:Y}=Je({props:A,valueManager:Q,valueType:"time",getOpenDialogAriaText:(c=(l=A.localeText)==null?void 0:l.openTimePickerDialogue)!=null?c:p.openTimePickerDialogue,validator:Ce});return Y()});yt.propTypes={ampm:t.bool,ampmInClock:t.bool,autoFocus:t.bool,className:t.string,closeOnSelect:t.bool,components:t.object,componentsProps:t.object,defaultValue:t.any,disabled:t.bool,disableFuture:t.bool,disableIgnoringDatePartForTimeValidation:t.bool,disableOpenPicker:t.bool,disablePast:t.bool,format:t.string,formatDensity:t.oneOf(["dense","spacious"]),inputRef:t.oneOfType([t.func,t.shape({current:t.object})]),label:t.node,localeText:t.object,maxTime:t.any,minTime:t.any,minutesStep:t.number,onAccept:t.func,onChange:t.func,onClose:t.func,onError:t.func,onOpen:t.func,onSelectedSectionsChange:t.func,onViewChange:t.func,open:t.bool,openTo:t.oneOf(["hours","meridiem","minutes","seconds"]),orientation:t.oneOf(["landscape","portrait"]),readOnly:t.bool,reduceAnimations:t.bool,referenceDate:t.any,selectedSections:t.oneOfType([t.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),t.number,t.shape({endIndex:t.number.isRequired,startIndex:t.number.isRequired})]),shouldDisableClock:t.func,shouldDisableTime:t.func,skipDisabled:t.bool,slotProps:t.object,slots:t.object,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object]),thresholdToRenderTimeInASingleColumn:t.number,timeSteps:t.shape({hours:t.number,minutes:t.number,seconds:t.number}),timezone:t.string,value:t.any,view:t.oneOf(["hours","meridiem","minutes","seconds"]),viewRenderers:t.shape({hours:t.func,meridiem:t.func,minutes:t.func,seconds:t.func}),views:t.arrayOf(t.oneOf(["hours","minutes","seconds"]).isRequired)};const _t=u.forwardRef(function(n,a){var s,r,i,d;const m=K(),c=L(),l=vt(n,"MuiMobileTimePicker"),p=f({hours:be,minutes:be,seconds:be},l.viewRenderers),h=(s=l.ampmInClock)!=null?s:!1,x=f({},l,{ampmInClock:h,viewRenderers:p,format:ot(c,l),slots:f({field:mt},l.slots),slotProps:f({},l.slotProps,{field:b=>{var v;return f({},ue((v=l.slotProps)==null?void 0:v.field,b),fe(l),{ref:a})},toolbar:f({hidden:!1,ampmInClock:h},(r=l.slotProps)==null?void 0:r.toolbar)})}),{renderPicker:g}=et({props:x,valueManager:Q,valueType:"time",getOpenDialogAriaText:(i=(d=x.localeText)==null?void 0:d.openTimePickerDialogue)!=null?i:m.openTimePickerDialogue,validator:Ce});return g()});_t.propTypes={ampm:t.bool,ampmInClock:t.bool,autoFocus:t.bool,className:t.string,closeOnSelect:t.bool,components:t.object,componentsProps:t.object,defaultValue:t.any,disabled:t.bool,disableFuture:t.bool,disableIgnoringDatePartForTimeValidation:t.bool,disableOpenPicker:t.bool,disablePast:t.bool,format:t.string,formatDensity:t.oneOf(["dense","spacious"]),inputRef:t.oneOfType([t.func,t.shape({current:t.object})]),label:t.node,localeText:t.object,maxTime:t.any,minTime:t.any,minutesStep:t.number,onAccept:t.func,onChange:t.func,onClose:t.func,onError:t.func,onOpen:t.func,onSelectedSectionsChange:t.func,onViewChange:t.func,open:t.bool,openTo:t.oneOf(["hours","minutes","seconds"]),orientation:t.oneOf(["landscape","portrait"]),readOnly:t.bool,reduceAnimations:t.bool,referenceDate:t.any,selectedSections:t.oneOfType([t.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),t.number,t.shape({endIndex:t.number.isRequired,startIndex:t.number.isRequired})]),shouldDisableClock:t.func,shouldDisableTime:t.func,slotProps:t.object,slots:t.object,sx:t.oneOfType([t.arrayOf(t.oneOfType([t.func,t.object,t.bool])),t.func,t.object]),timezone:t.string,value:t.any,view:t.oneOf(["hours","minutes","seconds"]),viewRenderers:t.shape({hours:t.func,minutes:t.func,seconds:t.func}),views:t.arrayOf(t.oneOf(["hours","minutes","seconds"]).isRequired)};const on=["desktopModeMediaQuery"],nn=u.forwardRef(function(n,a){const s=F({props:n,name:"MuiTimePicker"}),{desktopModeMediaQuery:r=tt}=s,i=k(s,on);return Ye(r,{defaultMatches:!0})?e.jsx(yt,f({ref:a},i)):e.jsx(_t,f({ref:a},i))}),ze={p:.5,"& .MuiCardHeader-action":{m:"auto auto",display:"flex"}},oe=u.forwardRef(({border:o=!0,boxShadow:n,children:a,content:s=!0,contentSX:r={},darkTitle:i,elevation:d,secondary:m,shadow:c,sx:l={},title:p,isDivider:h=!1,codeHighlight:x,cardActions:g,...b},v)=>{const j=pe();return n=j.palette.mode==="dark"?n||!0:n,e.jsxs(Ve,{elevation:d||0,ref:v,...b,sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%",border:o?"1px solid":"none",borderRadius:2,borderColor:j.palette.mode==="dark"?j.palette.divider:j.palette.grey.A800,boxShadow:n&&(!o||j.palette.mode==="dark")?c||j.shadows[10]:"inherit",":hover":{boxShadow:n?c||j.shadows[10]:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:j.typography.fontFamily,fontSize:"0.75rem"},...l},children:[m&&!p&&e.jsx(ae,{sx:ze,action:m}),p&&e.jsx(ae,{sx:ze,title:e.jsx(E,{variant:"h5",children:p}),action:m}),h&&e.jsx(Wt,{}),s&&e.jsx(ve,{sx:{flex:1,padding:.5,...r,"&:last-child":{paddingBottom:.5}},children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"absolute"},children:a})})}),g&&e.jsx(ut,{disableSpacing:!0,sx:{padding:.5},children:g})]})}),sn=({ctrl_id:o})=>{const[n,a]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>(s.current||(s.current=O(`${S}/last_snapshot/${o}`)),s.current.on("last_snapshot",r=>{a(r)}),()=>{s.current&&(s.current.disconnect(),s.current=null)}),[o]),e.jsx(e.Fragment,{children:e.jsxs(oe,{title:"Ultima Foto",children:[n!==null&&e.jsx(_,{component:"img",sx:{height:"100%",width:"100%",overflow:"hidden",borderRadius:"4px"},src:n}),n===null&&e.jsx(_,{component:"div",sx:{width:"100%",height:"100%",display:"grid",placeItems:"center"},children:e.jsx(H,{severity:"info",variant:"outlined",children:"Caputura no disponible"})})]})})},rn=({timePicked:o,datePicked:n,setDatePicked:a,setTimePicked:s})=>e.jsxs(w,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(gt,{value:n,onChange:r=>a(r),slotProps:{textField:{size:"small",sx:{maxWidth:150,"& .MuiOutlinedInput-root":{"& fieldset":{}}}}}}),e.jsx(nn,{views:["hours"],ampm:!1,defaultValue:o,onChange:r=>s(r),slotProps:{textField:{size:"small",sx:{maxWidth:85,"& .MuiOutlinedInput-root":{"& fieldset":{}}}},digitalClockSectionItem:{}}})]}),an=R(({className:o,...n})=>e.jsx(st,{...n,classes:{popper:o}}))(({theme:o})=>({[`& .${rt.tooltip}`]:{backgroundColor:o.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:o.shadows[1],fontSize:11}})),ln=({camaras:o,ctrl_id:n})=>{const a=U(c=>c.stream),s=U(c=>c.controllerSiteState),[r,i]=u.useState(null),d=B(),m=(c,l)=>{if(l!==null&&s.controller!==void 0){const p=o.find(h=>h.ip===l);i(l),p&&d(se({nodo:s.controller.nodo,ip:l,ctrl_id:n,puertows:p.puertows,tipo:p.tipo,cmr_id:p.cmr_id,region:s.controller.region}))}};return u.useEffect(()=>{if(o.length>0&&s.controller!==void 0){const c=a.ip;if(c){const l=o.find(p=>p.ip===c);l?(i(l.ip),d(se({nodo:s.controller.nodo,ip:l.ip,ctrl_id:n,puertows:l.puertows,tipo:l.tipo,cmr_id:l.cmr_id,region:s.controller.region})),d(ge({isSelected:!0}))):(i(o[0].ip),d(se({nodo:s.controller.nodo,ctrl_id:n,ip:o[0].ip,puertows:o[0].puertows,tipo:o[0].tipo,cmr_id:o[0].cmr_id,region:s.controller.region})),d(ge({isSelected:!0})))}else i(o[0].ip),d(se({nodo:s.controller.nodo,ctrl_id:n,ip:o[0].ip,puertows:o[0].puertows,tipo:o[0].tipo,cmr_id:o[0].cmr_id,region:s.controller.region})),d(ge({isSelected:!0}))}},[o]),u.useEffect(()=>()=>{d(It())},[]),e.jsx(e.Fragment,{children:e.jsx(He,{color:"primary",value:r,exclusive:!0,onChange:m,"aria-label":"Cameras",size:"small",children:o.map((c,l)=>e.jsx(re,{value:c.ip,"aria-label":"Camara 1",sx:{padding:0},children:e.jsx(an,{title:c.descripcion,arrow:!0,children:e.jsxs(w,{direction:"row",spacing:1,alignItems:"center",padding:{lg:1,xs:.5},children:[e.jsx(So,{}),e.jsxs("div",{children:["Cam ",l+1]})]})})},c.ip))})})},cn=()=>{const o=U(n=>n.stream);return e.jsx(e.Fragment,{children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"relative"},children:o.ip&&o.ctrl_id>0&&e.jsx(e.Fragment,{children:e.jsx(to,{ctrl_id:o.ctrl_id,ip:o.ip,q:"q1"},o.ctrl_id+o.ip+"q1")})})})},Ct=u.forwardRef(({title:o,count:n,onChangeIndex:a,current_index:s},r)=>{const[i,d]=u.useState(1),m=x=>{d(x.target.value)},c=()=>{a(0)},l=()=>{const x=s-i<0?0:s-i;a(x)},p=()=>{const x=s+i>n-1?n-1:s+i;a(x)},h=()=>{a(n-1)};return e.jsx(_,{component:"div",sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1},ref:r,children:n>=0&&e.jsxs(e.Fragment,{children:[e.jsxs(E,{component:"p",color:"white",sx:{userSelect:"none"},children:[o," :"]}),e.jsxs(Te,{id:"control-select",name:"control-select",value:i,onChange:m,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5,borderColor:"white"}},sx:{color:"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"& .MuiSvgIcon-root":{color:"white"}},children:[e.jsx(N,{value:1,children:1}),e.jsx(N,{value:10,children:10}),e.jsx(N,{value:20,children:20}),e.jsx(N,{value:50,children:50})]}),e.jsx(E,{component:"div",color:"white",sx:{userSelect:"none"},children:`${s+1} de ${n}`}),e.jsxs(_,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(V,{onClick:c,disabled:s===0,"aria-label":"first page",children:e.jsx(oo,{})}),e.jsx(V,{onClick:l,disabled:s===0,"aria-label":"previous page",children:e.jsx(so,{})}),e.jsx(V,{onClick:p,disabled:s===n-1,"aria-label":"next page",children:e.jsx(ro,{})}),e.jsx(V,{onClick:h,disabled:s===n-1,"aria-label":"last page",children:e.jsx(no,{})})]})]})})}),dn=async(o,n)=>{try{const s=await(await fetch(`${S}/api/v1/site/multimedia/download?filePath=${encodeURIComponent(o)}`)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=n,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(a){console.error("Error downloading image:",a)}},un=({slides:o})=>{const[n,a]=u.useState([]),[s,r]=u.useState(0),i=()=>{if(n.length>0&&n[s]){const l=n[s],p=`downloaded-image-${l.fecha}.jpg`;dn(l.ruta,p)}},d=B(),m=l=>{l.currentTarget===l.target&&d(me())},c=l=>{r(l)};return u.useEffect(()=>{a(o),r(0)},[o]),e.jsx(e.Fragment,{children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsxs(_,{sx:{position:"relative",height:"100%",width:"100%"},children:[e.jsx(_,{component:"div",sx:{position:"absolute",bottom:0,left:0,width:"100%",background:"rgba(0, 0, 0, 0.3)",py:1,"&: hover":{}},children:e.jsxs(w,{spacing:1,direction:"row",alignItems:"center",justifyContent:"center",sx:{position:"relative"},onDoubleClickCapture:m,children:[e.jsx(Ct,{title:"N° Fotos",count:n.length,current_index:s,onChangeIndex:c}),e.jsx(V,{"aria-label":"back",sx:{position:"absolute",bottom:"cacl(50% - 23px)",left:10,cursor:"pointer"},onClick:i,children:e.jsx(Do,{sx:{color:"#FD8D14",fontSize:30}})})]})}),n.length>0&&n[s]&&e.jsx(_,{component:"img",sx:{height:"100%",overflow:"hidden",width:"100%",borderRadius:"4px",userSelect:"none"},src:`${S+"/"+n[s].ruta}`,onDoubleClickCapture:m})]})})})},pn="/assets/emptyData-e7a50cc8.svg",Pt=({children:o})=>e.jsxs(w,{spacing:1,alignItems:"center",children:[e.jsx("img",{src:pn,alt:"",width:100}),e.jsx(E,{component:"p",variant:"body1",children:o&&o||"No data"})]}),mn=({data:o})=>{const{cmr_id:n,ctrl_id:a,date:s,hour:r}=o,{isError:i,isSuccess:d,isLoading:m,data:c}=Ne({ctrl_id:a,date:s,hour:r,tipo:0,cmr_id:n}),l=B(),p=h=>{h.currentTarget===h.target&&l(me())};return e.jsxs(_,{sx:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},onDoubleClickCapture:p,children:[m&&e.jsx(Ue,{children:"Cargando Fotos"}),i&&e.jsx(it,{children:"Error no se encontraron imagenes!"}),d&&c.length>0&&e.jsx(un,{slides:c}),d&&c.length==0&&e.jsx(Pt,{children:"No se encontraron fotos."})]})},hn=({slides:o})=>{const[n,a]=u.useState([]),[s,r]=u.useState(0),i=B(),d=p=>{p.currentTarget===p.target&&i(me())},m=p=>{r(p)},c=u.useRef(null),l=u.useMemo(()=>c.current?`calc( 50% - ${c.current.getBoundingClientRect().width*.5}px )`:0,[c.current]);return u.useEffect(()=>{a(o),r(0)},[o]),e.jsx(e.Fragment,{children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsxs(_,{sx:{position:"relative",height:"100%",width:"100%"},children:[n.length>0&&n[s]&&e.jsx(_,{component:"video",sx:{height:"100%",overflow:"hidden",width:"100%",borderRadius:"4px"},controls:!0,src:`${S+"/"+n[s].ruta}`,onDoubleClickCapture:d,onClick:p=>{p.preventDefault(),p.detail==2&&p.stopPropagation()}}),e.jsx(_,{component:"div",sx:{position:"absolute",bottom:"7%",left:l},children:e.jsx(Ct,{ref:c,title:"N° Videos",count:n.length,current_index:s,onChangeIndex:m})})]})})})},xn=({data:o})=>{const{cmr_id:n,ctrl_id:a,date:s,hour:r}=o,{isError:i,isSuccess:d,isLoading:m,data:c}=Ne({ctrl_id:a,date:s,hour:r,tipo:1,cmr_id:n}),l=B(),p=h=>{h.currentTarget===h.target&&l(me())};return e.jsxs(_,{sx:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},onDoubleClickCapture:p,children:[m&&e.jsx(Ue,{children:"Cargando videos"}),i&&e.jsx(it,{children:"Error no se encontraron videos!"}),d&&c.length>0&&e.jsx(hn,{slides:c}),d&&c.length==0&&e.jsx(Pt,{children:"No se encontraron videos."})]})},fn=({option:o,handleChangeOption:n})=>e.jsxs(He,{color:"primary",value:o,exclusive:!0,onChange:n,"aria-label":"Options",size:"small",children:[e.jsx(re,{value:"vivo","aria-label":"Vivo",children:e.jsxs(w,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Io,{}),e.jsx("span",{children:" Vivo"})]})}),e.jsx(re,{value:"video","aria-label":"Video",children:e.jsxs(w,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Mo,{}),e.jsx("span",{children:" Video"})]})}),e.jsx(re,{value:"fotos","aria-label":"Fotos",children:e.jsxs(w,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ko,{}),e.jsx("span",{children:" Fotos"})]})})]});var De={},gn=xe;Object.defineProperty(De,"__esModule",{value:!0});var Tt=De.default=void 0,bn=gn(he()),jn=e,vn=(0,bn.default)((0,jn.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9z"}),"LockRounded");Tt=De.default=vn;var ke={},yn=xe;Object.defineProperty(ke,"__esModule",{value:!0});var wt=ke.default=void 0,_n=yn(he()),Cn=e,Pn=(0,_n.default)((0,Cn.jsx)("path",{d:"M12 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6-5h-1V6c0-2.76-2.24-5-5-5-2.28 0-4.27 1.54-4.84 3.75-.14.54.18 1.08.72 1.22.53.14 1.08-.18 1.22-.72C9.44 3.93 10.63 3 12 3c1.65 0 3 1.35 3 3v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 11c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-8c0-.55.45-1 1-1h10c.55 0 1 .45 1 1v8z"}),"LockOpenRounded");wt=ke.default=Pn;const Tn=o=>{const[n,a]=u.useState(null),[s,r]=u.useState(null),[i,d]=u.useState(null),m=u.useRef(null),[c,l]=u.useState(!1),[p,h]=u.useState(null);return u.useEffect(()=>(o!==void 0&&(m.current||(m.current=O(`${S}/controller_state/${o}`)),m.current.on("controller_info",x=>{const{modo:g,seguridad:b,conectado:v}=x;r(g),a(b),d(v)}),m.current.on("update_controller",x=>{const{conectado:g,modo:b,seguridad:v}=x;d(j=>g!==j?g:j),r(j=>b!==j?b:j),a(j=>v!==j?v:j)}),m.current.on("connect_error",x=>{l(!0),h(x.message)})),()=>{m.current&&(m.current.disconnect(),m.current=null),a(null),r(null),l(!1),h(null),d(null)}),[o]),{isError:c,error:p,socket:m,mode:s,security:n,connected:i}},wn=R(({className:o,...n})=>e.jsx(st,{...n,classes:{popper:o}}))(({theme:o})=>({[`& .${rt.tooltip}`]:{backgroundColor:o.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:o.shadows[3],fontSize:11}})),Sn=({ctrl_id:o})=>{const{mode:n,security:a,socket:s}=Tn(o),r=()=>{s.current&&(a===Z.Armado?s.current.emit("setSecurity",Z.Desarmado):s.current.emit("setSecurity",Z.Armado))};return e.jsx(e.Fragment,{children:n===$t.Seguridad&&e.jsx(wn,{title:a===Z.Armado?"Armado":"Desarmado",placement:"left",children:e.jsx(V,{onClick:r,children:a===Z.Armado?e.jsx(Tt,{}):e.jsx(wt,{})})})})};var Re={},Dn=xe;Object.defineProperty(Re,"__esModule",{value:!0});var St=Re.default=void 0,kn=Dn(he()),Rn=e,Mn=(0,kn.default)((0,Rn.jsx)("path",{d:"M8.54 8.54c.35.35.37.88.1 1.29C8.24 10.45 8 11.2 8 12c0 .8.24 1.55.64 2.17.27.41.24.95-.11 1.29-.43.43-1.17.4-1.51-.11C6.38 14.4 6 13.24 6 12c0-1.21.36-2.33.97-3.28.36-.54 1.11-.64 1.57-.18zm6.92 6.92c.43.43 1.17.4 1.51-.11C17.62 14.4 18 13.24 18 12c0-1.24-.38-2.4-1.03-3.36-.34-.5-1.08-.54-1.51-.11-.35.35-.37.88-.11 1.29.41.63.65 1.38.65 2.18 0 .8-.24 1.55-.64 2.17-.27.41-.24.95.1 1.29zM12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6.32 8.32c.42.42 1.12.39 1.5-.08C21.18 16.53 22 14.36 22 12s-.82-4.53-2.18-6.24c-.37-.47-1.07-.5-1.5-.08-.36.36-.4.92-.08 1.32 1.1 1.37 1.76 3.11 1.76 5s-.66 3.63-1.76 5c-.32.39-.28.96.08 1.32zM5.68 5.68c-.42-.42-1.12-.39-1.5.08C2.82 7.47 2 9.64 2 12s.82 4.53 2.18 6.24c.37.47 1.07.5 1.5.08.36-.36.4-.92.08-1.32C4.66 15.63 4 13.89 4 12s.66-3.63 1.76-5c.32-.39.28-.96-.08-1.32z"}),"SensorsRounded");St=Re.default=Mn;var Me={},In=xe;Object.defineProperty(Me,"__esModule",{value:!0});var Dt=Me.default=void 0,$n=In(he()),Fn=e,On=(0,$n.default)((0,Fn.jsx)("path",{d:"M5.68 18.32c-.42.42-1.12.39-1.5-.08C2.82 16.53 2 14.36 2 12c0-2.04.61-3.93 1.66-5.51L2.1 4.93a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0l16.97 16.97c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0L8.14 10.96c-.09.33-.14.68-.14 1.04 0 .8.24 1.55.64 2.17.27.41.24.94-.1 1.29-.43.43-1.17.4-1.51-.11C6.38 14.4 6 13.24 6 12c0-.93.21-1.8.58-2.59L5.11 7.94C4.4 9.13 4 10.52 4 12c0 1.89.66 3.63 1.76 5 .32.39.28.96-.08 1.32zm9.78-9.78c-.35.35-.37.88-.11 1.29.41.62.65 1.37.65 2.17 0 .36-.05.71-.14 1.04l1.55 1.55c.38-.79.59-1.66.59-2.59 0-1.24-.38-2.4-1.03-3.36-.34-.5-1.07-.54-1.51-.1zm2.86-2.86c-.36.36-.4.92-.08 1.32 1.1 1.37 1.76 3.11 1.76 5 0 1.48-.4 2.87-1.11 4.06l1.45 1.45C21.39 15.93 22 14.04 22 12c0-2.36-.82-4.53-2.18-6.24-.38-.47-1.08-.5-1.5-.08z"}),"SensorsOffRounded");Dt=Me.default=On;const Ln=()=>{const o=U(n=>n.controllerSiteState);return e.jsx(e.Fragment,{children:e.jsx(w,{direction:"row",spacing:1,alignItems:"center",children:o.controller!==void 0&&(o.controller.conectado===Ft.Conectado?e.jsxs(e.Fragment,{children:[e.jsx(St,{color:"success",fontSize:"large"}),e.jsx(E,{children:"Conectado"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{color:"error",fontSize:"large"}),e.jsx(E,{children:"Desconectado"})]}))})})},zn=({ctrl_id:o})=>{const n=U(g=>g.stream),{isError:a,isSuccess:s,data:r}=Ot({ctrl_id:o},{refetchOnMountOrArgChange:!0}),[i,d]=u.useState("vivo"),m=(g,b)=>{b!==null&&d(b)},[c,l]=u.useState(T()),[p,h]=u.useState(T()),x=u.useRef(null);return e.jsxs(Lt,{children:[e.jsx(ae,{ref:x,sx:{p:.5,"& .MuiCardHeader-action":{m:"auto auto",display:"flex"},overflow:"auto",margin:0},title:e.jsx(Ln,{}),action:e.jsx("div",{style:{width:"100%",height:"100%"},children:e.jsxs(w,{direction:"row",spacing:2,alignItems:"center",children:[(i==="fotos"||i==="video")&&e.jsx(rn,{timePicked:p,datePicked:c,setDatePicked:l,setTimePicked:h}),s&&r.length>0&&e.jsx(ln,{camaras:r,ctrl_id:o}),a&&e.jsx(H,{variant:"filled",severity:"error",children:"Error al cargar camaras."})]})})}),e.jsxs(ve,{sx:{flex:1,padding:.5,"&:last-child":{paddingBottom:.5}},children:[i==="vivo"&&n.ip&&n.ctrl_id&&s&&r.length>0&&e.jsx(cn,{},n.ctrl_id+n.cmr_id+n.ip),i==="fotos"&&e.jsx(mn,{data:{cmr_id:n.cmr_id,ctrl_id:n.ctrl_id,date:c.format("YYYY-MM-DD"),hour:Number(p.format("HH"))}},n.ctrl_id+n.cmr_id),i==="video"&&e.jsx(xn,{data:{cmr_id:n.cmr_id,ctrl_id:n.ctrl_id,date:c.format("YYYY-MM-DD"),hour:Number(p.format("HH"))}},n.ctrl_id+n.cmr_id)]}),e.jsx(ut,{disableSpacing:!0,sx:{padding:.5},children:e.jsxs(w,{width:"100%",direction:"row",alignItems:"center",spacing:2,justifyContent:"space-between",children:[e.jsx(fn,{option:i,handleChangeOption:m}),e.jsx(Sn,{ctrl_id:o})]})})]})},kt="/assets/Lead_Light_Icon-1d1b19d6.svg",je="/assets/Green_Light_Icon-460ad5bb.svg",An="/assets/Red_Light_Icon-89e4b93d.svg",En=({ctrl_id:o})=>{const[n,a]=u.useState([]),s=u.useRef(null),r=pe(),[i,d]=u.useState(1),[m,c]=u.useState(0);return u.useEffect(()=>(s.current||(s.current=O(`${S}/pin_entrada/${o}`)),s.current.on("list_pines_entrada",l=>{a(l)}),s.current.on("controller_mode",l=>{d(l)}),s.current.on("controller_security",l=>{c(l)}),s.current.on("item_pin_entrada",l=>{a(p=>{if(l.activo==1){const h=p.filter(x=>x.pe_id!=l.pe_id);return h.unshift(l),h}return p})}),()=>{s.current&&(s.current.disconnect(),s.current=null)}),[o]),e.jsx(e.Fragment,{children:e.jsxs(Ve,{sx:{display:"flex",flexDirection:"column",height:"100%",width:"100%",border:i===1?"2px solid":"1px solid",borderRadius:2,backgroundImage:"inherit",borderColor:i===1?m===1?"green":"darkgray":r.palette.mode==="dark"?r.palette.divider:r.palette.grey.A800,boxShadow:"inherit",":hover":{boxShadow:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:r.typography.fontFamily,fontSize:"0.75rem"}},children:[e.jsx(ae,{title:"Site",sx:{p:.5,"& .MuiCardHeader-action":{m:"auto auto",display:"flex"}}}),e.jsx(ve,{sx:{flex:1,padding:.5,"&:last-child":{paddingBottom:.5}},children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(_,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(ne,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsxs(y,{container:!0,rowSpacing:1,columnSpacing:2,children:[n.length===0&&e.jsx(y,{item:!0,xs:12,sx:{display:"grid",placeItems:"center"},children:e.jsx(H,{severity:"warning",variant:"outlined",children:"Asignar al menos un pin de entrada"})}),n.map((l,p,h)=>{const x=e.jsxs(w,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[e.jsx("div",{children:ye(l.descripcion,20)}),i===1?l.estado==1?e.jsx("img",{src:An,alt:"Green Indicator"}):e.jsx("img",{src:je,alt:"Lead Indicator"}):l.estado==1?e.jsx("img",{src:je,alt:"Green Indicator"}):e.jsx("img",{src:kt,alt:"Lead Indicator"})]});return h.length==1?e.jsxs(u.Fragment,{children:[e.jsx(y,{item:!0,xs:3}),e.jsx(y,{item:!0,xs:6,children:x}),e.jsx(y,{item:!0,xs:3})]},l.ctrl_id+l.pe_id):e.jsx(y,{item:!0,lg:6,xs:12,children:x},l.ctrl_id+l.pe_id)})]})})})})})]})})},Yn=R(lt)(({theme:o})=>({border:"1px solid",borderRadius:2,borderColor:o.palette.mode==="dark"?o.palette.divider:o.palette.grey.A800,backgroundColor:o.palette.background.paper,boxShadow:" rgba(0, 0, 0, 0.2) 0px 2px 1px -1px, rgba(0, 0, 0, 0.14) 0px 1px 1px 0px, rgba(0, 0, 0, 0.12) 0px 1px 3px 0px",backgroundImage:o.palette.mode==="dark"?"linear-gradient(rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.05))":"none"})),Vn=({ctrl_id:o})=>{const[n,a]=u.useState([]),s=u.useRef(null);return u.useEffect(()=>(s.current||(s.current=O(`${S}/modulo_energia/${o}`)),s.current.on("initial_list_energia",r=>{a(r)}),s.current.on("list_energia",(r,i)=>{i==="add"&&a(d=>d.some(c=>c.me_id===r.me_id)?d:[...d,r].sort((p,h)=>p.me_id-h.me_id)),i==="delete"&&a(d=>d.filter(c=>c.me_id!==r.me_id))}),()=>{s.current&&(s.current.disconnect(),s.current=null)}),[o]),e.jsx(e.Fragment,{children:e.jsxs(_,{component:"div",sx:{width:"100%",height:"100%",display:"grid",placeItems:"center"},children:[n.length===0&&e.jsx(H,{severity:"warning",variant:"outlined",children:"Asignar al menos un modulo de energia"}),n.length>0&&e.jsx(ct,{component:dt,variant:"outlined",sx:{height:"100%",width:"100%",overflowY:"auto"},children:e.jsx(ne,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsxs(Yn,{"aria-label":"customized table",stickyHeader:!0,size:"small",sx:{position:"relative"},children:[e.jsx(we,{children:e.jsxs(G,{children:[e.jsx(C,{children:"N°"}),e.jsx(C,{children:"Amp (A)"}),e.jsx(C,{children:"Volt (V)"}),e.jsx(C,{children:"Pot (W)"}),e.jsx(C,{children:"kWh"})]})}),e.jsx(Se,{children:s.current!==null&&n.map((r,i)=>s.current!==null?e.jsx(Hn,{index:i,dataEnergia:r,socket:s.current},r.ctrl_id+r.me_id):null)})]})})})]})})},Hn=({dataEnergia:o,index:n,socket:a})=>{const[s,r]=u.useState(o);return a.on("energia",i=>{i.me_id===o.me_id&&r(i)}),e.jsxs(G,{children:[e.jsx(C,{component:"th",scope:"row",children:n+1}),e.jsx(C,{children:s.amperaje}),e.jsx(C,{children:s.voltaje}),e.jsx(C,{children:s.potenciaw}),e.jsx(C,{children:s.potenciakwh})]})},Nn=({date:o,registerData:n,info:a})=>{const[s,r]=u.useState({configs:{chart:{height:350,type:"line",zoom:{enabled:!1},background:"#121212",id:"temperature-graph-chart",toolbar:{show:!0,export:{png:{filename:`grafica_temperatura_${encodeURIComponent(a.nodo)}_${encodeURIComponent(a.st_id)}_${encodeURIComponent(a.ubicacion)}_${encodeURIComponent(T(o,"YYYY-MM-DD").unix())}`},svg:{filename:`grafica_temperatura_${encodeURIComponent(a.nodo)}_${encodeURIComponent(a.st_id)}_${encodeURIComponent(a.ubicacion)}_${encodeURIComponent(T(o,"YYYY-MM-DD").unix())}`}}}},dataLabels:{enabled:!1},stroke:{curve:"straight"},grid:{row:{colors:["#1e1e1e","transparent"],opacity:.5}},xaxis:{type:"datetime",tickAmount:24,min:new Date(T(o,"YYYY-MM-DD").startOf("day").toISOString()).getTime(),max:new Date(T(o,"YYYY-MM-DD").add(1,"day").startOf("day").toISOString()).getTime(),labels:{formatter:function(l,p){return T(p).format("HH:mm")},style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}},title:{text:"Tiempo ( h )",style:{color:"#8c8c8c"}},tooltip:{enabled:!1,formatter:(l,p)=>T(l).format("HH:mm:ss")}},yaxis:{min:0,decimalsInFloat:2,title:{text:"Temperatura ( °C )",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!0,x:{show:!0,formatter(l,p){return T(l).format("HH:mm:ss")}},y:{}}}}),i=pe(),d=i.palette.mode,[m,c]=u.useState([]);return u.useEffect(()=>{r(l=>{const p=d=="dark"?i.palette.text.secondary:i.palette.text.primary;return{configs:{...l.configs,chart:{...l.configs.chart,background:i.palette.background.default},grid:{row:{colors:[i.palette.background.paper,"transparent"],opacity:.5}},xaxis:{...l.configs.xaxis,labels:{...l.configs.xaxis?l.configs.xaxis.labels:{},style:{...l.configs.xaxis&&l.configs.xaxis.labels?l.configs.xaxis.labels.style:{},colors:p,cssClass:"apexcharts-xaxis-label"}},title:{...l.configs.xaxis?l.configs.xaxis.title:{},style:{color:p}}},yaxis:{...l.configs.yaxis,title:{text:"Temperatura ( °C )",style:{color:p}},labels:{style:{colors:p,cssClass:"apexcharts-yaxis-label"}}}}}})},[d]),u.useEffect(()=>{c([{name:"temperatura",data:n}]),r(l=>({configs:{...l.configs,xaxis:{...l.configs.xaxis,min:new Date(T(o,"YYYY-MM-DD").startOf("day").toISOString()).getTime(),max:new Date(T(o,"YYYY-MM-DD").add(1,"day").startOf("day").toISOString()).getTime()}}}))},[n]),u.useEffect(()=>{r(l=>({configs:{...l.configs,chart:{...l.configs.chart,toolbar:{show:!1,export:{png:{filename:`grafica_temperatura_${encodeURIComponent(a.nodo)}_${encodeURIComponent(a.st_id)}_${encodeURIComponent(a.ubicacion)}_${encodeURIComponent(T(o,"YYYY-MM-DD").unix())}`},svg:{filename:`grafica_temperatura_${encodeURIComponent(a.nodo)}_${encodeURIComponent(a.st_id)}_${encodeURIComponent(a.ubicacion)}_${encodeURIComponent(T(o,"YYYY-MM-DD").unix())}`}}}}}}))},[a,o]),e.jsx(e.Fragment,{children:e.jsx(io,{options:s.configs,series:m,type:"line",width:"100%",height:500})})};function Un(o,n){const a=ApexCharts.getChartByID(o);a&&(n==="png"?a.exports.exportToPng():n==="svg"&&a.exports.exportToSVG())}const Bn=({open:o,setOpen:n,data:a})=>{const[s,r]=u.useState(T()),{nodo:i,ctrl_id:d,st_id:m,serie:c,ubicacion:l}=a,p=()=>{n(!1)},h=u.useRef(null);u.useEffect(()=>(o?h.current||(h.current=O(`${S}/sensor_temperatura/${d}/${m}`)):h.current&&(h.current.disconnect(),h.current=null),()=>{h.current&&(h.current.disconnect(),h.current=null)}),[o,a]);const[x,{data:g,isSuccess:b}]=zt(),v=()=>{x({ctrl_id:d,st_id:m,date:s.format("YYYY-MM-DD")})};return e.jsx(e.Fragment,{children:e.jsxs(lo,{fullWidth:!0,maxWidth:"lg",open:o,onClose:p,sx:{"& .MuiDialog-paper":{backgroundColor:"background.paper",backgroundImage:"inherit"}},children:[e.jsx(po,{children:e.jsx(E,{component:"div",variant:"h5",children:"Gráfica Temperatura"})}),e.jsxs(co,{children:[e.jsxs(wo,{children:["Nodo: ",i," , Ubicacion: ",l," , Serie: ",c]}),e.jsxs(w,{direction:"row",justifyContent:"end",alignItems:"center",spacing:2,marginBottom:2,children:[e.jsx(gt,{value:s,onChange:j=>{r(j)},slotProps:{textField:{size:"small",sx:{maxWidth:150}}}}),e.jsx(V,{"aria-label":"get register",onClick:v,color:"primary",children:e.jsx(mo,{})})]}),e.jsx(Nn,{date:s.format("YYYY-MM-DD"),registerData:b&&g?g:[],info:a})]}),e.jsxs(uo,{children:[e.jsx(Le,{variant:"contained",onClick:()=>{Un("temperature-graph-chart","png")},startIcon:e.jsx(ao,{}),children:"Descargar"}),e.jsx(Le,{variant:"contained",color:"error",onClick:p,children:"Cerrar"})]})]})})},qn=({ctrl_id:o})=>e.jsx(e.Fragment,{children:e.jsx(_,{sx:{width:"100%",height:"100%"},children:e.jsx(ne,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsx(Gn,{ctrl_id:Number(o)})})})}),Gn=({ctrl_id:o})=>{const{xregion:n,xnodo:a}=Be(),[s,r]=u.useState([]),i=u.useRef(null),[d,m]=u.useState(!1),[c,l]=u.useState(null),p=h=>{l(h),m(!0)};return u.useEffect(()=>(i.current||(i.current=O(`${S}/sensor_temperatura/${o}`)),i.current.on("initial_list_temperature",h=>{r(h)}),i.current.on("list_temperature",(h,x)=>{x==="add"&&r(g=>g.some(v=>v.st_id===h.st_id)?g:[...g,h].sort((M,P)=>M.st_id-P.st_id)),x==="delete"&&r(g=>g.filter(v=>v.st_id!==h.st_id))}),()=>{i.current&&(i.current.disconnect(),i.current=null)}),[o]),e.jsxs(e.Fragment,{children:[e.jsxs(y,{container:!0,rowSpacing:1,columnSpacing:2,children:[s.length===0&&e.jsx(y,{item:!0,xs:12,sx:{display:"grid",placeItems:"center"},children:e.jsx(H,{severity:"warning",variant:"outlined",children:"Asignar al menos un sensor de temperatura"})}),i.current!==null&&s.map((h,x,g)=>{if(i.current===null)return null;const b=e.jsxs(w,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[e.jsx(Wn,{dataViewer:h,socket:i.current}),e.jsx(V,{size:"small","aria-label":"Temperature Graph",color:"primary",onClick:()=>p({...h,nodo:a,region:n,ctrl_id:o}),children:e.jsx(Ro,{fontSize:"small"})})]});return g.length==1?e.jsxs(u.Fragment,{children:[e.jsx(y,{item:!0,xs:3}),e.jsx(y,{item:!0,xs:6,children:b}),e.jsx(y,{item:!0,xs:3})]},h.ctrl_id+h.st_id):e.jsx(y,{item:!0,lg:6,xs:12,children:b},h.ctrl_id+h.st_id)})]}),c&&d&&e.jsx(Bn,{open:d,setOpen:m,data:c})]})},Wn=({dataViewer:o,socket:n})=>{const[a,s]=u.useState(o);return n.on("temperature",r=>{o.st_id===r.st_id&&s(r)}),e.jsx(e.Fragment,{children:e.jsxs(w,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",sx:{flex:1},children:[e.jsx("span",{children:`${ye(a.ubicacion,15)}:`}),e.jsxs(_,{children:[a.actual,"°C"]})]})})},Qn=({ctrl_id:o,region:n})=>{const a=At(),s=B(),[r,i]=u.useState("accesos"),d=m=>{i(m.target.value)};return e.jsx(oe,{title:e.jsxs(Te,{size:"small",value:r,onChange:d,placeholder:"select-tipo-prioridad",inputProps:{id:"select-prioridad"},children:[e.jsx(N,{value:"accesos",children:"Accesos"}),e.jsx(N,{value:"alarmas",children:"Alarmas"})]}),secondary:e.jsx(ho,{component:"button",underline:"none",onClick:()=>{console.log("Setting",n,o),s(Et(n)),s(Yt(o)),s(Vt(r=="accesos"?"acceso":"entrada")),s(Ht(T().startOf("day").format("YYYY-MM-DD HH:mm:ss"))),s(Nt(T().endOf("day").format("YYYY-MM-DD HH:mm:ss"))),a("/logs")},children:"Ver Mas"}),children:e.jsx(ct,{component:dt,variant:"outlined",sx:{height:"100%",width:"100%",overflowY:"auto"},children:e.jsxs(ne,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:[r=="accesos"&&e.jsx(Kn,{ctrl_id:o}),r=="alarmas"&&e.jsx(Xn,{ctrl_id:o})]})})})},Rt=R(lt)(({theme:o})=>({border:"1px solid",borderRadius:2,borderColor:o.palette.mode==="dark"?o.palette.divider:o.palette.grey.A800,backgroundColor:o.palette.background.paper,boxShadow:" rgba(0, 0, 0, 0.2) 0px 2px 1px -1px, rgba(0, 0, 0, 0.14) 0px 1px 1px 0px, rgba(0, 0, 0, 0.12) 0px 1px 3px 0px",backgroundImage:o.palette.mode==="dark"?"linear-gradient(rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.05))":"none"})),Kn=({ctrl_id:o})=>{const[n,a]=u.useState([]),s=u.useRef(null);return u.useEffect(()=>(s.current||(s.current=O(`${S}/registro_acceso/${o}`)),s.current.on("list_registros_acceso",r=>{a(r)}),s.current.on("new_registro_acceso",r=>{a(i=>{const d=[r,...i];return d.length>5&&d.splice(5),d})}),()=>{s.current&&(s.current.disconnect(),s.current=null)}),[o]),e.jsxs(e.Fragment,{children:[n.length===0&&e.jsx(H,{severity:"info",variant:"outlined",children:"Sin registros de acceso."}),n.length>0&&e.jsxs(Rt,{size:"small","aria-label":"a dense table",stickyHeader:!0,sx:{position:"relative"},children:[e.jsx(we,{children:e.jsxs(G,{children:[e.jsx(C,{children:"Contrata"}),e.jsx(C,{children:"Autorización"}),e.jsx(C,{children:"Fecha"})]})}),e.jsx(Se,{children:n.map((r,i)=>{const{autorizacion:d,fecha:m,contrata:c}=r,l=at(m);return e.jsxs(G,{children:[e.jsx(C,{children:c?e.jsx(eo,{text:c,maxLength:15,insertDots:!0}):"sin-contrata"}),e.jsx(C,{children:d==1?"Autorizado":d==0?"Denegado":d}),e.jsx(C,{children:l})]},i)})})]})]})},Xn=({ctrl_id:o})=>{const[n,a]=u.useState([]),s=u.useRef(null);return u.useEffect(()=>(s.current||(s.current=O(`${S}/registro_entrada/${o}`)),s.current.on("list_registros_entrada",r=>{a(r)}),s.current.on("new_registro_entrada",r=>{a(i=>{const d=[r,...i];return d.length>5&&d.splice(5),d})}),()=>{s.current&&(s.current.disconnect(),s.current=null)}),[o]),e.jsxs(e.Fragment,{children:[n.length===0&&e.jsx(H,{severity:"info",variant:"outlined",children:"Sin registros de alarma."}),n.length>0&&e.jsxs(Rt,{size:"small","aria-label":"a dense table",stickyHeader:!0,sx:{position:"relative"},children:[e.jsx(we,{children:e.jsxs(G,{children:[e.jsx(C,{children:"Pin"}),e.jsx(C,{children:"Estado"}),e.jsx(C,{children:"Fecha"})]})}),e.jsx(Se,{children:n.map((r,i)=>{const{pin:d,estado:m,fecha:c}=r,l=at(c);return e.jsxs(G,{children:[e.jsx(C,{children:d}),e.jsx(C,{children:m==0?"Desactivado":m==1?"Activado":m}),e.jsx(C,{children:l})]},i)})})]})]})};const Zn=({ctrl_id:o})=>{const n=u.useRef(null),[a,s]=u.useState([]),[r,i]=u.useState(""),d=a.find(c=>String(c.es_id)==r),m=c=>{i(c.target.value)};return u.useEffect(()=>{a.length>0&&r==""&&i(String(a[0].es_id)),a.find(l=>String(l.es_id)==r)==null&&(a.length>0?i(String(a[0].es_id)):i(""))},[a]),u.useEffect(()=>(n.current||(n.current=O(`${S}/pines_salida/${o}`)),n.current.on("equipos_salida",c=>{s(c)}),n.current.on("list_pines_salida",(c,l)=>{s(p=>p.find(({es_id:x})=>x===l.es_id)===void 0?[l,...p].sort((g,b)=>g.es_id-b.es_id):p)}),()=>{n.current&&(n.current.disconnect(),n.current=null)}),[o]),e.jsx(e.Fragment,{children:e.jsx(oe,{title:"Control",secondary:e.jsx(xo,{size:"small",sx:{maxWidth:200},children:a.length>0&&e.jsx(Te,{id:"control-select",name:"control-select",value:r,onChange:m,size:"small",inputProps:{"aria-label":"Select Control"},children:a.map(c=>e.jsx(N,{value:c.es_id,children:c.actuador},c.es_id))})}),children:e.jsxs(_,{sx:{width:"100%",height:"100%",position:"relative"},children:[a.length===0&&e.jsx(_,{component:"div",sx:{width:"100%",height:"100%",display:"grid",placeItems:"center"},children:e.jsx(H,{severity:"warning",variant:"outlined",children:"Asignar al menos un pin de salida"})}),d&&n.current&&e.jsx(Jn,{ctrl_id:o,equipo_salida:d,socketRef:n.current},d.es_id)]})})})},Jn=({equipo_salida:o,socketRef:n})=>{const[a,s]=u.useState([]);return n.on("list_pines_salida",(r,i)=>{o.es_id==i.es_id&&s(r)}),u.useEffect(()=>{n.emit("initial_list_pines_salida",o.es_id)},[o.es_id]),e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"100%",width:"100%",position:"absolute",top:0,left:0},children:e.jsx(ne,{sx:{width:"100%",height:"100%","& .simplebar-content":{width:"100%",height:"100%",display:"grid",placeItems:"center"}},children:e.jsx("div",{className:"grid-container-pinsal-list",children:a.map(r=>e.jsx(es,{pinSalItem:r,socketRef:n},r.ps_id))})})})})},es=({pinSalItem:o,socketRef:n})=>{const[a,s]=u.useState(o);return u.useEffect(()=>{n.emit("initial_item_pin_salida",o.es_id,o.ps_id),n.on("item_pin_salida",r=>{o.ps_id==r.ps_id&&s(r)})},[o.ps_id]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid-item-pinsal",children:[e.jsx("span",{children:`${ye(a.descripcion,20)}:`}),a.es_id===21&&e.jsxs(e.Fragment,{children:[a.estado===1&&e.jsx("img",{src:je,alt:"Green Indicator"}),a.estado===0&&e.jsx("img",{src:kt,alt:"Lead Indicator"})]}),a.es_id!==21&&e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:"button_item",onClick:()=>{const{ctrl_id:r,pin:i,es_id:d}=a;n.emit("orden_pin_salida",{action:0,ctrl_id:r,es_id:d,pin:i})},style:{backgroundColor:a.orden==0?"#d9d9d9":"transparent",color:a.orden==0?"black":"#1668dc"},children:"A"}),e.jsx("button",{className:"button_item",onClick:()=>{const{ctrl_id:r,pin:i,es_id:d}=a;n.emit("orden_pin_salida",{action:1,ctrl_id:r,es_id:d,pin:i})},style:{backgroundColor:a.orden==1?"#49aa19":"transparent",color:a.orden==1?"white":"#1668dc"},children:"ON"}),e.jsx("button",{className:"button_item",onClick:()=>{const{ctrl_id:r,pin:i,es_id:d}=a;n.emit("orden_pin_salida",{action:-1,ctrl_id:r,es_id:d,pin:i})},style:{backgroundColor:a.orden==-1?"#a61d24":"transparent",color:a.orden==-1?"white":"#1668dc"},children:"OFF"})]})]})})},Ps=()=>{const{xctrl_id:o}=Be(),n=B(),a=u.useRef(null),s=U(i=>i.multimediaSlice),r=U(i=>i.controllerSiteState);return u.useEffect(()=>(o!==void 0&&(n(Ut({openItem:[`nodo-${o}`]})),a.current||(a.current=O(`${S}/controller_state/${o}`)),a.current.on("controller_info",i=>{n(Ie(i))}),a.current.on("update_region",i=>{console.log("update_region SITE",i),n(Bt(i))}),a.current.on("update_controller",i=>{n(Ie(i))}),a.current.on("error_message",i=>{n($e(i.message))}),a.current.on("connect",()=>{n(qt())}),a.current.on("connect_error",i=>{n($e(`Socket connect error: ${i.message}`))})),()=>{a.current&&(a.current.disconnect(),a.current=null),n(Gt())}),[o]),e.jsxs(_,{sx:{width:"100%",height:"100%",padding:1,overflowY:"auto"},children:[r.isError&&e.jsx("div",{children:r.error??"Ocurrio un error al obtener el controlador"}),r.isSuccess&&r.controller!==void 0&&e.jsx(y,{container:!0,sx:{width:"100%",height:"100%",overflowY:"auto",margin:0,padding:0},rowGap:1,children:e.jsxs(e.Fragment,{children:[e.jsx(y,{item:!0,xs:12,sx:{height:s.isExpandMultimedia?"100%":"calc(66.7% - 4px)"},children:e.jsxs(y,{container:!0,columnSpacing:1,sx:{height:"100%"},children:[e.jsx(y,{item:!0,xs:s.isExpandMultimedia?12:8,children:e.jsx(zn,{ctrl_id:r.controller.ctrl_id})}),!s.isExpandMultimedia&&e.jsx(y,{item:!0,xs:4,children:e.jsxs(y,{container:!0,sx:{width:"100%",height:"100%","& .MuiGrid-item":{padding:0,gap:0}},gap:1,children:[e.jsx(y,{item:!0,xs:12,children:e.jsx(oe,{title:"Temperaturas",children:e.jsx(qn,{ctrl_id:r.controller.ctrl_id})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(oe,{title:"Energia",children:e.jsx(Vn,{ctrl_id:r.controller.ctrl_id})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(Zn,{ctrl_id:r.controller.ctrl_id})})]})})]})}),!s.isExpandMultimedia&&e.jsx(y,{item:!0,xs:12,sx:{height:"calc(33.3% - 4px)"},children:e.jsxs(y,{container:!0,columnSpacing:1,sx:{height:"100%"},children:[e.jsx(y,{item:!0,xs:4,children:e.jsx(sn,{ctrl_id:r.controller.ctrl_id})}),e.jsx(y,{item:!0,xs:4,children:e.jsx(Qn,{ctrl_id:r.controller.ctrl_id,region:r.controller.region})}),e.jsx(y,{item:!0,xs:4,children:e.jsx(En,{ctrl_id:r.controller.ctrl_id})})]})})]})},r.controller.ctrl_id)]})};export{Ps as NodoSite,Ps as default};
