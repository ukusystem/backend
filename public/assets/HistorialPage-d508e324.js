import{g as Ue,a as Me,s as Ne,m as He,aJ as We,r as f,b as Ve,bD as qe,j as e,e as Je,aI as _,f as Qe,W as N,X as H,l as Ze,bE as Ke,bF as Xe,ar as te,B as re,n as i,as as oe,I as P,aQ as $e,G as d,S as q,aC as J,H as x,Z as Q,$ as le,a0 as de,a6 as ce,bG as Ye,bH as et,D as ne,bI as tt,bJ as rt,h as ot}from"./index-2aa97167.js";import{d as it,a as nt,T as st}from"./KeyboardArrowUp-c63d7c20.js";import{d as ie}from"./CloseRounded-ce907df4.js";import{a as ke,P as Re,b as Be,c as Se,d as X,T as h,e as _e}from"./PaperTable-3dd23fb2.js";import{g as Z}from"./getFormattedDateTime-9ada5b77.js";import{S as at,s as we}from"./ServerError-6c990cf9.js";import{d as V}from"./DownloadRounded-ec5febc1.js";import{d as lt}from"./Close-94d0f31f.js";import{C as dt,d as ct}from"./ChooseFiles-961b2041.js";import{D as pt,a as ut}from"./DialogContent-ccb06683.js";import{D as ht}from"./DialogTitle-b5d13699.js";import{C as K}from"./CardHeader-8cdd451d.js";import{D as T}from"./Divider-4f56bf6e.js";import{T as pe}from"./Tooltip-8c9f6e8a.js";import{a as xt,b as mt,B as D}from"./Button-6990c5cc.js";import{P as jt}from"./Popover-06eef5be.js";import{A as ze}from"./Alert-bc05309a.js";import{C as A}from"./Chip-55d32625.js";import{S as vt}from"./Select-58060dc8.js";import{M as ue}from"./MenuItem-40bd3874.js";import"./LastPage-547da72b.js";import"./InputLabel-8c6a21f8.js";function gt(t){return Me("MuiButtonGroup",t)}const ft=Ue("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),a=ft,bt=(t,n)=>{const{ownerState:r}=t;return[{[`& .${a.grouped}`]:n.grouped},{[`& .${a.grouped}`]:n[`grouped${_(r.orientation)}`]},{[`& .${a.grouped}`]:n[`grouped${_(r.variant)}`]},{[`& .${a.grouped}`]:n[`grouped${_(r.variant)}${_(r.orientation)}`]},{[`& .${a.grouped}`]:n[`grouped${_(r.variant)}${_(r.color)}`]},{[`& .${a.firstButton}`]:n.firstButton},{[`& .${a.lastButton}`]:n.lastButton},{[`& .${a.middleButton}`]:n.middleButton},n.root,n[r.variant],r.disableElevation===!0&&n.disableElevation,r.fullWidth&&n.fullWidth,r.orientation==="vertical"&&n.vertical]},Ct=t=>{const{classes:n,color:r,disabled:u,disableElevation:c,fullWidth:s,orientation:o,variant:m}=t,$={root:["root",m,o,s&&"fullWidth",c&&"disableElevation",`color${_(r)}`],grouped:["grouped",`grouped${_(o)}`,`grouped${_(m)}`,`grouped${_(m)}${_(o)}`,`grouped${_(m)}${_(r)}`,u&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return Qe($,gt,n)},yt=Ne("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:bt})(He(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${a.lastButton},& .${a.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${a.lastButton},& .${a.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${a.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${a.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(([,n])=>n&&n.main).flatMap(([n])=>[{props:{variant:"text",color:n},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / 0.5)`:We(t.palette[n].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${a.lastButton},& .${a.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${a.lastButton},& .${a.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${a.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${a.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(([,n])=>n&&n.dark).map(([n])=>({props:{variant:"contained",color:n},style:{[`& .${a.firstButton},& .${a.middleButton}`]:{borderColor:(t.vars||t).palette[n].dark}}}))],[`& .${a.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),$t=f.forwardRef(function(n,r){const u=Ve({props:n,name:"MuiButtonGroup"}),{children:c,className:s,color:o="primary",component:m="div",disabled:$=!1,disableElevation:k=!1,disableFocusRipple:R=!1,disableRipple:y=!1,fullWidth:w=!1,orientation:z="horizontal",size:g="medium",variant:l="outlined",...G}=u,O={...u,color:o,component:m,disabled:$,disableElevation:k,disableFocusRipple:R,disableRipple:y,fullWidth:w,orientation:z,size:g,variant:l},B=Ct(O),U=f.useMemo(()=>({className:B.grouped,color:o,disabled:$,disableElevation:k,disableFocusRipple:R,disableRipple:y,fullWidth:w,size:g,variant:l}),[o,$,k,R,y,w,g,l,B.grouped]),E=qe(c),F=E.length,Y=M=>{const I=M===0,W=M===F-1;return I&&W?"":I?B.firstButton:W?B.lastButton:B.middleButton};return e.jsx(yt,{as:m,role:"group",className:Je(B.root,s),ref:r,ownerState:O,...G,children:e.jsx(xt.Provider,{value:U,children:E.map((M,I)=>e.jsx(mt.Provider,{value:Y(I),children:M},I))})})}),kt=$t;var me={},Rt=H;Object.defineProperty(me,"__esModule",{value:!0});var Te=me.default=void 0,Bt=Rt(N()),St=e;Te=me.default=(0,Bt.default)((0,St.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6m6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26"}),"Autorenew");var je={},_t=H;Object.defineProperty(je,"__esModule",{value:!0});var De=je.default=void 0,wt=_t(N()),zt=e;De=je.default=(0,wt.default)((0,zt.jsx)("path",{d:"M9 16.17 5.53 12.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0z"}),"CheckRounded");var ve={},Tt=H;Object.defineProperty(ve,"__esModule",{value:!0});var Ee=ve.default=void 0,Dt=Tt(N()),Et=e;Ee=ve.default=(0,Dt.default)((0,Et.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2M4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12m8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8"}),"DoDisturbAltRounded");var ge={},At=H;Object.defineProperty(ge,"__esModule",{value:!0});var Ae=ge.default=void 0,Pt=At(N()),Ot=e;Ae=ge.default=(0,Pt.default)((0,Ot.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1m3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"}),"AssignmentRounded");const he=({fechacomienzo:t,fechatermino:n,children:r,rangeDate:u=!1})=>{const[c,s]=f.useState(!1),o=()=>{const m=new Date(t),$=new Date(n),k=new Date,R=u?k>=m&&k<$:k<m;s(R)};return f.useEffect(()=>{o()},[]),f.useEffect(()=>{const m=setInterval(o,1e3);return()=>clearInterval(m)},[]),e.jsx(e.Fragment,{children:c&&r})};var fe={},Ft=H;Object.defineProperty(fe,"__esModule",{value:!0});var Pe=fe.default=void 0,It=Ft(N()),Lt=e;Pe=fe.default=(0,It.default)((0,Lt.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m4.3 14.3c-.39.39-1.02.39-1.41 0L12 13.41 9.11 16.3c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L10.59 12 7.7 9.11a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 10.59l2.89-2.89c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 12l2.89 2.89c.38.38.38 1.02 0 1.41"}),"CancelRounded");var be={},Gt=H;Object.defineProperty(be,"__esModule",{value:!0});var Oe=be.default=void 0,Ut=Gt(N()),Mt=e;Oe=be.default=(0,Ut.default)((0,Mt.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd");const Nt=({foto:t})=>{const[n,r]=f.useState(null),u=m=>{r(m.currentTarget)},c=()=>{r(null)},s=!!n,o=s?"simple-popover":void 0;return e.jsxs("div",{children:[e.jsx(D,{"aria-describedby":o,variant:"contained",onClick:u,size:"small",children:"Ver Foto"}),e.jsx(jt,{id:o,open:s,anchorEl:n,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx("img",{src:`${Q}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(t)}`,onError:m=>{m.currentTarget.src=we},alt:"actividad_personal_foto_perfil",width:200,height:200,style:{objectFit:"cover",borderRadius:"50%"}})})]})};function xe(t,n){return n=="docs"?t.reduce((u,c)=>{const s=u,{tipo:o}=c;return(o=="application/pdf"||o=="application/vnd.ms-powerpoint"||o=="application/vnd.openxmlformats-officedocument.presentationml.presentation"||o=="application/vnd.ms-excel"||o=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||o=="application/msword"||o=="application/vnd.openxmlformats-officedocument.wordprocessingml.document")&&s.push(c),s},[]):n=="imgs"?t.reduce((u,c)=>{const s=u,{tipo:o}=c;return(o=="image/jpeg"||o=="image/png"||o=="image/svg+xml"||o=="image/gif"||o=="image/avif"||o=="image/apng"||o=="image/webp")&&s.push(c),s},[]):n=="vids"?t.reduce((u,c)=>{const s=u,{tipo:o}=c;return(o=="video/x-msvideo"||o=="video/mp4"||o=="video/mpeg"||o=="video/ogg"||o=="video/webm"||o=="video/3gpp")&&s.push(c),s},[]):[]}const Ht=({handleCloseDialog:t,isOpen:n,data:r})=>{const{ctrl_id:u,rt_id:c}=r,s=Ze(),[o,m]=f.useState(null),[$,{isError:k,isSuccess:R,data:y,error:w,isLoading:z}]=Ke(),{isSuccess:g,data:l,isLoading:G,isError:O}=Xe({ctrl_id:u,rt_id:c}),B=async(p,v)=>{try{const b=JSON.stringify({path:p}),C=await fetch(`${Q}/api/v1/ticket/download/archivo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:b});if(!C.ok)throw new Error(`Error al descargar el archivo: ${C.statusText}`);const S=await C.blob(),ae=window.URL.createObjectURL(S),L=document.createElement("a");L.href=ae,L.setAttribute("download",v),document.body.appendChild(L),L.click(),document.body.removeChild(L)}catch(j){console.error("Error al descargar el archivo",j)}},U=async()=>{try{const p=await fetch(`${Q}/api/v1/ticket/${c}/download-zip?ctrl_id=${u}`,{method:"GET",credentials:"include"});if(!p.ok)throw new Error("Error al descargar el archivo ZIP");const v=await p.blob(),j=window.URL.createObjectURL(v),b=document.createElement("a");b.href=j,b.download=`archivo_respaldo_${u}_${c}_${Date.now()}.zip`,document.body.appendChild(b),b.click(),b.remove(),window.URL.revokeObjectURL(j)}catch(p){console.error("Error al descargar el archivo ZIP:",p)}},E=async()=>{try{const p=await fetch(`${Q}/api/v1/ticket/download?rt_id=${c}&ctrl_id=${u}`,{method:"GET",credentials:"include"});if(!p.ok){te.error(()=>e.jsx(re,{children:e.jsx(i,{component:"p",variant:"body1",children:JSON.stringify(p)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:oe,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}});return}const v=`TicketDetalles_${Date.now()}.pdf`,j=await p.blob(),b=window.URL.createObjectURL(j),C=document.createElement("a");C.href=b,C.setAttribute("download",v),document.body.appendChild(C),C.click(),document.body.removeChild(C)}catch(p){console.error("Error al descargar archivo pdf de los detalles del ticket.",p)}},[F,Y]=f.useState(!1),M=()=>{F&&(ee(null),se([])),Y(!F)},I=["image/jpeg","image/jpg","image/png","application/pdf","video/mp4"],[W,ee]=f.useState(null),[Ce,se]=f.useState([]),Fe=p=>{te.warn(()=>e.jsx(re,{children:e.jsx(i,{component:"p",variant:"body1",children:p})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:oe,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}})},Ie=p=>{const v=new FormData;p.forEach(j=>{v.append("archivos",j)}),ee(v)},Le=p=>{const v=new FormData;p.forEach(j=>{v.append("archivos",j)}),ee(v)},Ge=()=>{if(W){const p=new FormData,v=JSON.stringify({ctrl_id:u,rt_id:c});p.append("formvalues",v);for(const[j,b]of W.entries())p.append(j,b);$(p)}};return f.useEffect(()=>{if(g&&l){const{archivos_respaldo:p}=l;m(p)}},[g,l]),f.useEffect(()=>{k&&w&&te.error(()=>e.jsx(re,{children:e.jsx(i,{component:"p",variant:"body1",children:JSON.stringify(w)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:oe,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}}),R&&y&&(te.success(()=>e.jsx(re,{children:e.jsx(i,{component:"p",variant:"body1",children:y.message})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:s.palette.mode,transition:oe,closeButton:!0,style:{backgroundColor:s.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:s.palette.divider}}),ee(null),se([]),Y(!1),m(y.data))},[k,R,y]),e.jsxs(pt,{open:n,onClose:t,fullWidth:!0,maxWidth:"xl",sx:{"& .MuiDialog-paper":{}},children:[e.jsx(ht,{children:e.jsx(i,{component:"div",variant:"h5",children:"Detalles"})}),e.jsx(P,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(lt,{})}),e.jsxs(ut,{dividers:!0,children:[G&&e.jsx($e,{children:"Cargando detalles ..."}),O&&e.jsx(at,{children:"Error al cargar detalles del ticket."}),g&&l&&e.jsxs(d,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(d,{size:{xs:12,md:4},children:e.jsxs(q,{children:[e.jsx(K,{sx:{p:1},title:e.jsx(i,{component:"div",variant:"h5",children:"Solicitante"})}),e.jsx(T,{}),e.jsx(J,{children:e.jsxs(d,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(d,{size:{xs:12},children:e.jsxs(x,{spacing:.5,alignItems:"center",children:[e.jsx("img",{src:`${Q}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(l.solicitante.foto)}`,alt:"solicitante_foto_perfil",onError:p=>{p.currentTarget.src=we},width:100,height:100,style:{objectFit:"cover",borderRadius:"50%"}}),e.jsx(i,{component:"p",variant:"h6",children:l.solicitante.nombre}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.cargo})]})}),e.jsx(d,{size:{xs:12},children:e.jsx(T,{})}),e.jsx(d,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Nombre"}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.nombre})]})}),e.jsx(d,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.telefono})]})}),e.jsx(d,{size:{xs:12},children:e.jsx(T,{})}),e.jsx(d,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Correo"}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.correo})]})}),e.jsx(d,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"DNI"}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.dni})]})}),e.jsx(d,{size:{xs:12},children:e.jsx(T,{})}),e.jsx(d,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Cargo"}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.cargo})]})}),e.jsx(d,{size:{xs:6},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(i,{component:"p",variant:"body1",children:l.solicitante.contrata})]})})]})})]})}),e.jsx(d,{size:{xs:12,md:8},children:e.jsxs(q,{children:[e.jsx(K,{sx:{p:1},title:e.jsx(i,{component:"div",variant:"h5",children:"Ticket"}),action:e.jsx(pe,{title:"Generar PDF",placement:"left",children:e.jsx(P,{"aria-label":"download_ticket_details",onClick:E,children:e.jsx(V,{color:"info"})})})}),e.jsx(T,{}),e.jsx(J,{children:e.jsxs(d,{container:!0,rowSpacing:1.5,columnSpacing:1,children:[e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Tipo Trabajo"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.tipotrabajo})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Descripci처n"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.descripcion})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Prioridad"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.prioridad==1?"Alta":l.ticket.prioridad==2?"Medio":l.ticket.prioridad==3?"Bajo":"Error-Prioridad"})]})}),e.jsx(d,{size:{xs:12},children:e.jsx(T,{})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.contrata})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Estado"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.estado})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Creaci처n"}),e.jsx(i,{component:"p",variant:"body1",children:Z(l.ticket.fechacreacion)})]})}),e.jsx(d,{size:{xs:12},children:e.jsx(T,{})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Comienzo"}),e.jsx(i,{component:"p",variant:"body1",children:Z(l.ticket.fechacomienzo)})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Termino"}),e.jsx(i,{component:"p",variant:"body1",children:Z(l.ticket.fechatermino)})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Fecha Estado Final"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.fechaestadofinal&&Z(l.ticket.fechaestadofinal)})]})}),e.jsx(d,{size:{xs:12},children:e.jsx(T,{})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.telefono})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Correo"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.correo})]})}),e.jsx(d,{size:{xs:4},children:e.jsxs(x,{spacing:.5,children:[e.jsx(i,{component:"p",variant:"h6",children:"Numero Ticket:"}),e.jsx(i,{component:"p",variant:"body1",children:l.ticket.rt_id})]})})]})})]})}),e.jsx(d,{size:{xs:12},children:e.jsxs(q,{children:[e.jsx(K,{sx:{p:1},title:e.jsx(i,{component:"div",variant:"h5",children:"Personales"})}),e.jsx(T,{}),e.jsx(J,{children:e.jsx(ke,{component:Re,children:e.jsxs(Be,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(Se,{children:e.jsxs(X,{children:[e.jsx(h,{children:"N째"}),e.jsx(h,{children:"Nombre"}),e.jsx(h,{children:"Telefono"}),e.jsx(h,{children:"DNI"}),e.jsx(h,{children:"Cargo"}),e.jsx(h,{children:"Contrata"}),e.jsx(h,{children:"Foto"})]})}),e.jsx(_e,{children:l.personales.map((p,v)=>{const{ap_id:j,nombre:b,telefono:C,dni:S,cargo:ae,contrata:L,foto:ye}=p;return e.jsxs(X,{children:[e.jsx(h,{children:v+1}),e.jsx(h,{children:b}),e.jsx(h,{children:C}),e.jsx(h,{children:S}),e.jsx(h,{children:ae}),e.jsx(h,{children:L}),e.jsx(h,{children:ye&&e.jsx(Nt,{foto:ye},j+S)})]},j)})})]})})})]})}),e.jsx(d,{size:{xs:12},children:e.jsxs(q,{children:[e.jsx(K,{sx:{pl:1,py:1,pr:2},title:e.jsx(i,{component:"div",variant:"h5",children:"Archivos de Respaldo"}),action:e.jsxs(x,{direction:"row",spacing:2,children:[e.jsx(pe,{title:"Descargar ZIP",placement:"left",children:e.jsx(P,{"aria-label":"download_file_zip",onClick:U,children:e.jsx(V,{color:"primary"})})}),e.jsx(pe,{title:"Agregar archivo",placement:"bottom-end",children:e.jsxs(P,{"aria-label":"editar_archivos_respaldo",onClick:M,children:[!F&&e.jsx(Oe,{color:"warning"}),F&&e.jsx(Pe,{color:"error"})]})})]})}),e.jsx(T,{}),e.jsx(J,{children:e.jsxs(d,{container:!0,rowSpacing:1,columnSpacing:1,children:[F&&e.jsx(d,{size:{xs:12},sx:{marginBottom:1,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:s.palette.divider},children:e.jsxs(x,{spacing:1,pb:1,children:[e.jsx(dt,{supportedFormats:I,handleError:Fe,onUpload:Ie,onDelete:Le,count:5,maxSize:10,files:Ce,setFiles:se,buttonStyle:{maxWidth:300},children:"Nuevos archivos de respaldo:"}),z&&e.jsx($e,{children:"Enviando ..."}),Ce.length>0&&e.jsx(x,{alignItems:"end",children:e.jsx(D,{sx:{maxWidth:300},onClick:Ge,variant:"contained",type:"submit",startIcon:e.jsx(ct,{}),children:"Guardar"})})]})}),e.jsx(d,{size:{xs:12,md:4},sx:{borderRightWidth:"2px",borderRightColor:s.palette.mode==="dark"?s.palette.divider:s.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(x,{direction:"column",spacing:1,children:[e.jsx(i,{component:"div",variant:"body1",children:"Documentos:"}),e.jsx(le,{sx:{pr:1},children:o&&xe(o,"docs").map((p,v,j)=>{const{at_id:b,ruta:C,nombreoriginal:S}=p;return e.jsx(de,{divider:v<j.length-1,secondaryAction:e.jsx(P,{edge:"end","aria-label":"download_doc",onClick:()=>{B(C,S)},children:e.jsx(V,{color:"info"})}),children:e.jsx(ce,{primary:S,sx:{overflow:"hidden",textOverflow:"ellipsis"}})},b)})})]})}),e.jsx(d,{size:{xs:12,md:4},sx:{borderRightWidth:"2px",borderRightColor:s.palette.mode==="dark"?s.palette.divider:s.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(x,{direction:"column",spacing:1,children:[e.jsx(i,{component:"div",variant:"body1",children:"Fotos:"}),e.jsx(le,{sx:{pr:1},children:o&&xe(o,"imgs").map((p,v,j)=>{const{at_id:b,ruta:C,nombreoriginal:S}=p;return e.jsx(de,{divider:v<j.length-1,secondaryAction:e.jsx(P,{edge:"end","aria-label":"download_img",onClick:()=>{B(C,S)},children:e.jsx(V,{color:"info"})}),children:e.jsx(ce,{primary:S,sx:{overflow:"hidden",textOverflow:"ellipsis"}})},b)})})]})}),e.jsx(d,{size:{xs:12,md:4},children:e.jsxs(x,{direction:"column",spacing:1,children:[e.jsx(i,{component:"div",variant:"body1",children:"Videos:"}),e.jsx(le,{sx:{pr:1},children:o&&xe(o,"vids").map((p,v,j)=>{const{at_id:b,ruta:C,nombreoriginal:S}=p;return e.jsx(de,{divider:v<j.length-1,secondaryAction:e.jsx(P,{edge:"end","aria-label":"download_vids",onClick:()=>{B(C,S)},children:e.jsx(V,{color:"info"})}),children:e.jsx(ce,{primary:S,sx:{overflow:"hidden",textOverflow:"ellipsis"}})},b)})})]})})]})})]})})]})]})]})},Wt=({id:t})=>t===1?e.jsx(A,{icon:e.jsx(Te,{}),color:"warning",variant:"filled",label:"Pendiente"}):t===2?e.jsx(A,{icon:e.jsx(De,{}),color:"success",variant:"filled",label:"Aceptado"}):t===3?e.jsx(A,{icon:e.jsx(Ee,{}),color:"error",variant:"filled",label:"Cancelado"}):t===4?e.jsx(A,{icon:e.jsx(ie,{}),label:"Rechazado"}):t===16?e.jsx(A,{icon:e.jsx(ie,{}),label:"Finalizado"}):t===17?e.jsx(A,{icon:e.jsx(ie,{}),label:"Anulado"}):t===18?e.jsx(A,{icon:e.jsx(ie,{}),label:"No Atendido"}):e.jsx(A,{label:"Error id"}),Vt=({handleChangePage:t,handleChangeRowsPerPage:n,page:r,rowsPerPage:u,tickets:c})=>e.jsx(e.Fragment,{children:e.jsxs(x,{spacing:1,direction:"row",alignItems:"center",justifyContent:"end",children:[e.jsx("p",{children:"N째 Tickets:"}),e.jsxs(vt,{id:"control-select",name:"control-select",value:u,onChange:n,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5}},children:[e.jsx(ue,{value:10,children:10}),e.jsx(ue,{value:20,children:20}),e.jsx(ue,{value:50,children:50})]}),e.jsxs("p",{children:[c>0?r*u+1:0,"-",(r+1)*u<c?(r+1)*u:c," de ",c]}),e.jsx(st,{count:c,onPageChange:t,rowsPerPage:u,page:r})]})}),qt=({ctrl_id:t,nodo:n})=>{const[r,u]=f.useState(!0),[c,s]=f.useState(0),[o,m]=f.useState(10),$=g=>{m(g.target.value),s(0)},k=(g,l)=>{s(l)},[R,{isError:y,isSuccess:w,data:z}]=et();return f.useEffect(()=>{R({ctrl_id:t,limit:o,offset:c*o})},[t,c,o]),e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsx(h,{children:e.jsx(P,{"aria-label":"expand row",size:"small",onClick:()=>u(!r),children:r?e.jsx(it,{}):e.jsx(nt,{})})}),e.jsx(h,{children:ne(n,15)}),e.jsx(h,{colSpan:6,children:e.jsxs(e.Fragment,{children:[w&&r&&z&&e.jsx(Vt,{handleChangePage:k,handleChangeRowsPerPage:$,page:c,rowsPerPage:o,tickets:z.total_size}),y&&e.jsxs(ze,{variant:"filled",severity:"error",children:["Error obtener tickets del nodo : ",n]})]})})]}),r&&w&&z&&e.jsx(e.Fragment,{children:z.data.map(g=>e.jsx(Jt,{ctrl_id:t,registroTicket:g},g.rt_id))})]})},Jt=({ctrl_id:t,registroTicket:n})=>{var l,G,O,B,U;const[r,u]=f.useState(n),[c,{isSuccess:s}]=tt(),[o,{isSuccess:m,data:$}]=rt(),[k,R]=f.useState(!1),y=ot(E=>E.auth),w=()=>{R(!1)},z=()=>{R(!0)},g=E=>{c({action:E,ctrl_id:t,rt_id:r.rt_id})};return f.useEffect(()=>{m&&$&&u($)},[m,$]),f.useEffect(()=>{s&&o({ctrl_id:t,rt_id:r.rt_id})},[s]),e.jsx(e.Fragment,{children:e.jsxs(X,{children:[e.jsx(h,{}),e.jsx(h,{}),e.jsx(h,{children:r.rt_id}),e.jsx(h,{children:`${ne(r.nombre,15,!0)}  ${ne(r.apellido,15)}`}),e.jsx(h,{children:ne(r.descripcion,40,!0)}),e.jsx(h,{children:e.jsx(Wt,{id:r.estd_id})}),e.jsx(h,{children:Z(r.fechacomienzo)}),e.jsx(h,{children:e.jsxs(x,{direction:"row",spacing:r.estd_id===1||r.estd_id===2?2:void 0,justifyContent:"space-between",children:[e.jsx(kt,{variant:"contained","aria-label":"outlined button group",size:"small",color:"primary",children:e.jsxs(x,{direction:"row",spacing:1,children:[((l=y.user)==null?void 0:l.rol)==="Invitado"&&r.estd_id===1&&e.jsx(he,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:e.jsx(D,{onClick:()=>g(3),children:"Cancelar"})}),(((G=y.user)==null?void 0:G.rol)==="Usuario"||((O=y.user)==null?void 0:O.rol)==="Administrador")&&(r.estd_id===1||r.estd_id===2)&&e.jsxs(he,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!1,children:[r.estd_id===1&&e.jsx(D,{onClick:()=>g(2),children:"Aceptar"}),e.jsx(D,{onClick:()=>g(4),children:"Rechazar"}),e.jsx(D,{onClick:()=>g(3),children:"Cancelar"})]}),(((B=y.user)==null?void 0:B.rol)==="Usuario"||((U=y.user)==null?void 0:U.rol)==="Administrador")&&r.estd_id===2&&e.jsxs(he,{fechacomienzo:r.fechacomienzo,fechatermino:r.fechatermino,rangeDate:!0,children:[e.jsx(D,{onClick:()=>g(16),children:"Finalizar"}),e.jsx(D,{onClick:()=>g(17),children:"Anular"})]})]})}),e.jsx(D,{variant:"contained",color:"info",startIcon:e.jsx(Ae,{}),onClick:z,children:"Detalles"})]})}),k&&e.jsx(Ht,{isOpen:k,handleCloseDialog:w,data:{ctrl_id:t,p_id:r.p_id,rt_id:r.rt_id}})]})})},Qt=()=>{const{isSuccess:t,isError:n,data:r}=Ye();return e.jsxs(e.Fragment,{children:[e.jsx(K,{title:e.jsx(i,{component:"h5",variant:"h5",children:"HISTORIAL DE TICKETS"})}),e.jsx(J,{children:e.jsx(ke,{component:Re,children:e.jsxs(Be,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(Se,{children:e.jsxs(X,{children:[e.jsx(h,{}),e.jsx(h,{children:"Nodo"}),e.jsx(h,{children:"#Ticket"}),e.jsx(h,{children:"Solicitante"}),e.jsx(h,{children:"Descripcion"}),e.jsx(h,{children:"Estado"}),e.jsx(h,{children:"Fecha Trabajo"}),e.jsx(h,{children:"Acciones"})]})}),e.jsxs(_e,{children:[t&&r.map(u=>{const{ctrl_id:c,nodo:s,region:o}=u;return e.jsx(qt,{ctrl_id:c,nodo:s,region:o},u.ctrl_id)}),n&&e.jsx(ze,{variant:"filled",severity:"error",children:"Error al cargar nodos."})]})]})})})]})},gr=()=>e.jsx(e.Fragment,{children:e.jsx(d,{size:{xs:12},children:e.jsx(q,{children:e.jsx(Qt,{})})})});export{gr as HistorialPage,gr as default};
