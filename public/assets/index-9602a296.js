import{c as Se,j as e,r as f,u as ze,I as A,g as Ae,a as Ee,s as D,m as ee,T as Fe,b as He,d as ue,e as Z,i as Ne,f as $e,h as Y,k as Ve,l as N,B as C,G as m,n as y,S as R,o as We,p as te,q as V,t as Qe,v as se,w as ae,x as F,y as O,z as oe,A as P,C as ie,D as E,E as Ue,F as Ge,H as M,R as Ke,J as qe,K as Xe,L as Je,M as Ze,N as Oe,O as et,P as Ce,Q as tt,U as ge,V as fe,W as me,X as st}from"./index-9bd1da2a.js";import{_ as W}from"./react-apexcharts.min-7c73ad2f.js";import{M as ve}from"./Link-be23578a.js";import{d as at}from"./Close-83f5d310.js";import{D as ot,a as it}from"./DialogContent-512bdb02.js";import{D as nt}from"./DialogTitle-40f885de.js";import{u as rt,f as pe,N as lt,g as ct,a as dt,b as xt,S as ht}from"./index-ec6f1d55.js";import{T as ut,d as gt,a as ft}from"./KeyboardArrowUp-e33b894e.js";import{T as v,a as we,P as Me,b as Ie,c as _e,d as H,e as Te}from"./PaperTable-379db512.js";import{K as mt,a as pt,D as bt}from"./DateTimePicker-aa6993db.js";import{S as Pe,I as jt}from"./Select-97d3f45d.js";import{M as Ye}from"./MenuItem-a1adfdc7.js";import{T as yt}from"./TextField-a883b24b.js";import{B as xe,I as de}from"./InputLabel-9c0bbf31.js";import{g as St}from"./getFormattedDateTime-a73f566b.js";import{C as Ct}from"./CameraIcon2-e8e74f3e.js";import{D as Re}from"./Divider-e5407c8e.js";import"./date-time-utils-45556b4c.js";import"./InputAdornment-deee92f1.js";import"./FormControl-a04c9603.js";import"./Chip-dd1b7b0c.js";import"./LastPage-9b22ebd0.js";const vt=Se(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),wt=Se(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),Mt=f.forwardRef(function(a,c){const{backIconButtonProps:r,count:l,disabled:n=!1,getItemAriaLabel:o,nextIconButtonProps:g,onPageChange:d,page:i,rowsPerPage:x,showFirstButton:p,showLastButton:s,slots:u={},slotProps:b={},...k}=a,h=ze(),j=L=>{d(L,0)},S=L=>{d(L,i-1)},w=L=>{d(L,i+1)},re=L=>{d(L,Math.max(0,Math.ceil(l/x)-1))},Q=u.firstButton??A,U=u.lastButton??A,B=u.nextButton??A,G=u.previousButton??A,K=u.firstButtonIcon??vt,z=u.lastButtonIcon??wt,I=u.nextButtonIcon??mt,_=u.previousButtonIcon??pt,q=h?U:Q,X=h?B:G,le=h?G:B,J=h?Q:U,ce=h?b.lastButton:b.firstButton,T=h?b.nextButton:b.previousButton,Be=h?b.previousButton:b.nextButton,Le=h?b.firstButton:b.lastButton;return e.jsxs("div",{ref:c,...k,children:[p&&e.jsx(q,{onClick:j,disabled:n||i===0,"aria-label":o("first",i),title:o("first",i),...ce,children:h?e.jsx(z,{...b.lastButtonIcon}):e.jsx(K,{...b.firstButtonIcon})}),e.jsx(X,{onClick:S,disabled:n||i===0,color:"inherit","aria-label":o("previous",i),title:o("previous",i),...T??r,children:h?e.jsx(I,{...b.nextButtonIcon}):e.jsx(_,{...b.previousButtonIcon})}),e.jsx(le,{onClick:w,disabled:n||(l!==-1?i>=Math.ceil(l/x)-1:!1),color:"inherit","aria-label":o("next",i),title:o("next",i),...Be??g,children:h?e.jsx(_,{...b.previousButtonIcon}):e.jsx(I,{...b.nextButtonIcon})}),s&&e.jsx(J,{onClick:re,disabled:n||i>=Math.ceil(l/x)-1,"aria-label":o("last",i),title:o("last",i),...Le,children:h?e.jsx(K,{...b.firstButtonIcon}):e.jsx(z,{...b.lastButtonIcon})})]})}),It=Mt;function _t(t){return Ee("MuiTablePagination",t)}const Tt=Ae("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]),$=Tt;var be;const Pt=D(v,{name:"MuiTablePagination",slot:"Root",overridesResolver:(t,a)=>a.root})(ee(({theme:t})=>({overflow:"auto",color:(t.vars||t).palette.text.primary,fontSize:t.typography.pxToRem(14),"&:last-child":{padding:0}}))),Yt=D(Fe,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(t,a)=>({[`& .${$.actions}`]:a.actions,...a.toolbar})})(ee(({theme:t})=>({minHeight:52,paddingRight:2,[`${t.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[t.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${$.actions}`]:{flexShrink:0,marginLeft:20}}))),Rt=D("div",{name:"MuiTablePagination",slot:"Spacer",overridesResolver:(t,a)=>a.spacer})({flex:"1 1 100%"}),Dt=D("p",{name:"MuiTablePagination",slot:"SelectLabel",overridesResolver:(t,a)=>a.selectLabel})(ee(({theme:t})=>({...t.typography.body2,flexShrink:0}))),kt=D(Pe,{name:"MuiTablePagination",slot:"Select",overridesResolver:(t,a)=>({[`& .${$.selectIcon}`]:a.selectIcon,[`& .${$.select}`]:a.select,...a.input,...a.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${$.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),Bt=D(Ye,{name:"MuiTablePagination",slot:"MenuItem",overridesResolver:(t,a)=>a.menuItem})({}),Lt=D("p",{name:"MuiTablePagination",slot:"DisplayedRows",overridesResolver:(t,a)=>a.displayedRows})(ee(({theme:t})=>({...t.typography.body2,flexShrink:0})));function zt({from:t,to:a,count:c}){return`${t}â€“${a} of ${c!==-1?c:`more than ${a}`}`}function At(t){return`Go to ${t} page`}const Et=t=>{const{classes:a}=t;return $e({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},_t,a)},Ft=f.forwardRef(function(a,c){const r=He({props:a,name:"MuiTablePagination"}),{ActionsComponent:l=It,backIconButtonProps:n,className:o,colSpan:g,component:d=v,count:i,disabled:x=!1,getItemAriaLabel:p=At,labelDisplayedRows:s=zt,labelRowsPerPage:u="Rows per page:",nextIconButtonProps:b,onPageChange:k,onRowsPerPageChange:h,page:j,rowsPerPage:S,rowsPerPageOptions:w=[10,25,50,100],SelectProps:re={},showFirstButton:Q=!1,showLastButton:U=!1,slotProps:B={},slots:G={},...K}=r,z=r,I=Et(z),_=(B==null?void 0:B.select)??re,q=_.native?"option":Bt;let X;(d===v||d==="td")&&(X=g||1e3);const le=ue(_.id),J=ue(_.labelId),ce=()=>i===-1?(j+1)*S:S===-1?i:Math.min(i,(j+1)*S);return e.jsx(Pt,{colSpan:X,ref:c,as:d,ownerState:z,className:Z(I.root,o),...K,children:e.jsxs(Yt,{className:I.toolbar,children:[e.jsx(Rt,{className:I.spacer}),w.length>1&&e.jsx(Dt,{className:I.selectLabel,id:J,children:u}),w.length>1&&e.jsx(kt,{variant:"standard",...!_.variant&&{input:be||(be=e.jsx(jt,{}))},value:S,onChange:h,id:le,labelId:J,..._,classes:{..._.classes,root:Z(I.input,I.selectRoot,(_.classes||{}).root),select:Z(I.select,(_.classes||{}).select),icon:Z(I.selectIcon,(_.classes||{}).icon)},disabled:x,children:w.map(T=>f.createElement(q,{...!Ne(q)&&{ownerState:z},className:I.menuItem,key:T.label?T.label:T,value:T.value?T.value:T},T.label?T.label:T))}),e.jsx(Lt,{className:I.displayedRows,children:s({from:i===0?0:j*S+1,to:ce(),count:i===-1?-1:i,page:j})}),e.jsx(l,{className:I.actions,backIconButtonProps:n,count:i,nextIconButtonProps:b,onPageChange:k,page:j,rowsPerPage:S,showFirstButton:Q,showLastButton:U,slotProps:B.actions,slots:G.actions,getItemAriaLabel:p,disabled:x})]})})}),Ht=Ft;function ne(t,a,c){const r=[],l=[];return t.length>0?(t.forEach(n=>{n[a]&&n[c]&&(r.push(n[a]),l.push(n[c]))}),{categories:r,series:l}):{categories:r,series:l}}const Nt=()=>{const[t,a]=f.useState({configs:{chart:{type:"bar",id:"bar_active_pin_entrada",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#1668dc","#65a9f3"]}}),[c,r]=f.useState([]),{filters:l}=Y(s=>s.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=Ve(),x=N(),p=x.palette.mode;return f.useEffect(()=>{a(s=>{const u=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),f.useEffect(()=>{if(l.ctrl_id!=""&&l.date!=null){const{ctrl_id:s,date:u,is_monthly:b}=l;n({ctrl_id:Number(s),date:u,monthly:b?"true":"false"})}},[l]),f.useEffect(()=>{if(!g&&d&&i){const s=ne(i,"detector","total_activo");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"activaciones"}])}!g&&o&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[d,i,g,o]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{children:e.jsx(y,{variant:"h5",children:"Pines Entrada"})}),e.jsx(m,{})]}),e.jsx(R,{sx:{mt:2},children:e.jsx(W,{options:t.configs,series:c,type:"bar",height:365})})]})})},$t=()=>{const[t,a]=f.useState({configs:{chart:{type:"bar",id:"bar_active_pin_salida",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",borderRadius:4,borderRadiusApplication:"end",horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetX:-6},xaxis:{categories:[],axisBorder:{show:!1},axisTicks:{show:!0},title:{text:"Numero de activaciones",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"}}},yaxis:{max:s=>s+2,labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},grid:{show:!0},tooltip:{enabled:!1},colors:["#d89614"]}}),[c,r]=f.useState([]),{filters:l}=Y(s=>s.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=We(),x=N(),p=x.palette.mode;return f.useEffect(()=>{a(s=>{const u=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),f.useEffect(()=>{if(l.ctrl_id!=""&&l.date!=null){const{ctrl_id:s,date:u,is_monthly:b}=l;n({ctrl_id:Number(s),date:u,monthly:b?"true":"false"})}},[l]),f.useEffect(()=>{if(!g&&d&&i){const s=ne(i,"actuador","total_activo");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"activaciones"}])}!g&&o&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[d,i,g,o]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{children:e.jsx(y,{variant:"h5",children:"Pines Salida"})}),e.jsx(m,{})]}),e.jsx(R,{sx:{mt:2},children:e.jsx(W,{options:t.configs,series:c,type:"bar",height:365})})]})})},Vt=()=>{const{filters:t,other_filters:a}=Y(h=>h.dashboardSlice),c=te(),r=V(),[l,n]=f.useState({configs:{chart:{type:"donut",height:365},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:"#8c8c8c"},value:{color:"#8c8c8c"}}}}},labels:["Registrado","No registrado","Remoto"],dataLabels:{formatter(h,j){return j.w.globals.series[j.seriesIndex]}},legend:{labels:{colors:"#8c8c8c"}}}}),[o,g]=f.useState([0,0,0]),[d,{isError:i,isLoading:x,isSuccess:p,data:s}]=Qe(),u=N(),b=u.palette.mode,k=f.useCallback((h,j,S)=>{const w=S.dataPointIndex;w!=null&&w!=null&&w>-1&&t.is_monthly&&(r(se(a.region)),r(ae(t.ctrl_id)),w==0?(r(F("acceso")),r(O([{id:"autorizacion",value:"1"},{id:"tipo",value:"1"}]))):w==1?(r(F("acceso")),r(O([{id:"autorizacion",value:"0"},{id:"tipo",value:"1"},{id:"co_id",value:"0"}]))):w==2&&(r(F("salida")),r(O([{id:"es_id",value:"1"},{id:"estado",value:"1"}]))),r(oe(P(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),r(ie(P(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),c("/logs"))},[t.is_monthly]);return f.useEffect(()=>{n(h=>{const j=b=="dark"?u.palette.text.secondary:u.palette.text.primary;return{configs:{...h.configs,chart:{...h.configs.chart,background:u.palette.background.paper},plotOptions:{pie:{donut:{labels:{show:!0,total:{showAlways:!0,show:!0,color:j},value:{color:j}}}}},legend:{...h.configs.legend,labels:{colors:j}}}}})},[b]),f.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:h,date:j,is_monthly:S}=t;d({ctrl_id:Number(h),date:j,monthly:S?"true":"false"})}},[t]),f.useEffect(()=>{!x&&p&&s&&(g([s.data.tarjeta.total_registrado,s.data.tarjeta.total_noregistrado,s.data.remoto.total_remoto]),n(h=>({configs:{...h.configs,chart:{...h.configs.chart,events:{click:k}}}}))),!x&&i&&g([0,0,0])},[p,s,x,i,t.is_monthly]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{children:e.jsx(y,{variant:"h5",children:"Accesos"})}),e.jsx(m,{})]}),e.jsx(R,{sx:{mt:2,height:365},children:e.jsx(W,{options:l.configs,series:o,type:"donut",height:365})})]})})},Wt=()=>{const[t,a]=f.useState({configs:{chart:{type:"bar",height:365,toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(s,u,b){return E(String(s),15,!0)}}},yaxis:{stepSize:1,min:0,max:s=>s+1,title:{text:"Numero Tickets",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[c,r]=f.useState([]),{filters:l}=Y(s=>s.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=Ue(),x=N(),p=x.palette.mode;return f.useEffect(()=>{a(s=>{const u=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...s.configs,chart:{...s.configs.chart,background:x.palette.background.paper},xaxis:{...s.configs.xaxis,labels:{...s.configs.xaxis?s.configs.xaxis.labels:{},style:{...s.configs.xaxis&&s.configs.xaxis.labels?s.configs.xaxis.labels.style:{},colors:u,cssClass:"apexcharts-xaxis-label"}},title:{...s.configs.xaxis?s.configs.xaxis.title:{},style:{color:u}}},yaxis:{...s.configs.yaxis,labels:{style:{colors:u,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),f.useEffect(()=>{if(l.ctrl_id!=""&&l.date!=null){const{ctrl_id:s,date:u,is_monthly:b}=l;n({ctrl_id:Number(s),date:u,monthly:b?"true":"false"})}},[l]),f.useEffect(()=>{if(!g&&d&&i){const s=ne(i.data,"contrata","total_ticket");a(u=>({configs:{...u.configs,xaxis:{...u.configs.xaxis,categories:s.categories}}})),r([{data:s.series,name:"tickets"}])}!g&&o&&(a(s=>({configs:{...s.configs,xaxis:{...s.configs.xaxis,categories:[]}}})),r([]))},[d,i,g,o]),e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{children:e.jsx(y,{variant:"h5",children:"Tickets"})}),e.jsx(m,{})]}),e.jsx(R,{sx:{mt:2,height:365},children:e.jsx(W,{options:t.configs,series:c,type:"bar",height:365})})]})})},Qt="/assets/alarm-icon-a43fb34b.svg",Ut=()=>{const{filters:t,other_filters:a}=Y(p=>p.dashboardSlice),[c,{isError:r,isLoading:l,isSuccess:n,data:o}]=Ge(),[g,d]=f.useState(0),i=te(),x=V();return f.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:u}=t;c({ctrl_id:Number(p),date:s,monthly:u?"true":"false"})}},[t]),f.useEffect(()=>{!l&&n&&o&&d(o.data.total_alarma),!l&&r&&d(0)},[n,o,l,r]),e.jsxs(R,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Alarmas"}),e.jsxs(C,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(M,{direction:"row",alignItems:"end",children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:g}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"activaciones"})]}),e.jsx("img",{src:Qt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(M,{direction:"row",justifyContent:"end",children:e.jsx(ve,{component:"button",underline:"hover",onClick:()=>{x(se(a.region)),x(ae(t.ctrl_id)),x(F("salida")),x(oe(P(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),x(ie(P(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})})]})},Gt="/assets/tarjeta-icon-b78bb548.svg",De=({onClose:t,open:a,title:c,children:r})=>e.jsxs(ot,{open:a,onClose:t,fullWidth:!0,maxWidth:"md",children:[e.jsx(nt,{children:e.jsx(y,{component:"div",variant:"h5",children:c})}),e.jsx(A,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(at,{})}),e.jsx(it,{dividers:!0,children:r})]}),Kt=({data:t})=>{const a=f.useMemo(()=>t.length==0?[]:Object.keys(t[0]).map(n=>({accessorKey:n,header:()=>e.jsx("span",{children:n})})),[t]),c=rt({data:t,columns:a,getCoreRowModel:ct(),getFilteredRowModel:dt(),getPaginationRowModel:xt(),initialState:{pagination:{pageSize:25}}}),{pageSize:r,pageIndex:l}=c.getState().pagination;return e.jsx(e.Fragment,{children:e.jsxs(C,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden",rowGap:1},children:[e.jsx(C,{sx:{flex:1,overflow:"hidden"},children:e.jsxs(we,{sx:{height:"100%",display:"flex",flexDirection:"column"},component:Me,variant:"outlined",children:[e.jsxs(Ie,{size:"small",stickyHeader:!0,"aria-label":"sticky table",sx:{position:"relative"},children:[e.jsx(_e,{children:c.getHeaderGroups().map(n=>e.jsxs(Ke.Fragment,{children:[e.jsx(H,{children:n.headers.map(o=>e.jsx(v,{colSpan:o.colSpan,children:o.isPlaceholder?null:e.jsx("div",{children:pe(o.column.columnDef.header,o.getContext())})},o.id))}),e.jsx(H,{children:n.headers.map(o=>e.jsx(v,{colSpan:o.colSpan,children:o.isPlaceholder?null:e.jsx("div",{children:o.column.getCanFilter()&&e.jsx("div",{children:e.jsx(qt,{column:o.column,table:c})})})},o.id))})]},n.id))}),e.jsx(Te,{children:c.getRowModel().rows.map(n=>e.jsx(H,{children:n.getVisibleCells().map(o=>e.jsx(v,{children:pe(o.column.columnDef.cell,o.getContext())},o.id))},n.id))})]}),c.getFilteredRowModel().rows.length===0&&e.jsxs(C,{sx:{width:"100%",height:"100%",textAlign:"center",py:2,display:"flex",flexDirection:"column",alignItems:"center",rowGap:2},children:[e.jsx(lt,{}),"Datos no encontrados"]})]})}),e.jsx(Ht,{rowsPerPageOptions:[25,50,100,{label:"All",value:t.length}],component:"div",count:c.getFilteredRowModel().rows.length,rowsPerPage:r,page:l,labelDisplayedRows:({from:n,to:o,count:g})=>`${n}â€“${o} de ${g!==-1?g:`more than ${o}`}`,labelRowsPerPage:"Filas por Pagina :",SelectProps:{inputProps:{"aria-label":"rows per page"},id:"test-id"},onPageChange:(n,o)=>{c.setPageIndex(o)},onRowsPerPageChange:n=>{const o=n.target.value?Number(n.target.value):25;c.setPageSize(o)},ActionsComponent:ut})]})})};function qt({column:t}){const a=t.getFilterValue();return e.jsx(yt,{value:a??"",onChange:c=>t.setFilterValue(c.target.value),placeholder:"Buscar...",inputProps:{"aria-label":"search"},id:`filter-column-by-${t.id}`,size:"small",fullWidth:!0})}const Xt=()=>{const{filters:t}=Y(s=>s.dashboardSlice),[a,{isError:c,isLoading:r,isSuccess:l,data:n}]=qe(),[o,g]=f.useState(0),[d,i]=f.useState(!1),x=()=>{i(!1)},p=()=>{!r&&l&&n&&i(!0)};return f.useEffect(()=>{t.ctrl_id!=""&&t.date!=null&&a(void 0)},[t]),f.useEffect(()=>{!r&&l&&n&&g(n.total_tarjeta),!r&&c&&g(0)},[l,n,r,c]),e.jsxs(R,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Tarjetas"}),e.jsxs(C,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(M,{direction:"row",alignItems:"end",children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:o}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"asignados"})]}),e.jsx("img",{src:Gt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),e.jsx(M,{direction:"row",justifyContent:"end",children:t.is_monthly&&e.jsx(xe,{size:"small",onClick:p,children:"Ver Detalles"})}),e.jsx(De,{title:"Detalles Tarjetas Asignadas",onClose:x,open:d,children:!r&&l&&n&&e.jsx(Kt,{data:n.data})})]})},Jt="/assets/electricity-icon-e7ff5bd6.svg",Zt=()=>{const{filters:t,other_filters:a}=Y(p=>p.dashboardSlice),[c,{isError:r,isLoading:l,isSuccess:n,data:o}]=Xe(),[g,d]=f.useState(0),i=te(),x=V();return f.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:p,date:s,is_monthly:u}=t;c({ctrl_id:Number(p),date:s,monthly:u?"true":"false"})}},[t]),f.useEffect(()=>{!l&&n&&o&&d(o.acumulado),!l&&r&&d(0)},[n,o,l,r]),e.jsxs(R,{sx:{p:2.25},children:[e.jsx(y,{variant:"h6",color:"text.secondary",children:"Potencia"}),e.jsxs(C,{component:"div",sx:{py:3,display:"flex",alignItems:"center",position:"relative"},children:[e.jsxs(M,{direction:"row",alignItems:"end",spacing:1,children:[e.jsx(y,{color:"inherit",component:"div",fontSize:70,fontWeight:700,lineHeight:1,children:g}),e.jsx(y,{color:"inherit",component:"span",fontSize:30,lineHeight:1,children:"kw"}),e.jsx(y,{color:"inherit",component:"span",variant:"body1",children:"consumidos"})]}),e.jsx("img",{src:Jt,alt:"alarm-icon",width:80,style:{position:"absolute",top:0,right:0}})]}),t.is_monthly&&e.jsx(M,{direction:"row",justifyContent:"end",children:e.jsx(ve,{component:"button",underline:"hover",onClick:()=>{x(se(a.region)),x(ae(t.ctrl_id)),x(F("energia")),x(oe(P(t.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),x(ie(P(t.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),i("/logs")},children:"Ver Mas"})})]})},Ot=()=>{const[t,a]=f.useState({configs:{chart:{height:365,type:"bar",toolbar:{show:!1},background:"#1e1e1e"},plotOptions:{bar:{columnWidth:"45%",distributed:!0,borderRadius:8,borderRadiusApplication:"end",dataLabels:{position:"top"}}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{categories:[],labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-xaxis-label"},formatter(h,j,S){return E(String(h),15,!0)}}},yaxis:{stepSize:1,min:0,max:h=>h+1,title:{text:"Temperatura Max",style:{color:"#8c8c8c"}},labels:{style:{colors:"#8c8c8c",cssClass:"apexcharts-yaxis-label"}}},tooltip:{enabled:!1}}}),[c,r]=f.useState([]),{filters:l}=Y(h=>h.dashboardSlice),[n,{isError:o,isLoading:g,isSuccess:d,data:i}]=Je(),x=N(),p=x.palette.mode;f.useEffect(()=>{a(h=>{const j=p=="dark"?x.palette.text.secondary:x.palette.text.primary;return{configs:{...h.configs,chart:{...h.configs.chart,background:x.palette.background.paper},xaxis:{...h.configs.xaxis,labels:{...h.configs.xaxis?h.configs.xaxis.labels:{},style:{...h.configs.xaxis&&h.configs.xaxis.labels?h.configs.xaxis.labels.style:{},colors:j,cssClass:"apexcharts-xaxis-label"}},title:{...h.configs.xaxis?h.configs.xaxis.title:{},style:{color:j}}},yaxis:{...h.configs.yaxis,labels:{style:{colors:j,cssClass:"apexcharts-yaxis-label"}}}}}})},[p]),f.useEffect(()=>{if(l.ctrl_id!=""&&l.date!=null){const{ctrl_id:h,date:j,is_monthly:S}=l;n({ctrl_id:Number(h),date:j,monthly:S?"true":"false"})}},[l]),f.useEffect(()=>{if(!g&&d&&i){const h=je(i.data),j=Object.values(h).map(w=>w[0]),S=ne(j,"ubicacion","max_valor");a(w=>({configs:{...w.configs,xaxis:{...w.configs.xaxis,categories:S.categories}}})),r([{data:S.series,name:"tickets"}])}!g&&o&&(a(h=>({configs:{...h.configs,xaxis:{...h.configs.xaxis,categories:[]}}})),r([]))},[d,i,g,o]);const[s,u]=f.useState(!1),b=()=>{u(!1)},k=()=>{!g&&d&&i&&u(!0)};return e.jsx(e.Fragment,{children:e.jsxs(C,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{children:e.jsx(y,{variant:"h5",children:"Temperatura"})}),e.jsx(m,{})]}),e.jsxs(R,{sx:{mt:2,height:l.is_monthly?420:365},children:[e.jsx(W,{options:t.configs,series:c,type:"bar",height:365}),e.jsx(M,{direction:"row",justifyContent:"end",children:l.is_monthly&&e.jsx(xe,{size:"small",onClick:k,children:"Ver Detalles"})})]}),e.jsx(De,{title:"Detalles Temperatura",onClose:b,open:s,children:!g&&d&&i&&e.jsx(es,{data:Object.values(je(i.data))})})]})})},es=({data:t})=>e.jsx(we,{component:Me,variant:"outlined",children:e.jsxs(Ie,{size:"small","aria-label":"a dense table",children:[e.jsx(_e,{children:e.jsxs(H,{children:[e.jsx(v,{children:"Sensor Temperatura"}),e.jsx(v,{children:"Serie"}),e.jsx(v,{children:"Max Valor"}),e.jsx(v,{children:"Fecha"}),e.jsx(v,{children:"AcciÃ³n"})]})}),e.jsx(Te,{children:t.map((a,c)=>e.jsx(ts,{data:a},c))})]})}),ts=({data:t})=>{const[a,c]=f.useState(!0),{filters:r,other_filters:l}=Y(g=>g.dashboardSlice),n=te(),o=V();return e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx(v,{children:e.jsxs(M,{direction:"row",alignItems:"center",children:[e.jsx(A,{"aria-label":"expand row",size:"small",onClick:()=>c(!a),children:a?e.jsx(gt,{}):e.jsx(ft,{})}),e.jsx(y,{children:t[0].ubicacion})]})}),e.jsx(v,{colSpan:4})]}),a&&t.map(g=>e.jsxs(H,{children:[e.jsx(v,{}),e.jsx(v,{children:g.serie}),e.jsx(v,{children:g.max_valor}),e.jsxs(v,{children:[" ",St(g.fecha)]}),e.jsxs(v,{children:[" ",e.jsx(xe,{variant:"contained",color:"info",onClick:()=>{o(se(l.region)),o(ae(r.ctrl_id)),o(F("temperatura")),o(O([{id:"st_id",value:g.st_id}])),o(oe(P(r.date,"YYYY-MM").startOf("month").format("YYYY-MM-DD HH:mm:ss"))),o(ie(P(r.date,"YYYY-MM").endOf("month").format("YYYY-MM-DD HH:mm:ss"))),n("/logs")},children:"Ver Mas"})]})]},g.rtmp_id))]})};function je(t){const a={};return t.forEach(c=>{a[c.st_id]||(a[c.st_id]=[]),a[c.st_id].push(c)}),a}var he={},ss=Oe;Object.defineProperty(he,"__esModule",{value:!0});var ke=he.default=void 0,as=ss(Ze()),os=e;ke=he.default=(0,as.default)((0,os.jsx)("path",{d:"M15 9H9v6h6zm-2 4h-2v-2h2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2zm-4 6H7V7h10z"}),"Memory");const is=()=>{const{filters:t}=Y(i=>i.dashboardSlice),[a,{isError:c,isLoading:r,isSuccess:l,data:n}]=et(),[o,g]=f.useState({camera:[],controller:[]}),d=N();return f.useEffect(()=>{if(t.ctrl_id!=""&&t.date!=null){const{ctrl_id:i}=t;a({ctrl_id:Number(i)})}},[t]),f.useEffect(()=>{!r&&l&&n&&g(n.states),!r&&c&&g({camera:[],controller:[]})},[l,n,r,c]),e.jsxs(C,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{children:e.jsx(y,{variant:"h5",children:"Estados"})}),e.jsx(m,{})]}),e.jsx(R,{sx:{mt:2,height:t.is_monthly?420:365},children:e.jsx(C,{sx:{width:"100%",height:"100%",position:"relative"},children:e.jsx(C,{sx:{width:"100%",height:"100%",position:"absolute"},children:e.jsx(Ce,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(m,{container:!0,padding:2,rowSpacing:2,columnSpacing:2.5,children:[e.jsx(m,{size:{xs:12},children:e.jsx(y,{variant:"h6",color:d.palette.text.secondary,children:"Camaras"})}),o.camera.map((i,x)=>e.jsx(m,{size:{xs:12,sm:6,md:4},children:e.jsxs(M,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(M,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Ct,{isSelected:!1}),e.jsxs(M,{children:[e.jsx(y,{variant:"h6",children:E(i.descripcion,15,!0)}),e.jsx(y,{variant:"caption",color:d.palette.text.secondary,children:E(i.tipo,15,!0)})]})]}),e.jsx(ye,{conectado:i.conectado})]})},x)),e.jsx(m,{size:{xs:12},children:e.jsx(Re,{})}),e.jsx(m,{size:{xs:12},children:e.jsx(y,{variant:"h6",color:d.palette.text.secondary,children:"Controladores"})}),o.controller.map((i,x)=>e.jsx(m,{size:{xs:12,sm:6,md:4},children:e.jsxs(M,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(M,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(ke,{fontSize:"large"}),e.jsxs(M,{children:[e.jsx(y,{variant:"h6",children:E(i.nodo,15,!0)}),e.jsx(y,{variant:"caption",color:d.palette.text.secondary,children:E(i.descripcion,15,!0)})]})]}),e.jsx(ye,{conectado:i.conectado})]})},x))]})})})})})]})},ye=({conectado:t})=>t==0?e.jsx(C,{sx:{width:30,height:30,backgroundColor:"#f74c48",borderRadius:"50%"}}):t==1?e.jsx(C,{sx:{width:30,height:30,backgroundColor:"#04c584",borderRadius:"50%"}}):e.jsx(C,{sx:{width:30,height:30,backgroundColor:"#bfbfbf",borderRadius:"50%"}}),ns=D(m)(({theme:t})=>({[t.breakpoints.down("sm")]:{padding:"16px"},[t.breakpoints.up("sm")]:{padding:"24px"}}));function Ys(){return e.jsx(e.Fragment,{children:e.jsx(C,{sx:{width:"100%",height:"100%"},children:e.jsx(Ce,{sx:{maxWidth:"100%",maxHeight:"100%"},children:e.jsxs(ns,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(m,{size:{xs:12},sx:{mb:-2.25},children:e.jsx(y,{variant:"h5",children:"Dashboard"})}),e.jsx(rs,{}),e.jsx(m,{size:{xs:12},children:e.jsx(Re,{})}),e.jsx(m,{size:{xs:12,sm:6,md:4},children:e.jsx(Ut,{})}),e.jsx(m,{size:{xs:12,sm:6,md:4},children:e.jsx(Xt,{})}),e.jsx(m,{size:{xs:12,sm:12,md:4},children:e.jsx(Zt,{})}),e.jsx(m,{size:{xs:12,md:6},children:e.jsx(Nt,{})}),e.jsx(m,{size:{xs:12,md:6},children:e.jsx($t,{})}),e.jsx(m,{size:{xs:12,md:6},children:e.jsx(Vt,{})}),e.jsx(m,{size:{xs:12,md:6},children:e.jsx(Wt,{})}),e.jsx(m,{size:{xs:12,md:6},children:e.jsx(Ot,{})}),e.jsx(m,{size:{xs:12,md:6},children:e.jsx(is,{})})]})})})})}const rs=()=>{const{isSuccess:t,data:a}=tt(),{filters:{ctrl_id:c,date:r,is_monthly:l}}=Y(d=>d.dashboardSlice),n=V(),o=d=>{n(ge(d.target.value));const i=d.target.value;if(i!=""&&t&&a){const x=a.find(p=>String(p.ctrl_id)==i);x&&n(fe(x.region))}},g=d=>{n(st(d.target.checked))};return f.useEffect(()=>{if(t){const d=a[0];d&&c===""&&(n(ge(String(d.ctrl_id))),n(fe(d.region)))}},[t,a]),f.useEffect(()=>{n(me(P().format("YYYY-MM")))},[]),e.jsx(e.Fragment,{children:e.jsxs(m,{container:!0,size:{xs:12},rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(m,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(M,{spacing:1,children:[e.jsx(de,{htmlFor:"nodo-select",children:"Nodo"}),e.jsx(Pe,{value:c,placeholder:"select-nodo",onChange:o,inputProps:{id:"nodo-select"},children:t&&a.map(d=>{const{ctrl_id:i,nodo:x}=d;return e.jsx(Ye,{value:i,children:x},i)})})]})}),e.jsx(m,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsxs(M,{spacing:1,children:[e.jsx(de,{htmlFor:"date-select-dashboard",children:"Fecha"}),e.jsx(bt,{views:["month","year"],ampm:!1,format:"YYYY/MM",value:r?P(r,"YYYY-MM"):P(),onChange:d=>{d&&n(me(d.format("YYYY-MM")))},slotProps:{textField:{size:"medium",id:"date-select-dashboard"}}})]})}),e.jsx(m,{size:{xs:6,sm:6,md:4,lg:3},children:e.jsxs(M,{spacing:1,sx:{height:"100%"},children:[e.jsx(de,{htmlFor:"anual-mensual-switch",children:"Mensual"}),e.jsx(C,{sx:{flex:1,display:"flex",alignItems:"center"},children:e.jsx(ht,{size:"medium",checked:l,onChange:g,sx:{margin:0,width:60,height:28,"& .MuiSwitch-switchBase":{"&.Mui-checked":{transform:"translateX(32px)"}},"& .MuiSwitch-thumb":{width:22,height:22},"& .MuiSwitch-track":{borderRadius:24}},inputProps:{"aria-label":"controlled",id:"anual-mensual-switch"}})})]})})]})})};export{Ys as default};
