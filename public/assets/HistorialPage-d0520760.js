import{g as Me,b as Ne,s as We,a as P,aC as we,r as j,d as Ue,_ as He,j as e,f as Ve,aB as $,h as qe,L as N,M as W,u as Je,bn as Qe,bo as Ke,ak as Q,B as K,m as n,al as X,I as M,aJ as be,am as Xe,G as s,S as w,at as U,F as h,X as Y,bp as Ce,Z as oe,$ as ie,a4 as ne,bq as Ze,br as Ye,C as ee,bs as er,bt as rr,k as tr}from"./index-87ce3177.js";import{d as or,a as ir,T as nr}from"./KeyboardArrowUp-ddb199e7.js";import{d as Z}from"./CloseRounded-8b240764.js";import{a as ye,P as Re,b as ke,c as _e,d as q,T as c,e as $e}from"./PaperTable-21146a52.js";import{g as H}from"./getFormattedDateTime-9f097ac1.js";import{d as ar}from"./SaveAltRounded-5a443b5d.js";import{d as ae}from"./DownloadRounded-35fd3e0a.js";import{d as sr}from"./Close-8a53641f.js";import{C as lr,d as dr}from"./ChooseFiles-9655e4e2.js";import{D as cr,a as pr,b as ur}from"./DialogContent-c76e3a96.js";import{D as hr}from"./DialogTitle-a9d71988.js";import{C as V}from"./CardHeader-23e1a264.js";import{D as E,M as se}from"./MenuItem-fef4e83d.js";import{a as xr,B as S}from"./InputLabel-fc6e2611.js";import{P as mr,S as jr}from"./Select-bf490ba6.js";import{A as Te}from"./Alert-01833b27.js";import{C as F}from"./Chip-53dd8257.js";import"./LastPage-063f8549.js";function vr(t){return Ne("MuiButtonGroup",t)}const gr=Me("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary"]),B=gr,fr=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],br=(t,r)=>{const{ownerState:o}=t;return[{[`& .${B.grouped}`]:r.grouped},{[`& .${B.grouped}`]:r[`grouped${$(o.orientation)}`]},{[`& .${B.grouped}`]:r[`grouped${$(o.variant)}`]},{[`& .${B.grouped}`]:r[`grouped${$(o.variant)}${$(o.orientation)}`]},{[`& .${B.grouped}`]:r[`grouped${$(o.variant)}${$(o.color)}`]},r.root,r[o.variant],o.disableElevation===!0&&r.disableElevation,o.fullWidth&&r.fullWidth,o.orientation==="vertical"&&r.vertical]},Cr=t=>{const{classes:r,color:o,disabled:p,disableElevation:d,fullWidth:a,orientation:i,variant:x}=t,C={root:["root",x,i==="vertical"&&"vertical",a&&"fullWidth",d&&"disableElevation"],grouped:["grouped",`grouped${$(i)}`,`grouped${$(x)}`,`grouped${$(x)}${$(i)}`,`grouped${$(x)}${$(o)}`,p&&"disabled"]};return qe(C,vr,r)},yr=We("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:br})(({theme:t,ownerState:r})=>P({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},r.variant==="contained"&&{boxShadow:(t.vars||t).shadows[2]},r.disableElevation&&{boxShadow:"none"},r.fullWidth&&{width:"100%"},r.orientation==="vertical"&&{flexDirection:"column"},{[`& .${B.grouped}`]:P({minWidth:40,"&:not(:first-of-type)":P({},r.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},r.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},r.variant==="outlined"&&r.orientation==="horizontal"&&{marginLeft:-1},r.variant==="outlined"&&r.orientation==="vertical"&&{marginTop:-1}),"&:not(:last-of-type)":P({},r.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},r.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},r.variant==="text"&&r.orientation==="horizontal"&&{borderRight:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${B.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},r.variant==="text"&&r.orientation==="vertical"&&{borderBottom:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${B.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},r.variant==="text"&&r.color!=="inherit"&&{borderColor:t.vars?`rgba(${t.vars.palette[r.color].mainChannel} / 0.5)`:we(t.palette[r.color].main,.5)},r.variant==="outlined"&&r.orientation==="horizontal"&&{borderRightColor:"transparent"},r.variant==="outlined"&&r.orientation==="vertical"&&{borderBottomColor:"transparent"},r.variant==="contained"&&r.orientation==="horizontal"&&{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${B.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}},r.variant==="contained"&&r.orientation==="vertical"&&{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${B.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}},r.variant==="contained"&&r.color!=="inherit"&&{borderColor:(t.vars||t).palette[r.color].dark},{"&:hover":P({},r.variant==="outlined"&&r.orientation==="horizontal"&&{borderRightColor:"currentColor"},r.variant==="outlined"&&r.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),"&:hover":P({},r.variant==="contained"&&{boxShadow:"none"})},r.variant==="contained"&&{boxShadow:"none"})})),Rr=j.forwardRef(function(r,o){const p=Ue({props:r,name:"MuiButtonGroup"}),{children:d,className:a,color:i="primary",component:x="div",disabled:C=!1,disableElevation:y=!1,disableFocusRipple:R=!1,disableRipple:b=!1,fullWidth:T=!1,orientation:D="horizontal",size:m="medium",variant:l="outlined"}=p,O=He(p,fr),L=P({},p,{color:i,component:x,disabled:C,disableElevation:y,disableFocusRipple:R,disableRipple:b,fullWidth:T,orientation:D,size:m,variant:l}),z=Cr(L),G=j.useMemo(()=>({className:z.grouped,color:i,disabled:C,disableElevation:y,disableFocusRipple:R,disableRipple:b,fullWidth:T,size:m,variant:l}),[i,C,y,R,b,T,m,l,z.grouped]);return e.jsx(yr,P({as:x,role:"group",className:Ve(z.root,a),ref:o,ownerState:L},O,{children:e.jsx(xr.Provider,{value:G,children:d})}))}),kr=Rr;var ce={},_r=W;Object.defineProperty(ce,"__esModule",{value:!0});var De=ce.default=void 0,$r=_r(N()),Tr=e,Dr=(0,$r.default)((0,Tr.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");De=ce.default=Dr;var pe={},zr=W;Object.defineProperty(pe,"__esModule",{value:!0});var ze=pe.default=void 0,Er=zr(N()),Sr=e,Br=(0,Er.default)((0,Sr.jsx)("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"CheckRounded");ze=pe.default=Br;var ue={},Ar=W;Object.defineProperty(ue,"__esModule",{value:!0});var Ee=ue.default=void 0,Fr=Ar(N()),Pr=e,Lr=(0,Fr.default)((0,Pr.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zM4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12zm8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8z"}),"DoDisturbAltRounded");Ee=ue.default=Lr;var he={},Ir=W;Object.defineProperty(he,"__esModule",{value:!0});var Se=he.default=void 0,Or=Ir(N()),Gr=e,Mr=(0,Or.default)((0,Gr.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1zm3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1zm0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}),"AssignmentRounded");Se=he.default=Mr;const le=({fechacomienzo:t,fechatermino:r,children:o,rangeDate:p=!1})=>{const[d,a]=j.useState(!1),i=()=>{const x=new Date(t),C=new Date(r),y=new Date,R=p?y>=x&&y<C:y<x;a(R)};return j.useEffect(()=>{i()},[]),j.useEffect(()=>{const x=setInterval(i,1e3);return()=>clearInterval(x)},[]),e.jsx(e.Fragment,{children:d&&o})};var xe={},Nr=W;Object.defineProperty(xe,"__esModule",{value:!0});var Be=xe.default=void 0,Wr=Nr(N()),wr=e,Ur=(0,Wr.default)((0,wr.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm4.3 14.3c-.39.39-1.02.39-1.41 0L12 13.41 9.11 16.3c-.39.39-1.02.39-1.41 0a.9959.9959 0 0 1 0-1.41L10.59 12 7.7 9.11a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 10.59l2.89-2.89c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41L13.41 12l2.89 2.89c.38.38.38 1.02 0 1.41z"}),"CancelRounded");Be=xe.default=Ur;var me={},Hr=W;Object.defineProperty(me,"__esModule",{value:!0});var Ae=me.default=void 0,Vr=Hr(N()),qr=e,Jr=(0,Vr.default)((0,qr.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3v2zm-3-7V3.5L18.5 9H13z"}),"NoteAdd");Ae=me.default=Jr;const Qr=({foto:t})=>{const[r,o]=j.useState(null),p=x=>{o(x.currentTarget)},d=()=>{o(null)},a=!!r,i=a?"simple-popover":void 0;return e.jsxs("div",{children:[e.jsx(S,{"aria-describedby":i,variant:"contained",onClick:p,size:"small",children:"Ver Foto"}),e.jsx(mr,{id:i,open:a,anchorEl:r,onClose:d,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx("img",{src:`${Y}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(t)}`,onError:x=>{x.currentTarget.src=Ce},alt:"actividad_personal_foto_perfil",width:200,height:200,style:{objectFit:"cover",borderRadius:"50%"}})})]})};function de(t,r){return r=="docs"?t.reduce((p,d)=>{const a=p,{tipo:i}=d;return(i=="application/pdf"||i=="application/vnd.ms-powerpoint"||i=="application/vnd.openxmlformats-officedocument.presentationml.presentation"||i=="application/vnd.ms-excel"||i=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||i=="application/msword"||i=="application/vnd.openxmlformats-officedocument.wordprocessingml.document")&&a.push(d),a},[]):r=="imgs"?t.reduce((p,d)=>{const a=p,{tipo:i}=d;return(i=="image/jpeg"||i=="image/png"||i=="image/svg+xml"||i=="image/gif"||i=="image/avif"||i=="image/apng"||i=="image/webp")&&a.push(d),a},[]):r=="vids"?t.reduce((p,d)=>{const a=p,{tipo:i}=d;return(i=="video/x-msvideo"||i=="video/mp4"||i=="video/mpeg"||i=="video/ogg"||i=="video/webm"||i=="video/3gpp")&&a.push(d),a},[]):[]}const Kr=({handleCloseDialog:t,isOpen:r,data:o})=>{const{ctrl_id:p,rt_id:d}=o,a=Je(),[i,x]=j.useState(null),[C,{isError:y,isSuccess:R,data:b,error:T,isLoading:D}]=Qe(),{isSuccess:m,data:l,isLoading:O,isError:L}=Ke({ctrl_id:p,rt_id:d}),z=async(u,v)=>{try{const k=JSON.stringify({path:u}),f=await fetch(`${Y}/api/v1/ticket/download/archivo`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:k});if(!f.ok)throw new Error(`Error al descargar el archivo: ${f.statusText}`);const _=await f.blob(),te=window.URL.createObjectURL(_),I=document.createElement("a");I.href=te,I.setAttribute("download",v),document.body.appendChild(I),I.click(),document.body.removeChild(I)}catch(g){console.error("Error al descargar el archivo",g)}},G=async()=>{try{const u=await fetch(`${Y}/api/v1/ticket/download?rt_id=${d}&ctrl_id=${p}`,{method:"GET",credentials:"include"});if(!u.ok){Q.error(()=>e.jsx(K,{children:e.jsx(n,{component:"p",variant:"body1",children:JSON.stringify(u)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a.palette.mode,transition:X,closeButton:!0,style:{backgroundColor:a.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:a.palette.divider}});return}const v=`TicketDetalles_${Date.now()}.pdf`,g=await u.blob(),k=window.URL.createObjectURL(g),f=document.createElement("a");f.href=k,f.setAttribute("download",v),document.body.appendChild(f),f.click(),document.body.removeChild(f)}catch(u){console.error("Error al descargar archivo pdf de los detalles del ticket.",u)}},[A,je]=j.useState(!1),Fe=()=>{A&&(J(null),re([])),je(!A)},Pe=["image/jpeg","image/jpg","image/png","application/pdf","video/mp4"],[ve,J]=j.useState(null),[ge,re]=j.useState([]),Le=u=>{Q.warn(()=>e.jsx(K,{children:e.jsx(n,{component:"p",variant:"body1",children:u})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a.palette.mode,transition:X,closeButton:!0,style:{backgroundColor:a.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:a.palette.divider}})},Ie=u=>{const v=new FormData;u.forEach(g=>{v.append("archivos",g)}),J(v)},Oe=u=>{const v=new FormData;u.forEach(g=>{v.append("archivos",g)}),J(v)},Ge=()=>{if(ve){let u=new FormData;const v=JSON.stringify({ctrl_id:p,rt_id:d});u.append("formvalues",v);for(const[g,k]of ve.entries())u.append(g,k);C(u)}};return j.useEffect(()=>{if(m&&l){const{archivos_respaldo:u}=l;x(u)}},[m,l]),j.useEffect(()=>{y&&T&&Q.error(()=>e.jsx(K,{children:e.jsx(n,{component:"p",variant:"body1",children:JSON.stringify(T)})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a.palette.mode,transition:X,closeButton:!0,style:{backgroundColor:a.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:a.palette.divider}}),R&&b&&(Q.success(()=>e.jsx(K,{children:e.jsx(n,{component:"p",variant:"body1",children:b.message})}),{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a.palette.mode,transition:X,closeButton:!0,style:{backgroundColor:a.palette.background.paper,borderWidth:"1px",borderStyle:"solid",borderColor:a.palette.divider}}),J(null),re([]),je(!1),x(b.data))},[y,R,b]),e.jsxs(cr,{open:r,onClose:t,fullWidth:!0,maxWidth:"xl",sx:{"& .MuiDialog-paper":{}},children:[e.jsx(hr,{children:e.jsx(n,{component:"div",variant:"h5",children:"Detalles"})}),e.jsx(M,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:16,top:8},children:e.jsx(sr,{})}),e.jsxs(pr,{dividers:!0,children:[O&&e.jsx(be,{children:"Cargando detalles ..."}),L&&e.jsx(Xe,{children:"Error al cargar detalles del ticket."}),m&&l&&e.jsxs(s,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(s,{item:!0,xs:4,children:e.jsxs(w,{children:[e.jsx(V,{sx:{p:1},title:e.jsx(n,{component:"div",variant:"h5",children:"Solicitante"})}),e.jsx(E,{}),e.jsx(U,{children:e.jsxs(s,{container:!0,rowSpacing:1,columnSpacing:1,children:[e.jsx(s,{item:!0,xs:12,children:e.jsxs(h,{spacing:.5,alignItems:"center",children:[e.jsx("img",{src:`${Y}/api/v1/ticket/fotoactividadpersonal?imgPath=${encodeURIComponent(l.solicitante.foto)}`,alt:"solicitante_foto_perfil",onError:u=>{u.currentTarget.src=Ce},width:100,height:100,style:{objectFit:"cover",borderRadius:"50%"}}),e.jsx(n,{component:"p",variant:"h6",children:l.solicitante.nombre}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.cargo})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Nombre"}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.nombre})]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.telefono})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Correo"}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.correo})]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"DNI"}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.dni})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Cargo"}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.cargo})]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(n,{component:"p",variant:"body1",children:l.solicitante.contrata})]})})]})})]})}),e.jsx(s,{item:!0,xs:8,children:e.jsxs(w,{children:[e.jsx(V,{sx:{p:1},title:e.jsx(n,{component:"div",variant:"h5",children:"Ticket"})}),e.jsx(E,{}),e.jsx(U,{children:e.jsxs(s,{container:!0,rowSpacing:1.5,columnSpacing:1,children:[e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Tipo Trabajo"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.tipotrabajo})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Descripción"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.descripcion})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Prioridad"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.prioridad==1?"Alta":(l.ticket.prioridad==2?"Medio":"Bajo")||"Error_Prioridad"})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Contrata"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.contrata})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Estado"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.estado})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Creación"}),e.jsx(n,{component:"p",variant:"body1",children:H(l.ticket.fechacreacion)})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Comienzo"}),e.jsx(n,{component:"p",variant:"body1",children:H(l.ticket.fechacomienzo)})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Termino"}),e.jsx(n,{component:"p",variant:"body1",children:H(l.ticket.fechatermino)})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Fecha Estado Final"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.fechaestadofinal&&H(l.ticket.fechaestadofinal)})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Telefono"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.telefono})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Correo"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.correo})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{spacing:.5,children:[e.jsx(n,{component:"p",variant:"h6",children:"Numero Ticket:"}),e.jsx(n,{component:"p",variant:"body1",children:l.ticket.rt_id})]})})]})})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(w,{children:[e.jsx(V,{sx:{p:1},title:e.jsx(n,{component:"div",variant:"h5",children:"Personales"})}),e.jsx(E,{}),e.jsx(U,{children:e.jsx(ye,{component:Re,children:e.jsxs(ke,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(_e,{children:e.jsxs(q,{children:[e.jsx(c,{children:"N°"}),e.jsx(c,{children:"Nombre"}),e.jsx(c,{children:"Telefono"}),e.jsx(c,{children:"DNI"}),e.jsx(c,{children:"Cargo"}),e.jsx(c,{children:"Contrata"}),e.jsx(c,{children:"Foto"})]})}),e.jsx($e,{children:l.personales.map((u,v)=>{const{ap_id:g,nombre:k,telefono:f,dni:_,cargo:te,contrata:I,foto:fe}=u;return e.jsxs(q,{children:[e.jsx(c,{children:v+1}),e.jsx(c,{children:k}),e.jsx(c,{children:f}),e.jsx(c,{children:_}),e.jsx(c,{children:te}),e.jsx(c,{children:I}),e.jsx(c,{children:fe&&e.jsx(Qr,{foto:fe},g+_)})]},g)})})]})})})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(w,{children:[e.jsx(V,{sx:{pl:1,py:1,pr:2},title:e.jsx(n,{component:"div",variant:"h5",children:"Archivos de Respaldo"}),action:e.jsxs(M,{"aria-label":"editar_archivos_respaldo",size:"small",onClick:Fe,children:[!A&&e.jsx(Ae,{color:"warning"}),A&&e.jsx(Be,{color:"error"})]})}),e.jsx(E,{}),e.jsx(U,{children:e.jsxs(s,{container:!0,rowSpacing:1,columnSpacing:1,children:[A&&e.jsx(s,{item:!0,xs:12,sx:{marginBottom:1,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:a.palette.divider},children:e.jsxs(h,{spacing:1,pb:1,children:[e.jsx(lr,{supportedFormats:Pe,handleError:Le,onUpload:Ie,onDelete:Oe,count:5,maxSize:10,files:ge,setFiles:re,buttonStyle:{maxWidth:300},children:"Nuevos archivos de respaldo:"}),D&&e.jsx(be,{children:"Enviando ..."}),ge.length>0&&e.jsx(h,{alignItems:"end",children:e.jsx(S,{sx:{maxWidth:300},onClick:Ge,variant:"contained",type:"submit",startIcon:e.jsx(dr,{}),children:"Guardar"})})]})}),e.jsx(s,{item:!0,xs:4,sx:{borderRightWidth:"2px",borderRightColor:a.palette.mode==="dark"?a.palette.divider:a.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(h,{direction:"column",spacing:1,children:[e.jsx(n,{component:"div",variant:"body1",children:"Documentos:"}),e.jsx(oe,{sx:{pr:1},children:i&&de(i,"docs").map((u,v,g)=>{const{at_id:k,ruta:f,nombreoriginal:_}=u;return e.jsx(ie,{divider:v<g.length-1,secondaryAction:e.jsx(M,{edge:"end","aria-label":"download_doc",onClick:()=>{z(f,_)},children:e.jsx(ae,{color:"info"})}),children:e.jsx(ne,{primary:_})},k)})})]})}),e.jsx(s,{item:!0,xs:4,sx:{borderRightWidth:"2px",borderRightColor:a.palette.mode==="dark"?a.palette.divider:a.palette.grey.A800,borderRightStyle:"solid"},children:e.jsxs(h,{direction:"column",spacing:1,children:[e.jsx(n,{component:"div",variant:"body1",children:"Fotos:"}),e.jsx(oe,{sx:{pr:1},children:i&&de(i,"imgs").map((u,v,g)=>{const{at_id:k,ruta:f,nombreoriginal:_}=u;return e.jsx(ie,{divider:v<g.length-1,secondaryAction:e.jsx(M,{edge:"end","aria-label":"download_img",onClick:()=>{z(f,_)},children:e.jsx(ae,{color:"info"})}),children:e.jsx(ne,{primary:_})},k)})})]})}),e.jsx(s,{item:!0,xs:4,children:e.jsxs(h,{direction:"column",spacing:1,children:[e.jsx(n,{component:"div",variant:"body1",children:"Videos:"}),e.jsx(oe,{sx:{pr:1},children:i&&de(i,"vids").map((u,v,g)=>{const{at_id:k,ruta:f,nombreoriginal:_}=u;return e.jsx(ie,{divider:v<g.length-1,secondaryAction:e.jsx(M,{edge:"end","aria-label":"download_vids",onClick:()=>{z(f,_)},children:e.jsx(ae,{color:"info"})}),children:e.jsx(ne,{primary:_})},k)})})]})})]})})]})})]})]}),e.jsx(ur,{children:e.jsx(S,{variant:"contained",startIcon:e.jsx(ar,{}),onClick:G,children:"Descargar"})})]})},Xr=({id:t})=>t==1?e.jsx(F,{icon:e.jsx(De,{}),color:"warning",variant:"filled",label:"Pendiente"}):t==2?e.jsx(F,{icon:e.jsx(ze,{}),color:"success",variant:"filled",label:"Aceptado"}):t==3?e.jsx(F,{icon:e.jsx(Ee,{}),color:"error",variant:"filled",label:"Cancelado"}):t==4?e.jsx(F,{icon:e.jsx(Z,{}),label:"Rechazado"}):t==16?e.jsx(F,{icon:e.jsx(Z,{}),label:"Finalizado"}):t==17?e.jsx(F,{icon:e.jsx(Z,{}),label:"Anulado"}):t==18?e.jsx(F,{icon:e.jsx(Z,{}),label:"No Atendido"}):e.jsx(F,{label:"Error id"}),Zr=({handleChangePage:t,handleChangeRowsPerPage:r,page:o,rowsPerPage:p,tickets:d})=>e.jsx(e.Fragment,{children:e.jsxs(h,{spacing:1,direction:"row",alignItems:"center",justifyContent:"end",children:[e.jsx("p",{children:"N° Tickets:"}),e.jsxs(jr,{id:"control-select",name:"control-select",value:p,onChange:r,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5}},children:[e.jsx(se,{value:10,children:10}),e.jsx(se,{value:20,children:20}),e.jsx(se,{value:50,children:50})]}),e.jsxs("p",{children:[d>0?o*p+1:0,"-",(o+1)*p<d?(o+1)*p:d," ","de ",d]}),e.jsx(nr,{count:d,onPageChange:t,rowsPerPage:p,page:o})]})}),Yr=({ctrl_id:t,nodo:r})=>{const[o,p]=j.useState(!0),[d,a]=j.useState(0),[i,x]=j.useState(10),C=m=>{x(m.target.value),a(0)},y=(m,l)=>{a(l)},[R,{isError:b,isSuccess:T,data:D}]=Ye();return j.useEffect(()=>{R({ctrl_id:t,limit:i,offset:d*i})},[t,d,i]),e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(c,{children:e.jsx(M,{"aria-label":"expand row",size:"small",onClick:()=>p(!o),children:o?e.jsx(or,{}):e.jsx(ir,{})})}),e.jsx(c,{children:ee(r,15)}),e.jsx(c,{colSpan:6,children:e.jsxs(e.Fragment,{children:[T&&o&&D&&e.jsx(Zr,{handleChangePage:y,handleChangeRowsPerPage:C,page:d,rowsPerPage:i,tickets:D.total_size}),b&&e.jsxs(Te,{variant:"filled",severity:"error",children:["Error obtener tickets del nodo : ",r]})]})})]}),o&&T&&D&&e.jsx(e.Fragment,{children:D.data.map(m=>e.jsx(et,{ctrl_id:t,registroTicket:m},m.rt_id))})]})},et=({ctrl_id:t,registroTicket:r})=>{var l,O,L,z,G;const[o,p]=j.useState(r),[d,{isSuccess:a}]=er(),[i,{isSuccess:x,data:C}]=rr(),[y,R]=j.useState(!1),b=tr(A=>A.auth),T=()=>{R(!1)},D=()=>{R(!0)},m=A=>{d({action:A,ctrl_id:t,rt_id:o.rt_id})};return j.useEffect(()=>{x&&C&&p(C)},[x,C]),j.useEffect(()=>{a&&i({ctrl_id:t,rt_id:o.rt_id})},[a]),e.jsx(e.Fragment,{children:e.jsxs(q,{children:[e.jsx(c,{}),e.jsx(c,{}),e.jsx(c,{children:o.rt_id}),e.jsx(c,{children:`${ee(o.nombre.split(" ")[0],15)}  ${ee(o.apellido.split(" ")[0],15)}`}),e.jsx(c,{children:ee(o.descripcion.split(" ")[0],40,!0)}),e.jsx(c,{children:e.jsx(Xr,{id:o.estd_id})}),e.jsx(c,{children:H(o.fechacomienzo)}),e.jsx(c,{children:e.jsxs(h,{direction:"row",spacing:o.estd_id==1||o.estd_id==2?2:void 0,justifyContent:"space-between",children:[e.jsxs(kr,{variant:"contained","aria-label":"outlined button group",size:"small",color:"primary",children:[((l=b.user)==null?void 0:l.rol)==="Invitado"&&o.estd_id==1&&e.jsx(le,{fechacomienzo:o.fechacomienzo,fechatermino:o.fechatermino,rangeDate:!1,children:e.jsx(S,{onClick:()=>m(3),children:"Cancelar"})}),(((O=b.user)==null?void 0:O.rol)==="Usuario"||((L=b.user)==null?void 0:L.rol)==="Administrador")&&(o.estd_id==1||o.estd_id==2)&&e.jsxs(le,{fechacomienzo:o.fechacomienzo,fechatermino:o.fechatermino,rangeDate:!1,children:[o.estd_id==1&&e.jsx(S,{onClick:()=>m(2),children:"Aceptar"}),e.jsx(S,{onClick:()=>m(4),children:"Rechazar"}),e.jsx(S,{onClick:()=>m(3),children:"Cancelar"})]}),(((z=b.user)==null?void 0:z.rol)==="Usuario"||((G=b.user)==null?void 0:G.rol)==="Administrador")&&o.estd_id==2&&e.jsxs(le,{fechacomienzo:o.fechacomienzo,fechatermino:o.fechatermino,rangeDate:!0,children:[e.jsx(S,{onClick:()=>m(16),children:"Finalizar"}),e.jsx(S,{onClick:()=>m(17),children:"Anular"})]})]}),e.jsx(S,{variant:"contained",color:"info",startIcon:e.jsx(Se,{}),onClick:D,children:"Detalles"})]})}),y&&e.jsx(Kr,{isOpen:y,handleCloseDialog:T,data:{ctrl_id:t,p_id:o.p_id,rt_id:o.rt_id}})]})})},rt=()=>{const{isSuccess:t,isError:r,data:o}=Ze();return e.jsxs(e.Fragment,{children:[e.jsx(V,{title:e.jsx(n,{component:"h5",variant:"h5",children:"HISTORIAL DE TICKETS"})}),e.jsx(U,{children:e.jsx(ye,{component:Re,children:e.jsxs(ke,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(_e,{children:e.jsxs(q,{children:[e.jsx(c,{}),e.jsx(c,{children:"Nodo"}),e.jsx(c,{children:"#Ticket"}),e.jsx(c,{children:"Solicitante"}),e.jsx(c,{children:"Descripcion"}),e.jsx(c,{children:"Estado"}),e.jsx(c,{children:"Fecha Trabajo"}),e.jsx(c,{children:"Acciones"})]})}),e.jsxs($e,{children:[t&&o.map(p=>{const{ctrl_id:d,nodo:a,region:i}=p;return e.jsx(Yr,{ctrl_id:d,nodo:a,region:i},p.ctrl_id)}),r&&e.jsx(Te,{variant:"filled",severity:"error",children:"Error al cargar nodos."})]})]})})})]})},bt=()=>e.jsx(e.Fragment,{children:e.jsx(s,{item:!0,xs:12,children:e.jsx(w,{children:e.jsx(rt,{})})})});export{bt as HistorialPage,bt as default};
