import{r as g,i as _,j as e,a as n,aJ as V,b6 as K,T as Q,ae as W,b7 as J,I as X,b8 as Y,b9 as Z,d as ee,S as F,G as te,ad as ae}from"./index-f47cb319.js";import{d as T}from"./CloseRounded-b1549377.js";import{C as re,a as se,P as ie,b as ne,c as le,d as z,T as r,e as oe}from"./PaperTable-0157daaf.js";import{T as ce}from"./PaginationActions-0c5f7ff9.js";import{g as de,B as ue}from"./getFormattedDateTime-e1a04bea.js";import{A as O}from"./Alert-14585ceb.js";import{B as p}from"./Button-eb2c856c.js";import{C as h}from"./Chip-79356fd2.js";import{S as je}from"./Select-a5d4c5fc.js";import{M as C}from"./MenuItem-446faf11.js";var k={},he=_;Object.defineProperty(k,"__esModule",{value:!0});var H=k.default=void 0,xe=he(g()),fe=e,pe=(0,xe.default)((0,fe.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");H=k.default=pe;var y={},ve=_;Object.defineProperty(y,"__esModule",{value:!0});var q=y.default=void 0,me=ve(g()),ge=e,_e=(0,me.default)((0,ge.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");q=y.default=_e;var $={},be=_;Object.defineProperty($,"__esModule",{value:!0});var B=$.default=void 0,Se=be(g()),Te=e,Re=(0,Se.default)((0,Te.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");B=$.default=Re;var A={},Ce=_;Object.defineProperty(A,"__esModule",{value:!0});var N=A.default=void 0,De=Ce(g()),ze=e,ke=(0,De.default)((0,ze.jsx)("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"CheckRounded");N=A.default=ke;var I={},ye=_;Object.defineProperty(I,"__esModule",{value:!0});var U=I.default=void 0,$e=ye(g()),Ae=e,Ie=(0,$e.default)((0,Ae.jsx)("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zM4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12zm8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8z"}),"DoDisturbAltRounded");U=I.default=Ie;var E={},Ee=_;Object.defineProperty(E,"__esModule",{value:!0});var G=E.default=void 0,we=Ee(g()),Pe=e,Me=(0,we.default)((0,Pe.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm1 14H8c-.55 0-1-.45-1-1s.45-1 1-1h5c.55 0 1 .45 1 1s-.45 1-1 1zm3-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1zm0-4H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}),"AssignmentRounded");G=E.default=Me;const D=({fechacomienzo:a,fechatermino:c,children:t,rangeDate:i=!1})=>{const[s,d]=n.useState(!1),o=()=>{const u=new Date(a),x=new Date(c),j=new Date,v=i?j>=u&&j<x:j<u;d(v)};return n.useEffect(()=>{o()},[]),n.useEffect(()=>{const u=setInterval(o,1e3);return()=>clearInterval(u)},[]),e.jsx(e.Fragment,{children:s&&t})},Le=n.lazy(()=>V(()=>import("./DialogDetallesTicket-51360455.js"),["assets/DialogDetallesTicket-51360455.js","assets/index-f47cb319.js","assets/index-d33525bd.css","assets/PaperTable-0157daaf.js","assets/getFormattedDateTime-e1a04bea.js","assets/Button-eb2c856c.js","assets/SaveAltRounded-4741c1be.js","assets/DownloadRounded-ca48bb77.js","assets/Close-fe75a40f.js","assets/ChooseFiles-ca63515e.js","assets/InputLabel-f38a9985.js","assets/Select-a5d4c5fc.js","assets/DialogContent-7ecffa43.js","assets/DialogTitle-52b90a91.js","assets/Divider-7a004be2.js","assets/MenuItem-446faf11.js"])),Fe=({id:a})=>a==1?e.jsx(h,{icon:e.jsx(B,{}),color:"warning",variant:"filled",label:"Pendiente"}):a==2?e.jsx(h,{icon:e.jsx(N,{}),color:"success",variant:"filled",label:"Aceptado"}):a==3?e.jsx(h,{icon:e.jsx(U,{}),color:"error",variant:"filled",label:"Cancelado"}):a==4?e.jsx(h,{icon:e.jsx(T,{}),label:"Rechazado"}):a==16?e.jsx(h,{icon:e.jsx(T,{}),label:"Finalizado"}):a==17?e.jsx(h,{icon:e.jsx(T,{}),label:"Anulado"}):a==18?e.jsx(h,{icon:e.jsx(T,{}),label:"No Atendido"}):e.jsx(h,{label:"Error id"}),Oe=({handleChangePage:a,handleChangeRowsPerPage:c,page:t,rowsPerPage:i,tickets:s})=>e.jsx(e.Fragment,{children:e.jsxs(F,{spacing:1,direction:"row",alignItems:"center",justifyContent:"end",children:[e.jsx("p",{children:"NÂ° Tickets:"}),e.jsxs(je,{id:"control-select",name:"control-select",value:i,onChange:c,size:"small",inputProps:{"aria-label":"Select RowsPerPage"},SelectDisplayProps:{style:{paddingTop:5,paddingBottom:5}},children:[e.jsx(C,{value:10,children:10}),e.jsx(C,{value:20,children:20}),e.jsx(C,{value:50,children:50})]}),e.jsxs("p",{children:[s>0?t*i+1:0,"-",(t+1)*i<s?(t+1)*i:s," ","de ",s]}),e.jsx(ce,{count:s,onPageChange:a,rowsPerPage:i,page:t})]})}),He=({ctrl_id:a,nodo:c})=>{const[t,i]=n.useState(!0),[s,d]=n.useState(0),[o,u]=n.useState(10),x=l=>{u(l.target.value),d(0)},j=(l,S)=>{d(S)},[v,{isError:f,isSuccess:b,data:m}]=J();return n.useEffect(()=>{v({ctrl_id:a,limit:o,offset:s*o})},[a,s,o]),e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsx(r,{children:e.jsx(X,{"aria-label":"expand row",size:"small",onClick:()=>i(!t),children:t?e.jsx(q,{}):e.jsx(H,{})})}),e.jsx(r,{children:c}),e.jsx(r,{colSpan:6,children:e.jsxs(e.Fragment,{children:[b&&t&&m&&e.jsx(Oe,{handleChangePage:j,handleChangeRowsPerPage:x,page:s,rowsPerPage:o,tickets:m.total_size}),f&&e.jsx(O,{variant:"filled",severity:"error",children:"Error al cargar paginacion de tickets."})]})})]}),t&&b&&m&&e.jsx(e.Fragment,{children:m.data.map(l=>e.jsx(qe,{ctrl_id:a,registroTicket:l},l.rt_id))})]})},qe=({ctrl_id:a,registroTicket:c})=>{var S,w,P,M,L;const[t,i]=n.useState(c),[s,{isSuccess:d}]=Y(),[o,{isSuccess:u,data:x}]=Z(),[j,v]=n.useState(!1),f=ee(R=>R.auth),b=()=>{v(!1)},m=()=>{v(!0)},l=R=>{s({action:R,ctrl_id:a,rt_id:t.rt_id})};return n.useEffect(()=>{u&&x&&i(x)},[u,x]),n.useEffect(()=>{d&&o({ctrl_id:a,rt_id:t.rt_id})},[d]),e.jsx(e.Fragment,{children:e.jsxs(z,{children:[e.jsx(r,{}),e.jsx(r,{}),e.jsx(r,{children:t.rt_id}),e.jsxs(r,{children:[t.nombre.split(" ")[0].length>15?t.nombre.split(" ")[0].slice(0,15)+".":t.nombre.split(" ")[0]," ",t.apellido.split(" ")[0].length>15?t.apellido.split(" ")[0].slice(0,15)+".":t.apellido.split(" ")[0]]}),e.jsx(r,{children:t.descripcion.length>40?t.descripcion.slice(0,40)+" ...":t.descripcion}),e.jsx(r,{children:e.jsx(Fe,{id:t.estd_id})}),e.jsx(r,{children:de(t.fechacomienzo)}),e.jsx(r,{children:e.jsxs(F,{direction:"row",spacing:t.estd_id==1||t.estd_id==2?2:void 0,justifyContent:"space-between",children:[e.jsxs(ue,{variant:"contained","aria-label":"outlined button group",size:"small",color:"primary",children:[((S=f.user)==null?void 0:S.rol)==="Invitado"&&t.estd_id==1&&e.jsx(D,{fechacomienzo:t.fechacomienzo,fechatermino:t.fechatermino,rangeDate:!1,children:e.jsx(p,{onClick:()=>l(3),children:"Cancelar"})}),(((w=f.user)==null?void 0:w.rol)==="Usuario"||((P=f.user)==null?void 0:P.rol)==="Administrador")&&(t.estd_id==1||t.estd_id==2)&&e.jsxs(D,{fechacomienzo:t.fechacomienzo,fechatermino:t.fechatermino,rangeDate:!1,children:[t.estd_id==1&&e.jsx(p,{onClick:()=>l(2),children:"Aceptar"}),e.jsx(p,{onClick:()=>l(4),children:"Rechazar"}),e.jsx(p,{onClick:()=>l(3),children:"Cancelar"})]}),(((M=f.user)==null?void 0:M.rol)==="Usuario"||((L=f.user)==null?void 0:L.rol)==="Administrador")&&t.estd_id==2&&e.jsxs(D,{fechacomienzo:t.fechacomienzo,fechatermino:t.fechatermino,rangeDate:!0,children:[e.jsx(p,{onClick:()=>l(16),children:"Finalizar"}),e.jsx(p,{onClick:()=>l(17),children:"Anular"})]})]}),e.jsx(p,{variant:"contained",color:"info",startIcon:e.jsx(G,{}),onClick:m,children:"Detalles"})]})}),j&&e.jsx(n.Suspense,{children:e.jsx(Le,{isOpen:j,handleCloseDialog:b,data:{ctrl_id:a,p_id:t.p_id,rt_id:t.rt_id}})})]})})},Be=()=>{const{isSuccess:a,isError:c,data:t}=K();return e.jsxs(e.Fragment,{children:[e.jsx(re,{title:e.jsx(Q,{component:"h5",variant:"h5",children:"HISTORIAL DE TICKETS"})}),e.jsx(W,{children:e.jsx(se,{component:ie,children:e.jsxs(ne,{sx:{minWidth:650},"aria-label":"simple table",size:"small",children:[e.jsx(le,{children:e.jsxs(z,{children:[e.jsx(r,{}),e.jsx(r,{children:"Nodo"}),e.jsx(r,{children:"#Ticket"}),e.jsx(r,{children:"Solicitante"}),e.jsx(r,{children:"Descripcion"}),e.jsx(r,{children:"Estado"}),e.jsx(r,{children:"Fecha Trabajo"}),e.jsx(r,{children:"Acciones"})]})}),e.jsxs(oe,{children:[a&&t.map(i=>{const{ctrl_id:s,nodo:d,region:o}=i;return e.jsx(He,{ctrl_id:s,nodo:d,region:o},i.ctrl_id)}),c&&e.jsx(O,{variant:"filled",severity:"error",children:"Error al cargar nodos."})]})]})})})]})},Ze=()=>e.jsx(e.Fragment,{children:e.jsx(te,{item:!0,xs:12,children:e.jsx(ae,{children:e.jsx(Be,{})})})});export{Ze as HistorialPage,Ze as default};
